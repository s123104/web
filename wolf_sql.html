<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL å¤œå¸‚å¤§å†’éšª - äº’å‹•å­¸ç¿’é«”é©—</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash/4.17.21/lodash.min.js"></script>
    <style>
        :root {
            --primary: #ff4757;
            --secondary: #2ed573;
            --accent: #ffa502;
            --dark: #2f3542;
            --light: #f1f2f6;
            --text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Noto Sans TC', sans-serif;
        }

        body {
            background: #1a1a1a;
            color: var(--light);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ä¸»è¦å¸‚å ´èƒŒæ™¯ */
        .market-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)),
                url('/api/placeholder/1920/1080') center/cover;
            z-index: -1;
        }

        /* ç‡ˆç± å‹•ç•« */
        .lantern {
            position: absolute;
            width: 40px;
            height: 60px;
            background: #ff4757;
            border-radius: 20px;
            box-shadow: 0 0 20px #ff4757;
            animation: swing 3s infinite ease-in-out;
        }

        @keyframes swing {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(10px); }
        }

        /* é ­éƒ¨è¨­è¨ˆ */
        .header {
            background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.6));
            padding: 2rem;
            text-align: center;
            border-bottom: 3px solid var(--accent);
        }

        .header h1 {
            font-size: 3rem;
            color: var(--accent);
            text-shadow: var(--text-shadow);
            margin-bottom: 1rem;
        }

        .header p {
            color: var(--light);
            font-size: 1.2rem;
            text-shadow: var(--text-shadow);
        }

        /* æ”¤ä½å®¹å™¨ */
        .stalls-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* æ”¤ä½å¡ç‰‡è¨­è¨ˆ */
        .stall-card {
            background: rgba(47, 53, 66, 0.9);
            border-radius: 15px;
            padding: 1.5rem;
            transition: transform 0.3s ease;
            border: 2px solid var(--accent);
            position: relative;
            overflow: hidden;
        }

        .stall-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(255, 165, 2, 0.3);
        }

        .stall-header {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .stall-icon {
            width: 50px;
            height: 50px;
            background: var(--accent);
            border-radius: 50%;
            margin-right: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .stall-title {
            font-size: 1.5rem;
            color: var(--accent);
            text-shadow: var(--text-shadow);
        }

        .stall-content {
            background: rgba(0,0,0,0.3);
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        /* äº’å‹•æŒ‰éˆ•è¨­è¨ˆ */
        .action-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            text-shadow: var(--text-shadow);
            width: 100%;
            margin-top: 0.5rem;
        }

        .action-btn:hover {
            background: #ff6b81;
            transform: translateY(-2px);
        }

        /* å°è©±æ¡†è¨­è¨ˆ */
        .dialog-box {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: rgba(47, 53, 66, 0.95);
            padding: 1.5rem;
            border-radius: 15px;
            max-width: 400px;
            border: 2px solid var(--accent);
            transform-origin: bottom right;
            animation: popIn 0.3s ease-out;
            z-index: 1000;
        }

        .character-dialog {
            display: flex;
            align-items: start;
            gap: 1rem;
        }

        .character-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 2px solid var(--accent);
        }

        .dialog-content {
            flex: 1;
        }

        .character-name {
            color: var(--accent);
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        /* è¡¨æ ¼è¨­è¨ˆ */
        .sql-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            background: rgba(0,0,0,0.3);
        }

        .sql-table th, .sql-table td {
            padding: 0.8rem;
            border: 1px solid var(--accent);
            text-align: left;
        }

        .sql-table th {
            background: var(--accent);
            color: var(--dark);
        }

        /* å‹•ç•« */
        @keyframes popIn {
            0% { transform: scale(0); }
            100% { transform: scale(1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* RWD è¨­è¨ˆ */
        @media (max-width: 768px) {
            .stalls-container {
                grid-template-columns: 1fr;
                padding: 1rem;
            }

            .header h1 {
                font-size: 2rem;
            }

            .dialog-box {
                left: 1rem;
                right: 1rem;
                bottom: 1rem;
                max-width: none;
            }
        }

        /* è³‡æ–™åº«æ“ä½œè¡¨å–® */
        .operation-form {
            background: rgba(0,0,0,0.5);
            padding: 1rem;
            border-radius: 10px;
            margin-top: 1rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-input {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid var(--accent);
            border-radius: 5px;
            background: rgba(255,255,255,0.1);
            color: var(--light);
        }

        /* çµæœå±•ç¤ºå€åŸŸ */
        .result-area {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            border: 1px solid var(--accent);
        }
    </style>
</head>
<body>
    <div class="market-background"></div>
    
    <!-- ç‡ˆç± è£é£¾ -->
    <div class="lantern" style="top: 20px; left: 10%"></div>
    <div class="lantern" style="top: 40px; left: 20%"></div>
    <div class="lantern" style="top: 30px; left: 80%"></div>
    
    <header class="header">
        <h1>SQL å¤œå¸‚å¤§å†’éšª</h1>
        <p>å’Œå°ç‹¼ã€å°å…”ä¸€èµ·æ¢ç´¢SQLçš„å¥‡å¦™ä¸–ç•Œï¼</p>
    </header>

    <main class="stalls-container">
        <!-- åŸºæœ¬æ“ä½œæ”¤ä½ -->
        <div class="stall-card" id="basic-operations">
            <div class="stall-header">
                <div class="stall-icon">ğŸ“</div>
                <h2 class="stall-title">åŸºç¤SQLæ“ä½œ</h2>
            </div>
            <div class="stall-content">
                <div class="operation-form">
                    <div class="form-group">
                        <input type="text" class="form-input" placeholder="è¼¸å…¥è¡¨æ ¼åç¨±" id="table-name">
                    </div>
                    <button class="action-btn" onclick="createTable()">å»ºç«‹æ–°è¡¨æ ¼</button>
                </div>
                <div class="result-area" id="basic-result"></div>
            </div>
        </div>

        <!-- æŸ¥è©¢æ”¤ä½ -->
        <div class="stall-card" id="query-stall">
            <div class="stall-header">
                <div class="stall-icon">ğŸ”</div>
                <h2 class="stall-title">è³‡æ–™æŸ¥è©¢æ”¤</h2>
            </div>
            <div class="stall-content">
                <select class="form-input" id="query-type">
                    <option value="select">SELECT æŸ¥è©¢</option>
                    <option value="join">JOIN æŸ¥è©¢</option>
                    <option value="group">GROUP BY æŸ¥è©¢</option>
                </select>
                <button class="action-btn" onclick="performQuery()">åŸ·è¡ŒæŸ¥è©¢</button>
                <div class="result-area" id="query-result"></div>
            </div>
        </div>

        <!-- é€²éšåŠŸèƒ½æ”¤ä½ -->
        <div class="stall-card" id="advanced-features">
            <div class="stall-header">
                <div class="stall-icon">âš¡</div>
                <h2 class="stall-title">é€²éšåŠŸèƒ½å€</h2>
            </div>
            <div class="stall-content">
                <button class="action-btn" onclick="showTransaction()">äº¤æ˜“ç¤ºç¯„</button>
                <button class="action-btn" onclick="showTrigger()">è§¸ç™¼å™¨ç¤ºç¯„</button>
                <div class="result-area" id="advanced-result"></div>
            </div>
        </div>
    </main>

    <!-- å°è©±æ¡† -->
    <div class="dialog-box" id="dialog" style="display: none;">
        <div class="character-dialog">
            <img src="/api/placeholder/60/60" alt="è§’è‰²é ­åƒ" class="character-avatar">
            <div class="dialog-content">
                <div class="character-name" id="speaker-name">å°ç‹¼</div>
                <div id="dialog-text">æ­¡è¿ä¾†åˆ°SQLå¤œå¸‚ï¼</div>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ“¬è³‡æ–™åº«
        let database = {
            tables: {},
            queries: [],
            transactions: []
        };

        // é¡¯ç¤ºå°è©±
        function showDialog(character, text) {
            const dialog = document.getElementById('dialog');
            const speakerName = document.getElementById('speaker-name');
            const dialogText = document.getElementById('dialog-text');
            
            speakerName.textContent = character;
            dialogText.textContent = text;
            dialog.style.display = 'block';
            
            setTimeout(() => {
                dialog.style.display = 'none';
            }, 3000);
        }

        // å»ºç«‹è¡¨æ ¼
        function createTable() {
            const tableName = document.getElementById('table-name').value;
            if (!tableName) {
                showDialog('å°ç‹¼', 'æ¬¸ï½è¡¨æ ¼åç¨±ä¸èƒ½ç‚ºç©ºå•¦ï¼');
                return;
            }

            database.tables[tableName] = {
                columns: ['id', 'name', 'value'],
                data: []
            };

            const resultArea = document.getElementById('basic-result');
            resultArea.innerHTML = `
                <div style="animation: fadeIn 0.5s">
                    <h3>è¡¨æ ¼ ${tableName} å‰µå»ºæˆåŠŸï¼</h3>
                    <div class="sql-code">
                        CREATE TABLE ${tableName} (
                            id INT PRIMARY KEY,
                            name VARCHAR(50),
                            value INT
                        );
                    </div>
                </div>
            `;

            showDialog('å°ç‹¼', `è¡¨æ ¼ ${tableName} å»ºç«‹æˆåŠŸï¼ä½ çµ‚æ–¼é–‹å§‹å±•ç¾å¯¦åŠ›äº†ï¼`);
        }

        // åŸ·è¡ŒæŸ¥è©¢
        function performQuery() {
            const queryType = document.getElementById('query-type').value;
            const resultArea = document.getElementById('query-result');
            let sqlQuery = '';
            let result = '';

            switch(queryType) {
                case 'select':
                    sqlQuery = 'SELECT * FROM users WHERE age > 20';
                    result = 'æ¨¡æ“¬SELECTæŸ¥è©¢çµæœ';
                    break;
                case 'join':
                    sqlQuery = 'SELECT users.name, orders.total FROM users JOIN orders ON users.id = orders.user_id';
                    result = 'æ¨¡æ“¬JOINæŸ¥è©¢çµæœ';
                    break;
                case 'group':
                    sqlQuery = 'SELECT category, COUNT(*) as count FROM products GROUP BY category';
                    result = 'æ¨¡æ“¬GROUP BYæŸ¥è©¢çµæœ';
                    break;
            }

            resultArea.innerHTML = `
                <div style="animation: fadeIn 0.5s">
                    <h3>SQLæŸ¥è©¢</h3>
                    <code>${sqlQuery}</code>
                    <h3>æŸ¥è©¢çµæœ</h3>
                    <p>${result}</p>
                </div>
            `;

            showDialog('å°å…”', 'å“‡ï¼æŸ¥è©¢çµæœä¹Ÿå¤ªå®Œç¾äº†å§ï¼');
        }

        // å±•ç¤ºäº¤æ˜“
        function showTransaction() {
            const resultArea = document.getElementById('advanced-result');
            resultArea.innerHTML = `
                <div style="animation: fadeIn 0.5s">
                    <h3>äº¤æ˜“ç¤ºç¯„</h3>
                    <code>
                        BEGIN TRANSACTION;</antArtifact>
                        [Previous HTML and CSS code remains the same until the script section]

<script>
        // å±•ç¤ºäº¤æ˜“ï¼ˆçºŒï¼‰
        function showTransaction() {
            const resultArea = document.getElementById('advanced-result');
            resultArea.innerHTML = `
                <div style="animation: fadeIn 0.5s">
                    <h3>äº¤æ˜“ç¤ºç¯„</h3>
                    <code>
                        BEGIN TRANSACTION;
                        UPDATE accounts SET balance = balance - 500 WHERE user_id = 1;
                        UPDATE accounts SET balance = balance + 500 WHERE user_id = 2;
                        COMMIT;
                    </code>
                    <div class="transaction-simulation">
                        <h4>äº¤æ˜“é€²è¡Œä¸­...</h4>
                        <div class="progress-bar"></div>
                    </div>
                </div>
            `;

            showDialog('å°ç‹¼', 'äº¤æ˜“è™•ç†å¾—æ¯”è€é—†ç®—éŒ¢é‚„æº–ç¢ºï¼');
        }

        // å±•ç¤ºè§¸ç™¼å™¨
        function showTrigger() {
            const resultArea = document.getElementById('advanced-result');
            resultArea.innerHTML = `
                <div style="animation: fadeIn 0.5s">
                    <h3>è§¸ç™¼å™¨ç¤ºç¯„</h3>
                    <code>
                        CREATE TRIGGER after_order_insert
                        AFTER INSERT ON orders
                        FOR EACH ROW
                        BEGIN
                            INSERT INTO notifications(message)
                            VALUES (CONCAT('æ–°è¨‚å–®ï¼š', NEW.order_id));
                        END;
                    </code>
                    <div class="trigger-demo">
                        <button onclick="simulateTrigger()" class="action-btn">æ¨¡æ“¬æ–°è¨‚å–®</button>
                    </div>
                </div>
            `;
        }

        // æ¨¡æ“¬è§¸ç™¼å™¨æ•ˆæœ
        function simulateTrigger() {
            const orderId = Math.floor(Math.random() * 1000);
            showDialog('å°å…”', `è§¸ç™¼å™¨æˆåŠŸï¼è¨‚å–® #${orderId} å·²é€šçŸ¥ç³»çµ±`);
        }

        // éš¨æ©Ÿæ•…äº‹ç”Ÿæˆå™¨
        const stories = [
            "SQLæŸ¥è©¢æ¯”åª½åª½çš„æ»·è‚‰é£¯é‚„è¦é¦™ï¼",
            "é€™å€‹JOINæ“ä½œæ¯”å¤œå¸‚ç‰½æ‰‹é‚„è¦ç·Šå¯†ï½",
            "WHEREæ¢ä»¶æ¯”æŒ‘æ°´æœé‚„è¦æŒ‘å‰”ï¼",
            "GROUP BYæ•´ç†å¾—æ¯”æ”¶æ”¤é‚„è¦å¿«ï¼"
        ];

        function tellStory() {
            const randomStory = stories[Math.floor(Math.random() * stories.length)];
            showDialog('å°ç‹¼', randomStory);
        }

        // æ–°å¢è³‡æ–™æ¨¡æ“¬
        function insertData() {
            const table = document.querySelector('.sql-table');
            const newRow = table.insertRow(-1);
            const cells = [
                Math.floor(Math.random() * 1000),
                'å•†å“_' + Math.floor(Math.random() * 100),
                Math.floor(Math.random() * 1000)
            ];

            cells.forEach(cellData => {
                const cell = newRow.insertCell(-1);
                cell.textContent = cellData;
            });

            showDialog('å°å…”', 'æ–°è³‡æ–™æ’å…¥æˆåŠŸï¼æ¯”æ’éšŠé‚„å¿«ï¼');
        }

        // å‹•æ…‹ç”Ÿæˆè¡¨æ ¼
        function generateTable(data) {
            return `
                <table class="sql-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>åç¨±</th>
                            <th>åƒ¹æ ¼</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${data.map(row => `
                            <tr>
                                <td>${row.id}</td>
                                <td>${row.name}</td>
                                <td>${row.price}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        // è¦–è¦ºæ•ˆæœå¢å¼·
        function addVisualEffects() {
            // ç‡ˆç± æ–æ™ƒæ•ˆæœ
            document.querySelectorAll('.lantern').forEach(lantern => {
                lantern.style.animationDelay = Math.random() * 2 + 's';
            });

            // æ”¤ä½å¡ç‰‡æ‡¸åœæ•ˆæœ
            document.querySelectorAll('.stall-card').forEach(card => {
                card.addEventListener('mouseenter', () => {
                    card.style.transform = 'translateY(-5px)';
                    card.style.boxShadow = '0 8px 15px rgba(255, 165, 2, 0.4)';
                });

                card.addEventListener('mouseleave', () => {
                    card.style.transform = 'translateY(0)';
                    card.style.boxShadow = 'none';
                });
            });
        }

        // æ¨¡æ“¬SQLåŸ·è¡Œå‹•ç•«
        function simulateQueryExecution(query) {
            const resultArea = document.getElementById('query-result');
            resultArea.innerHTML = '<div class="loading">åŸ·è¡ŒæŸ¥è©¢ä¸­...</div>';
            
            setTimeout(() => {
                const sampleData = [
                    {id: 1, name: 'ç‚’éºµ', price: 60},
                    {id: 2, name: 'æ»·è‚‰é£¯', price: 45},
                    {id: 3, name: 'çç å¥¶èŒ¶', price: 50}
                ];
                
                resultArea.innerHTML = generateTable(sampleData);
                showDialog('å°ç‹¼', 'æŸ¥è©¢çµæœå‡ºçˆå•¦ï¼æ¯”å»šå¸«ç‚’èœé‚„å¿«ï¼');
            }, 1000);
        }

        // åˆå§‹åŒ–æ‡‰ç”¨
        document.addEventListener('DOMContentLoaded', () => {
            addVisualEffects();
            // æ¯éš”ä¸€æ®µæ™‚é–“éš¨æ©Ÿè¬›æ•…äº‹
            setInterval(tellStory, 10000);
            
            // åˆå§‹åŒ–ç¤ºç¯„è³‡æ–™
            const sampleData = [
                {id: 1, name: 'ç‚’éºµ', price: 60},
                {id: 2, name: 'æ»·è‚‰é£¯', price: 45},
                {id: 3, name: 'çç å¥¶èŒ¶', price: 50}
            ];
            
            const queryResult = document.getElementById('query-result');
            queryResult.innerHTML = generateTable(sampleData);
        });

        // æ–°å¢éŸ¿æ‡‰å¼è¨­è¨ˆè™•ç†
        window.addEventListener('resize', () => {
            const width = window.innerWidth;
            const stallsContainer = document.querySelector('.stalls-container');
            
            if (width < 768) {
                stallsContainer.style.gridTemplateColumns = '1fr';
            } else {
                stallsContainer.style.gridTemplateColumns = 'repeat(auto-fit, minmax(300px, 1fr))';
            }
        });

        // æ¨¡æ“¬å¯¦æ™‚æ•¸æ“šæ›´æ–°
        setInterval(() => {
            const randomPrice = Math.floor(Math.random() * 100) + 30;
            const rows = document.querySelectorAll('.sql-table tbody tr');
            if (rows.length > 0) {
                const randomRow = rows[Math.floor(Math.random() * rows.length)];
                const priceCell = randomRow.cells[2];
                const oldPrice = parseInt(priceCell.textContent);
                priceCell.textContent = randomPrice;
                
                if (randomPrice > oldPrice) {
                    priceCell.style.color = '#2ed573';
                } else {
                    priceCell.style.color = '#ff4757';
                }
                
                setTimeout(() => {
                    priceCell.style.color = '';
                }, 1000);
            }
        }, 5000);
    </script>
</body>
</html>