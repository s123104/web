<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>裝修教學短視頻</title>
    <style>
        /* ... 保留之前的基礎樣式 ... */

        .welcome-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 20px;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .welcome-content {
            text-align: center;
            max-width: 320px;
        }

        .welcome-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #fff;
        }

        .welcome-text {
            font-size: 16px;
            color: rgba(255,255,255,0.9);
            margin-bottom: 24px;
            line-height: 1.5;
        }

        .welcome-buttons {
            display: flex;
            gap: 12px;
            flex-direction: column;
            width: 100%;
        }

        .welcome-button {
            padding: 14px 24px;
            border-radius: 24px;
            border: none;
            background: #1a73e8;
            color: white;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: transform 0.2s, background 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .welcome-button:active {
            transform: scale(0.98);
        }

        .welcome-button.secondary {
            background: rgba(255,255,255,0.1);
        }

        .feature-hint {
            position: fixed;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            padding: 12px 20px;
            border-radius: 20px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .feature-hint.show {
            opacity: 1;
            animation: hintFloat 1s ease infinite alternate;
        }

        .feature-hint i {
            font-size: 18px;
        }

        .feature-hint span {
            font-size: 14px;
            color: rgba(255,255,255,0.9);
        }

        .quality-indicator {
            position: fixed;
            top: 60px;
            right: 16px;
            background: rgba(0,0,0,0.6);
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 12px;
            color: rgba(255,255,255,0.9);
            z-index: 100;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .quality-indicator.show {
            opacity: 1;
        }

        @keyframes hintFloat {
            from { transform: translateX(-50%) translateY(0); }
            to { transform: translateX(-50%) translateY(-5px); }
        }
    </style>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- 歡迎提示 -->
    <div class="welcome-overlay">
        <div class="welcome-content">
            <h1 class="welcome-title">歡迎使用裝修教學</h1>
            <p class="welcome-text">為獲得最佳觀看體驗，建議使用全螢幕模式觀看影片</p>
            <div class="welcome-buttons">
                <button class="welcome-button" id="enterFullscreen">
                    <i class="fas fa-expand"></i> 進入全螢幕模式
                </button>
                <button class="welcome-button secondary" id="continueNormal">
                    繼續普通模式
                </button>
            </div>
        </div>
    </div>

    <!-- 功能提示 -->
    <div class="feature-hint">
        <i class="fas fa-arrow-up"></i>
        <span>點擊上方可切換分類</span>
    </div>

    <!-- 畫質指示器 -->
    <div class="quality-indicator">
        HD 1080P
    </div>

    <!-- 保留之前的主要內容結構 -->
    <!-- ... -->

    <script>
        // ... 保留之前的基礎功能代碼 ...

        // 初始化歡迎體驗
        function initWelcomeExperience() {
            const welcomeOverlay = document.querySelector('.welcome-overlay');
            const enterFullscreenBtn = document.getElementById('enterFullscreen');
            const continueNormalBtn = document.getElementById('continueNormal');
            const featureHint = document.querySelector('.feature-hint');
            const qualityIndicator = document.querySelector('.quality-indicator');

            // 全螢幕模式
            enterFullscreenBtn.addEventListener('click', () => {
                if (document.documentElement.requestFullscreen) {
                    document.documentElement.requestFullscreen();
                } else if (document.documentElement.webkitRequestFullscreen) {
                    document.documentElement.webkitRequestFullscreen();
                }
                startApp();
            });

            // 普通模式
            continueNormalBtn.addEventListener('click', startApp);

            function startApp() {
                welcomeOverlay.style.opacity = '0';
                welcomeOverlay.style.visibility = 'hidden';
                
                // 顯示功能提示
                setTimeout(() => {
                    featureHint.classList.add('show');
                    // 3秒後隱藏提示
                    setTimeout(() => {
                        featureHint.classList.remove('show');
                    }, 3000);
                }, 500);

                // 初始化播放器
                initializePlayer();
            }
        }

        // 初始化播放器時的畫質設置
        function initializePlayer() {
            // 在創建播放器時設置最高畫質
            player = new YT.Player('player', {
                height: '100%',
                width: '100%',
                videoId: videos[0].id,
                playerVars: {
                    autoplay: 1,
                    controls: 0,
                    modestbranding: 1,
                    playsinline: 1,
                    rel: 0,
                    showinfo: 0,
                    loop: 0,
                    mute: 0,
                    // 設置最高畫質
                    vq: 'hd1080'
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange,
                    'onPlaybackQualityChange': onQualityChange
                }
            });
        }

        // 監聽畫質變化
        function onQualityChange(event) {
            const quality = event.data;
            const qualityIndicator = document.querySelector('.quality-indicator');
            
            // 更新畫質指示器
            qualityIndicator.classList.add('show');
            qualityIndicator.textContent = getQualityLabel(quality);
            
            // 3秒後隱藏指示器
            setTimeout(() => {
                qualityIndicator.classList.remove('show');
            }, 3000);
        }

        // 獲取畫質標籤
        function getQualityLabel(quality) {
            const qualities = {
                'hd1080': 'HD 1080P',
                'hd720': 'HD 720P',
                'large': '480P',
                'medium': '360P',
                'small': '240P',
                'tiny': '144P'
            };
            return qualities[quality] || quality;
        }

        // 設置最高可用畫質
        function setHighestQuality() {
            if (player && player.getAvailableQualityLevels) {
                const qualities = player.getAvailableQualityLevels();
                if (qualities.length > 0) {
                    player.setPlaybackQuality(qualities[0]);
                }
            }
        }

        // 在播放器準備就緒時
        function onPlayerReady(event) {
            setHighestQuality();
            event.target.playVideo();
            updateVideoInfo();
            startProgressBar();
            preloadNextVideo();
        }

        // 初始化應用
        document.addEventListener('DOMContentLoaded', initWelcomeExperience);
    </script>
</body>
</html>