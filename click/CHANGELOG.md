# 📋 變更記錄

## [5.0.0] - 2025-08-13

### 🎯 重大更新：TPS 計算系統完全重構

- **✨ 真實 TPS 計算**:
  - 實現基於滑動窗口的準確 TPS 計算算法
  - 告別基於點擊間隔推算的虛假高數值
  - 統計過去 1 秒內的實際點擊次數
- **📊 峰值記錄系統**:
  - 自動追蹤每位玩家的最高 TPS 峰值
  - 結果頁面顯示雙方最高 TPS 成績
  - 支援單人和雙人模式的完整記錄
- **⚡ 技術優化**:
  - 每 100ms 定期更新，提供流暢即時反饋
  - 自動清理過期數據，防止內存洩漏
  - 完善的定時器生命週期管理

### 🌈 全新粉紅白藍漸層閃電設計

- **🎨 配色重設計**:
  - 彩虹閃電改為粉紅 (#f66fb9) → 白色 (#ffffff) → 粉藍 (#52b7ff) 漸層
  - 與遊戲主題色彩完美統一
  - 更柔和優雅的視覺效果
- **💫 動畫優化**:
  - 新的 `pinkBlueShift` 動畫，1.2 秒柔和週期
  - 避免過度放大變粗 (scale 1.02 vs 1.05)
  - 閃電脈衝和鏈狀閃電效果同步更新
- **🎯 合理閾值**:
  - 30+ TPS 觸發炫酷漸層特效（從不可能的 1000 降低）
  - 20+ TPS 觸發水波紋效果
  - 更容易達到，提升用戶成就感

### 🔧 系統穩定性改進

- **🐛 修復閾值不一致問題**:
  - 統一所有 TPS 相關邏輯的觸發閾值
  - 確保視覺效果與實際邏輯完全同步
- **🧠 內存管理優化**:
  - 遊戲開始時正確初始化所有 TPS 數據
  - 遊戲結束時完整清理定時器和數據
  - 長時間遊戲無內存洩漏問題
- **📈 性能提升**:
  - 滑動窗口算法高效實現
  - 合理的更新頻率平衡準確性與性能
  - 優化的數據結構減少計算開銷

### 📊 增強的數據展示

- **🏆 結果頁面升級**:
  - 單人模式：顯示 `最高 TPS：25`
  - 雙人模式：顯示 `最高 TPS - 玩家1：32 | 玩家2：28`
  - 突出顯示玩家的最佳表現
- **🎮 競技性增強**:
  - 激勵玩家挑戰更高 TPS
  - 提供準確的技能水平反饋
  - 支援未來成就系統的數據基礎

## [4.0.0] - 2025-08-13

### ✨ 新增功能

- **🎆 勝利煙火系統**: 包含爆裂、環形、螺旋、連鎖四種煙火效果
- **⚡ 增強閃電效果**: 新增閃電脈衝和鏈狀閃電動畫
- **🎭 勝利畫面特效**: 全屏閃爍效果
- **🎵 豐富音效系統**: 支援隨機音調和勝利音效
- **🌈 Grand Finale**: 大結局效果，包含彩色紙屑雨
- **💫 動畫優化**: 更流暢的過渡和視覺反饋

### 🎨 介面改進

- 優化 TPS 顯示器 UI，改善間距和視覺效果
- 增強勝利畫面的視覺衝擊力
- 改善整體動畫流暢度

## [3.0.0] - 2025-08-13

### ✨ 新增功能

- **🌈 彩虹閃電效果**: TPS 超過 1000 時啟動壯觀的彩虹漸層閃電動畫
- **📊 增強 TPS 顯示**:
  - 支援最多 5 位數字顯示 (99999 TPS)
  - 等寬字體確保數字對齊
  - 彩虹背景動畫效果
- **🎨 粉藍色設定介面**:
  - 遊戲設定文字改為粉藍色
  - 開關按鈕採用粉藍色漸層
  - 排行榜按鈕使用粉藍色風格

### 🐛 錯誤修復

- **🔧 修復點擊檢測問題**:
  - 解決 OffscreenCanvas 重複初始化錯誤
  - 修復 inputManager 未正確初始化的問題
  - 改善多點觸控響應性
- **⚡ Worker 初始化優化**:
  - 添加重複初始化保護機制
  - 加強錯誤處理和回退機制
  - 提升效果渲染穩定性

### 🎨 介面改進

- **設定介面**: 所有文字改為粉藍色 (`--sky-500`)
- **開關按鈕**: 啟用時顯示粉藍色漸層效果
- **排行榜**:
  - "清除記錄" 按鈕使用粉藍色背景
  - "關閉" 按鈕使用白色背景配粉藍色文字
- **TPS 顯示容器**: 專業的邊框和背景設計

### ⚡ 效能優化

- 改善 OffscreenCanvas 使用效率
- 優化彩虹效果渲染性能
- 減少不必要的 DOM 操作

### 🧪 測試增強

- 新增 TPS 測試工具頁面
- 完整的點擊功能測試套件
- Puppeteer 自動化測試驗證

## [2.0.0] - 2025-08-13

### ✨ 新增功能

- **🎮 雙人對戰模式**: 分屏對戰，支援同時多點觸控
- **🌊 水波紋動畫**: 高速點擊時觸發的動態水波效果
- **📊 TPS 顯示**: 即時點擊速度監測
- **🎯 10 級閃電效果**: 根據點擊速度動態調整的視覺效果

### 🎨 介面更新

- 全新的雙人對戰 UI 設計
- 改善的遊戲計時器顯示
- 優化的設定選單

### ⚡ 效能改進

- OffscreenCanvas 渲染優化
- Web Worker 並行處理
- 記憶體使用優化

## [1.0.0] - 2025-08-13

### ✨ 首次發布

- **🎯 單人點擊遊戲**: 基礎的點擊挑戰模式
- **⚡ 閃電視覺效果**: 點擊時的動態閃電動畫
- **🎵 音效系統**: Web Audio API 程序化音效
- **📱 PWA 支援**:
  - Service Worker 離線快取
  - Web App Manifest
  - 桌面/主畫面安裝支援
- **🎨 響應式設計**: 支援手機、平板、桌面裝置
- **⚙️ 遊戲設定**:
  - 音效開關
  - 震動回饋
  - 遊戲時間選擇
- **📊 排行榜系統**: LocalStorage 本地記錄

### 🏗️ 技術架構

- 純 HTML5 + CSS3 + JavaScript
- OffscreenCanvas + Web Workers
- 模組化程式架構
- 優雅的錯誤處理

---

## 圖例說明

- ✨ 新增功能
- 🐛 錯誤修復
- 🎨 介面改進
- ⚡ 效能優化
- 🔧 技術改進
- 📱 PWA 相關
- 🧪 測試相關
- 📊 數據/分析
- 🎮 遊戲功能
- 🌈 視覺效果
