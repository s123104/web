<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <title>TeX æª”æ¡ˆç”Ÿæˆå™¨</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- å¼•å…¥ Google å­—é«” -->
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap"
      rel="stylesheet"
    />
    <style>
      /* å…¨åŸŸæ¨£å¼ */
      body {
        font-family: "Noto Sans TC", sans-serif;
        margin: 0;
        padding: 0;
        background-color: var(--bg-color);
        color: var(--text-color);
        transition: background-color 0.3s, color 0.3s;
      }
      :root {
        --bg-color: #ffffff;
        --text-color: #000000;
        --block-bg-color: #f5f5f5;
        --block-border-color: #cccccc;
        --button-bg-color: #007bff;
        --button-text-color: #ffffff;
        --button-hover-bg-color: #0056b3;
      }
      [data-theme="dark"] {
        --bg-color: #121212;
        --text-color: #e0e0e0;
        --block-bg-color: #1e1e1e;
        --block-border-color: #333333;
        --button-bg-color: #1a73e8;
        --button-text-color: #ffffff;
        --button-hover-bg-color: #185abc;
      }
      /* ç‰ˆé¢é…ç½® */
      .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }
      /* æ¨™é¡Œæ¨£å¼ */
      h1,
      h2 {
        text-align: center;
      }
      /* æŒ‰éˆ•æ¨£å¼ */
      .btn {
        background-color: var(--button-bg-color);
        color: var(--button-text-color);
        border: none;
        padding: 10px 15px;
        margin: 5px 5px 5px 0;
        cursor: pointer;
        border-radius: 5px;
        font-size: 16px;
        transition: background-color 0.3s;
        display: inline-block;
      }
      .btn:hover {
        background-color: var(--button-hover-bg-color);
      }
      /* å€å¡Šæ¨£å¼ */
      .block {
        background-color: var(--block-bg-color);
        border: 1px solid var(--block-border-color);
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 5px;
      }
      .block label {
        font-weight: bold;
        display: block;
        margin-bottom: 5px;
      }
      .block select,
      .block textarea {
        width: 100%;
        box-sizing: border-box;
        padding: 8px;
        margin-bottom: 10px;
        border: 1px solid var(--block-border-color);
        border-radius: 5px;
        background-color: var(--bg-color);
        color: var(--text-color);
      }
      .block textarea {
        height: 100px;
        resize: vertical;
      }
      /* åˆ‡æ›æ¨¡å¼æŒ‰éˆ• */
      #toggle-theme {
        float: right;
        background-color: transparent;
        color: var(--text-color);
        border: none;
        cursor: pointer;
        font-size: 24px;
        margin-top: -50px;
      }
      /* ç”Ÿæˆçš„ TeX å…§å®¹ */
      #tex-output {
        width: 100%;
        height: 300px;
        padding: 10px;
        box-sizing: border-box;
        border: 1px solid var(--block-border-color);
        border-radius: 5px;
        background-color: var(--block-bg-color);
        color: var(--text-color);
        resize: vertical;
      }
      /* è§£é‡‹å€å¡Šæ¨£å¼ */
      #explanation {
        background-color: var(--block-bg-color);
        border: 1px solid var(--block-border-color);
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
      }
      #explanation h3 {
        margin-top: 0;
      }
      /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
      @media screen and (max-width: 600px) {
        .btn {
          width: 100%;
          margin-bottom: 10px;
        }
        #toggle-theme {
          float: none;
          display: block;
          text-align: right;
          margin-top: -30px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>TeX æª”æ¡ˆç”Ÿæˆå™¨</h1>
      <button id="toggle-theme">ğŸŒ™</button>

      <!-- è§£é‡‹å€å¡Š -->
      <div id="explanation">
        <h3>å€å¡Šé¡å‹èªªæ˜</h3>
        <p>
          <strong>é¡Œç›® (Example)ï¼š</strong> ç”¨æ–¼è¼¸å…¥é¡Œç›®çš„å…§å®¹ï¼Œæœƒè¢«åŒ…è£¹åœ¨
          <code>\\begin{Example}</code> å’Œ <code>\\end{Example}</code> ç’°å¢ƒä¸­ã€‚
        </p>
        <p>
          <strong>è§£ç­” (Answer)ï¼š</strong> ç”¨æ–¼è¼¸å…¥é¡Œç›®çš„è§£ç­”ï¼Œæœƒè¢«åŒ…è£¹åœ¨
          <code>\\begin{Answer}</code> å’Œ <code>\\end{Answer}</code> ç’°å¢ƒä¸­ã€‚
        </p>
        <p>
          <strong>ç¯€ (Section)ï¼š</strong> ç”¨æ–¼å»ºç«‹æ–°çš„ç« ç¯€ï¼Œå°æ‡‰åˆ°
          <code>\\section{...}</code>ã€‚
        </p>
        <p>
          <strong>å°ç¯€ (Subsection)ï¼š</strong> ç”¨æ–¼å»ºç«‹æ–°çš„å°ç¯€ï¼Œå°æ‡‰åˆ°
          <code>\\subsection{...}</code>ã€‚
        </p>
        <p>
          <strong>å…¶ä»– (Other)ï¼š</strong>
          ç”¨æ–¼è¼¸å…¥å…¶ä»–è‡ªå®šç¾©çš„å…§å®¹ï¼Œä¸æœƒè¢«åŒ…è£¹åœ¨ä»»ä½•ç’°å¢ƒä¸­ï¼Œæ‚¨å¯ä»¥ç›´æ¥è¼¸å…¥ LaTeX
          ä»£ç¢¼ã€‚
        </p>
      </div>

      <div id="blocks">
        <!-- å€å¡Šå°‡è¢«æ·»åŠ åˆ°é€™è£¡ -->
      </div>

      <button id="add-block" class="btn">â• æ–°å¢å€å¡Š</button>
      <button id="generate-tex" class="btn">ğŸ“„ ç”Ÿæˆ TeX æª”æ¡ˆ</button>
      <button id="download-tex" class="btn">ğŸ’¾ ä¸‹è¼‰ TeX æª”æ¡ˆ</button>

      <h2>ç”Ÿæˆçš„ TeX å…§å®¹ï¼š</h2>
      <textarea id="tex-output" readonly></textarea>
    </div>

    <script>
      let blockCount = 0;

      function addBlock() {
        blockCount++;

        const blockDiv = document.createElement("div");
        blockDiv.className = "block";
        blockDiv.id = "block-" + blockCount;

        const label = document.createElement("label");
        label.textContent = "å€å¡Š " + blockCount + ":";

        const select = document.createElement("select");
        select.innerHTML =
          '<option value="Example">é¡Œç›® (Example)</option><option value="Answer">è§£ç­” (Answer)</option><option value="Section">ç¯€ (Section)</option><option value="Subsection">å°ç¯€ (Subsection)</option><option value="Other">å…¶ä»– (Other)</option>';

        const textarea = document.createElement("textarea");
        textarea.placeholder = "åœ¨æ­¤è¼¸å…¥å…§å®¹...";

        const buttonContainer = document.createElement("div");

        const removeButton = document.createElement("button");
        removeButton.textContent = "ğŸ—‘ï¸ ç§»é™¤å€å¡Š";
        removeButton.className = "btn";
        removeButton.onclick = function () {
          document.getElementById("blocks").removeChild(blockDiv);
        };

        buttonContainer.appendChild(removeButton);

        blockDiv.appendChild(label);
        blockDiv.appendChild(select);
        blockDiv.appendChild(textarea);
        blockDiv.appendChild(buttonContainer);

        document.getElementById("blocks").appendChild(blockDiv);
      }

      document.getElementById("add-block").onclick = addBlock;

      function generateTeX() {
        // TeX æ¨¡æ¿çš„é–‹é ­
        let texContent = `% !Mode:: "TeX:UTF-8"
\\documentclass[12pt]{article}
\\usepackage{amsmath}%æ•¸å­¸ç¬¦è™Ÿ1
\\usepackage{CJKutf8}%ä¸­æ–‡è¡¨æ ¼
\\usepackage{amssymb}%æ•¸å­¸ç¬¦è™Ÿ2
\\usepackage{lmodern}%å­—å‹å¤§å°
\\usepackage{amsfonts}%æ•¸å­¸å­—å‹
\\usepackage{natbib}%åƒè€ƒæ–‡ç»
\\usepackage{graphics}%åœ–å‹
\\usepackage{epsfig}%EPSåœ–å‹
\\usepackage{subfigure}
\\usepackage{graphicx}
\\usepackage{fancybox}
\\usepackage{url}%è¼¸å…¥ç¶²å€
\\usepackage{tikz}
\\usepackage[lastexercise]{exercise}
\\usepackage{chngcntr}
\\usepackage{tcolorbox}
\\usepackage{listings}
\\usepackage{multirow}%å¤šåˆ—è¡¨æ ¼
\\usepackage[para,online,flushleft]{threeparttable}%è¡¨æ ¼è¨»è§£
\\usepackage{rotating}%è¡¨æ ¼æ—‹è½‰
\\usepackage{dcolumn}%è®“è¡¨æ ¼å°æ•¸é»å°é½Š
\\usepackage{caption}

\\newcommand{\\gfcb}[1]{%
    \\fcolorbox{white}{gray!10!}{\\quad\\strut #1\\quad}
} % gfcb := gray fcolorbox
\\newcommand{\\cop}[1]{%
    \\gfcb{\\texttt{\\detokenize{#1}}} 
    \\ensuremath{\\quad\\longrightarrow\\quad #1}
} % cop := code output

\\tcbset{arc=0mm,boxrule=1pt,colback=white,colframe=cyan,leftrule=3mm}
\\usepackage{float}
\\newtheorem{example}{Example}[subsection]
\\newtheorem{defin}{Definition}
\\usepackage{setspace} 
\\renewcommand{\\figurename}{åœ–}
\\renewcommand{\\tablename}{è¡¨}
\\renewcommand\\refname{åƒè€ƒæ–‡ç»}
\\renewcommand{\\abstractname}{æ‘˜è¦}
\\definecolor{bisque}{rgb}{.996,.891,.755}
\\definecolor{mypink}{cmyk}{.1,.8,.4,.1}  % cmyk æ¨¡å‹çš„ä¾‹å­ 
\\definecolor{Gray}{gray}{0.85}
\\definecolor{LightCyan}{rgb}{0.88,1,1}

\\newcolumntype{a}{>{\\columncolor{Gray}}c}
\\newcolumntype{b}{>{\\columncolor{white}}c}

\\title{å¾®ç©åˆ†è§£ç­”}
\\author{é™³å®éŠ˜\\\\
    æ±æµ·æ•¸å­¸ç³».\\\\
}
\\date{\\today}

\\renewcommand{\\theExercise}{\\arabic{Exercise}}
\\renewcommand{\\AnswerHeader}{\\medskip\\noindent\\textcolor{red}{\\textbf{SOLUTION}}\\;}
\\renewcommand{\\ExerciseName}{EXAMPLE}
\\renewcommand{\\ExerciseHeader}{\\noindent\\textbf{\\ExerciseName\\;\\ExerciseHeaderNB}}
\\newenvironment{Example}{\\begin{tcolorbox}\\begin{Exercise}}{\\end{Exercise}\\end{tcolorbox}}
\\setlength{\\ExerciseSkipBefore}{0pt}
\\newcommand\\independent{\\protect\\mathpalette{\\protect\\independenT}{\\perp}}
\\def\\independenT#1#2{\\mathrel{\\rlap{$#1#2$}\\mkern2mu{#1#2}}}
\\begin{document}
    \\begin{CJK}{UTF8}{bsmi}
        
        \\maketitle

        \\setstretch{1.5}
`;

        // å–å¾—æ‰€æœ‰å€å¡Š
        const blocks = document.getElementsByClassName("block");
        for (let i = 0; i < blocks.length; i++) {
          const select = blocks[i].getElementsByTagName("select")[0];
          const textarea = blocks[i].getElementsByTagName("textarea")[0];

          const blockType = select.value;
          const content = textarea.value;

          // è™•ç†ç‰¹æ®Šå­—ç¬¦
          const escapedContent = content.replace(/%/g, "\\%");

          if (blockType === "Example") {
            texContent += `
\\begin{Example}
${escapedContent}
\\end{Example}
`;
          } else if (blockType === "Answer") {
            texContent += `
\\begin{Answer}
${escapedContent}
\\end{Answer}
`;
          } else if (blockType === "Section") {
            texContent += `
\\section{${escapedContent}}
`;
          } else if (blockType === "Subsection") {
            texContent += `
\\subsection{${escapedContent}}
`;
          } else {
            // å…¶ä»–è‡ªå®šç¾©å…§å®¹
            texContent += `
${escapedContent}
`;
          }
        }

        // TeX æ¨¡æ¿çš„çµå°¾
        texContent += `
    \\end{CJK}
\\end{document}
`;

        // é¡¯ç¤ºç”Ÿæˆçš„ TeX å…§å®¹
        document.getElementById("tex-output").value = texContent;
      }

      document.getElementById("generate-tex").onclick = generateTeX;

      function downloadTeX() {
        generateTeX(); // ç¢ºä¿å…§å®¹æ˜¯æœ€æ–°çš„
        const texContent = document.getElementById("tex-output").value;
        const blob = new Blob([texContent], {
          type: "text/plain;charset=utf-8",
        });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "output.tex";
        link.click();
      }

      document.getElementById("download-tex").onclick = downloadTeX;

      // é è¨­æ–°å¢ä¸€å€‹å€å¡Š
      addBlock();

      // åˆ‡æ›æ·±æ·ºæ¨¡å¼
      const toggleThemeButton = document.getElementById("toggle-theme");
      toggleThemeButton.onclick = function () {
        if (document.documentElement.getAttribute("data-theme") === "dark") {
          document.documentElement.removeAttribute("data-theme");
          toggleThemeButton.textContent = "ğŸŒ™";
        } else {
          document.documentElement.setAttribute("data-theme", "dark");
          toggleThemeButton.textContent = "â˜€ï¸";
        }
      };
    </script>
  </body>
</html>
