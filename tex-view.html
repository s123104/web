<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LaTeX 即時渲染工具</title>
    
    <!-- 引入 Bootstrap CSS for 美觀設計（可選） -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- 引入 CodeMirror CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/theme/material-darker.min.css">
    
    <!-- 引入 MathJax -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <style>
        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        .container-fluid {
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .editor-container {
            flex: 1;
            display: flex;
            flex-direction: row;
            overflow: hidden;
        }
        .editor, .preview {
            width: 50%;
            padding: 20px;
            box-sizing: border-box;
            height: 100%;
            overflow-y: auto;
        }
        .editor {
            border-right: 1px solid #ccc;
            background-color: #2d2d2d;
        }
        .preview {
            background-color: #f8f9fa;
        }
        /* CodeMirror 自定義樣式 */
        .CodeMirror {
            height: 100%;
        }
        /* 響應式調整 */
        @media (max-width: 768px) {
            .editor, .preview {
                width: 100%;
                height: 50%;
            }
            .editor-container {
                flex-direction: column;
            }
            .editor {
                border-right: none;
                border-bottom: 1px solid #ccc;
            }
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <header class="bg-primary text-white text-center py-3">
            <h1>LaTeX 即時渲染工具</h1>
        </header>
        <div class="editor-container">
            <!-- 左側：LaTeX 編輯器 -->
            <div class="editor">
                <textarea id="latexInput">
% !Mode:: "TeX:UTF-8"
\[
\lim_{x \to -1^+} f(x) = 1
\]
\[
\lim_{x \to -2} f(x) \text{ does not exist.}
\]
\[
\lim_{x \to 2} f(x) = 2
\]
\[
\lim_{x \to -1^-} f(x) = 2
\]
\[
\lim_{x \to 1^+} f(x) = 1
\]
\[
\lim_{x \to -1} f(x) \text{ does not exist.}
\]
\[
\lim_{x \to 0^-} f(x) = \lim_{x \to 0^+} f(x)
\]
                </textarea>
            </div>
            
            <!-- 右側：即時渲染預覽 -->
            <div class="preview" id="preview">
                <!-- 渲染結果將顯示在此處 -->
            </div>
        </div>
        <footer class="bg-light text-center py-2">
            &copy; 2024 LaTeX 即時渲染工具
        </footer>
    </div>
    
    <!-- 引入 CodeMirror JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/stex/stex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/addon/edit/closetag.min.js"></script>
    
    <script>
        // 初始化 CodeMirror 編輯器
        var editor = CodeMirror.fromTextArea(document.getElementById("latexInput"), {
            mode: "stex",
            theme: "material-darker",
            lineNumbers: true,
            lineWrapping: true,
            autoCloseBrackets: true,
            matchBrackets: true
        });

        // 取得預覽區域
        var preview = document.getElementById("preview");

        // 定義渲染函數
        function renderLatex() {
            var content = editor.getValue();
            // 清除預覽區域
            preview.innerHTML = "";
            
            // 將 LaTeX 內容包裹在 div 中
            var latexDiv = document.createElement("div");
            latexDiv.textContent = content;
            preview.appendChild(latexDiv);
            
            // 重新渲染 MathJax
            MathJax.typesetPromise();
        }

        // 初始渲染
        renderLatex();

        // 監聽編輯器內容變化
        editor.on("change", function() {
            renderLatex();
        });
    </script>
</body>
</html>