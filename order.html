<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>綠萃軒 Verdant - 高級餐廳點餐系統</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Animate.css for enhanced animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- Tailwind Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            DEFAULT: '#1F3A34', // 深綠
                            light: '#2B4E45',
                            dark: '#152923'
                        },
                        accent: {
                            DEFAULT: '#C8AA6E', // 金色
                            light: '#D4BC89',
                            dark: '#B59754'
                        },
                        neutral: {
                            50: '#FAFAF7',  // 米白底
                            100: '#F5F5F0',
                            200: '#E8E8E0',
                            300: '#D1D1C7',
                            400: '#B8B8AD',
                            500: '#9A9A8F',
                            600: '#7A7A70',
                            700: '#5C5C54',
                            800: '#3E3E38',
                            900: '#2A2A26'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans TC', 'sans-serif']
                    },
                    spacing: {
                        '0.25': '0.0625rem',
                        '0.5': '0.125rem',
                        '0.75': '0.1875rem',
                        '1': '0.25rem',
                        '1.5': '0.375rem',
                        '2': '0.5rem',
                        '2.5': '0.625rem',
                        '3': '0.75rem',
                        '4': '1rem',
                        '5': '1.25rem',
                        '6': '1.5rem',
                        '7': '1.75rem',
                        '8': '2rem',
                        '10': '2.5rem',
                        '12': '3rem',
                        '16': '4rem'
                    },
                    animation: {
                        'fadeIn': 'fadeIn 0.5s ease-in-out',
                        'slideUp': 'slideUp 0.3s ease-out',
                        'slideIn': 'slideIn 0.3s ease-out',
                        'pulse-gentle': 'pulse-gentle 2s infinite'
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        },
                        slideIn: {
                            '0%': { transform: 'translateX(100%)', opacity: '0' },
                            '100%': { transform: 'translateX(0)', opacity: '1' }
                        },
                        'pulse-gentle': {
                            '0%, 100%': { opacity: '1' },
                            '50%': { opacity: '0.8' }
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- Custom Styles -->
    <style>
        /* 全域樣式設定 */
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* 卡片陰影效果 */
        .card-shadow {
            box-shadow: 0 2px 8px rgba(31, 58, 52, 0.08);
            transition: box-shadow 0.3s ease;
        }
        
        .card-shadow:hover {
            box-shadow: 0 4px 20px rgba(31, 58, 52, 0.12);
        }
        
        /* 按鈕按壓效果 */
        .btn-press:active {
            transform: scale(0.98);
        }
        
        /* 滑動捲軸樣式 */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(31, 58, 52, 0.05);
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(31, 58, 52, 0.2);
            border-radius: 3px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: rgba(31, 58, 52, 0.3);
        }
        
        /* 圖片載入動畫 */
        .img-loading {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Modal 背景模糊效果 */
        .modal-backdrop {
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        
        /* 彩蛋按鈕樣式 */
        .easter-egg-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            opacity: 0.1;
            z-index: 9999;
            cursor: default;
            transition: opacity 0.3s ease;
        }
        
        .easter-egg-btn:hover {
            opacity: 0.2;
        }
    </style>
</head>
<body class="bg-neutral-50 text-neutral-800 min-h-screen">
    
    <!-- Header 頂部導覽列 -->
    <header id="app-header" class="fixed top-0 left-0 right-0 bg-white shadow-sm z-40">
        <div class="max-w-[420px] mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center space-x-2">
                <i class="fas fa-leaf text-primary text-xl"></i>
                <h1 class="font-semibold text-lg">綠萃軒</h1>
            </div>
            <button id="lang-toggle" class="text-sm text-neutral-600 hover:text-primary transition-colors">
                <i class="fas fa-globe mr-1"></i>
                <span id="lang-text">繁體</span>
            </button>
        </div>
    </header>
    
    <!-- Welcome Screen 歡迎畫面 -->
    <section id="welcome-screen" class="min-h-screen flex flex-col items-center justify-center px-4 animate__animated animate__fadeIn">
        <div class="text-center max-w-[320px]">
            <!-- Logo -->
            <div class="w-32 h-32 mx-auto mb-6 bg-primary rounded-full flex items-center justify-center">
                <i class="fas fa-leaf text-white text-5xl"></i>
            </div>
            
            <!-- 品牌名稱 -->
            <h1 class="text-3xl font-bold text-primary mb-2">綠萃軒</h1>
            <p class="text-accent font-medium mb-8">Verdant</p>
            
            <!-- 歡迎語 -->
            <p class="text-neutral-600 mb-12 leading-relaxed">
                為您呈獻精緻美饌<br>
                開啟味蕾的奢華旅程
            </p>
            
            <!-- 開始點餐按鈕 -->
            <button id="start-ordering" class="w-full bg-primary text-white py-4 rounded-lg font-medium hover:bg-primary-dark transition-all duration-300 btn-press">
                開始點餐
                <i class="fas fa-arrow-right ml-2"></i>
            </button>
        </div>
    </section>
    
    <!-- Category Tabs 分類選單 -->
    <nav id="category-tabs" class="fixed top-[60px] left-0 right-0 bg-white border-b border-neutral-200 z-30 hidden">
        <div class="max-w-[420px] mx-auto">
            <div class="flex overflow-x-auto custom-scrollbar">
                <button class="category-tab active px-6 py-3 text-sm font-medium whitespace-nowrap border-b-2 border-accent text-primary transition-all duration-200" data-category="appetizer">
                    前菜
                </button>
                <button class="category-tab px-6 py-3 text-sm font-medium whitespace-nowrap border-b-2 border-transparent text-neutral-600 hover:text-primary transition-all duration-200" data-category="main">
                    主餐
                </button>
                <button class="category-tab px-6 py-3 text-sm font-medium whitespace-nowrap border-b-2 border-transparent text-neutral-600 hover:text-primary transition-all duration-200" data-category="dessert">
                    甜點
                </button>
                <button class="category-tab px-6 py-3 text-sm font-medium whitespace-nowrap border-b-2 border-transparent text-neutral-600 hover:text-primary transition-all duration-200" data-category="beverage">
                    飲品
                </button>
            </div>
        </div>
    </nav>
    
    <!-- Menu List 商品列表 -->
    <section id="menu-list" class="max-w-[420px] mx-auto px-4 pt-[120px] pb-24 hidden">
        <div id="menu-container" class="grid grid-cols-1 gap-4">
            <!-- 動態載入商品卡片 -->
        </div>
        
        <!-- 空狀態提示 -->
        <div id="empty-state" class="text-center py-16 hidden">
            <i class="fas fa-utensils text-5xl text-neutral-300 mb-4"></i>
            <p class="text-neutral-500">此分類暫無商品</p>
        </div>
    </section>
    
    <!-- Product Detail Modal 商品詳情彈窗 -->
    <div id="product-detail-modal" class="fixed inset-0 z-50 hidden">
        <div class="modal-backdrop absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl max-h-[80vh] overflow-hidden animate__animated animate__slideInUp">
            <div class="p-4">
                <!-- 關閉按鈕 -->
                <button id="close-modal" class="absolute top-4 right-4 w-8 h-8 bg-neutral-100 rounded-full flex items-center justify-center hover:bg-neutral-200 transition-colors">
                    <i class="fas fa-times text-neutral-600"></i>
                </button>
                
                <!-- 商品圖片 -->
                <img id="modal-image" src="" alt="" class="w-full h-48 object-cover rounded-lg mb-4">
                
                <!-- 商品資訊 -->
                <h2 id="modal-title" class="text-xl font-bold text-neutral-800 mb-2"></h2>
                <p id="modal-description" class="text-neutral-600 text-sm mb-4 leading-relaxed"></p>
                <p id="modal-price" class="text-2xl font-bold text-accent mb-6"></p>
                
                <!-- 客製化選項 -->
                <div id="customization-options" class="mb-6">
                    <!-- 動態載入選項 -->
                </div>
                
                <!-- 備註欄位 -->
                <div class="mb-6">
                    <label class="text-sm font-medium text-neutral-700 mb-2 block">備註</label>
                    <textarea id="order-notes" class="w-full p-3 border border-neutral-200 rounded-lg text-sm resize-none focus:outline-none focus:border-primary transition-colors" rows="2" placeholder="請輸入特殊需求（如：少鹽、不要辣等）"></textarea>
                </div>
                
                <!-- 數量選擇與加入購物車 -->
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <button id="qty-minus" class="w-8 h-8 bg-neutral-100 rounded-full flex items-center justify-center hover:bg-neutral-200 transition-colors btn-press">
                            <i class="fas fa-minus text-sm"></i>
                        </button>
                        <span id="qty-value" class="font-medium text-lg min-w-[2rem] text-center">1</span>
                        <button id="qty-plus" class="w-8 h-8 bg-neutral-100 rounded-full flex items-center justify-center hover:bg-neutral-200 transition-colors btn-press">
                            <i class="fas fa-plus text-sm"></i>
                        </button>
                    </div>
                    <button id="add-to-cart" class="bg-primary text-white px-6 py-3 rounded-lg font-medium hover:bg-primary-dark transition-all duration-300 btn-press">
                        加入餐點
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Order Cart 購物車側邊欄 -->
    <aside id="order-cart" class="fixed top-0 right-0 h-full w-full max-w-[360px] bg-white shadow-2xl transform translate-x-full transition-transform duration-300 z-40">
        <div class="h-full flex flex-col">
            <!-- 購物車標題 -->
            <div class="p-4 border-b border-neutral-200">
                <div class="flex items-center justify-between">
                    <h2 class="text-lg font-semibold">我的餐點</h2>
                    <button id="close-cart" class="w-8 h-8 bg-neutral-100 rounded-full flex items-center justify-center hover:bg-neutral-200 transition-colors">
                        <i class="fas fa-times text-neutral-600"></i>
                    </button>
                </div>
            </div>
            
            <!-- 購物車內容 -->
            <div id="cart-items" class="flex-1 overflow-y-auto custom-scrollbar p-4">
                <!-- 動態載入購物車項目 -->
            </div>
            
            <!-- 購物車空狀態 -->
            <div id="cart-empty" class="flex-1 flex flex-col items-center justify-center p-4">
                <i class="fas fa-shopping-cart text-5xl text-neutral-300 mb-4"></i>
                <p class="text-neutral-500">尚未選擇餐點</p>
            </div>
            
            <!-- 結帳區域 -->
            <div id="cart-footer" class="border-t border-neutral-200 p-4 hidden">
                <div class="flex items-center justify-between mb-4">
                    <span class="font-medium">總計</span>
                    <span id="cart-total" class="text-xl font-bold text-accent">NT$ 0</span>
                </div>
                <button id="checkout-btn" class="w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-primary-dark transition-all duration-300 btn-press">
                    送出訂單
                </button>
            </div>
        </div>
    </aside>
    
    <!-- Floating Cart Button 浮動購物車按鈕 -->
    <button id="floating-cart" class="fixed bottom-6 right-6 w-14 h-14 bg-primary text-white rounded-full shadow-lg flex items-center justify-center hover:bg-primary-dark transition-all duration-300 btn-press hidden z-30">
        <i class="fas fa-shopping-cart"></i>
        <span id="cart-count" class="absolute -top-1 -right-1 w-5 h-5 bg-accent text-primary text-xs font-bold rounded-full flex items-center justify-center hidden">0</span>
    </button>
    
    <!-- Toast Notification 提示訊息 -->
    <div id="toast-notification" class="fixed top-20 left-1/2 transform -translate-x-1/2 bg-white shadow-lg rounded-lg px-4 py-3 flex items-center space-x-3 min-w-[280px] z-50 hidden">
        <i id="toast-icon" class="fas fa-check-circle text-green-500"></i>
        <span id="toast-message" class="text-sm font-medium text-neutral-700"></span>
    </div>
    
    <!-- Easter Egg Button 彩蛋觸發按鈕 -->
    <button class="easter-egg-btn" id="easter-egg-trigger">
        <i class="fas fa-egg text-neutral-300"></i>
    </button>
    
    <!-- Easter Egg Modal 彩蛋內容 -->
    <div id="easter-egg-modal" class="fixed inset-0 z-[100] hidden">
        <div class="modal-backdrop absolute inset-0 bg-black bg-opacity-75"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-2xl p-6 max-w-[360px] w-[90%] text-center">
            <h3 class="text-2xl font-bold text-primary mb-4">🎉 恭喜發現彩蛋！</h3>
            <p class="text-neutral-600 mb-6">您已解鎖綠萃軒的秘密優惠碼</p>
            <div class="bg-neutral-100 rounded-lg p-4 mb-6">
                <p class="text-sm text-neutral-500 mb-1">優惠碼</p>
                <p class="text-2xl font-bold text-accent">VERDANT2024</p>
            </div>
            <p class="text-sm text-neutral-500 mb-4">結帳時輸入可享 9 折優惠</p>
            <button id="close-easter-egg" class="w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-primary-dark transition-all duration-300 btn-press">
                太棒了！
            </button>
        </div>
    </div>
    
    <script>
        // ==========================================
        // 全域變數與初始化
        // ==========================================
        
        // 應用程式狀態管理
        const app = {
            currentCategory: 'appetizer',
            currentLang: 'zh',
            cart: [],
            selectedProduct: null,
            currentQty: 1,
            easterEggClickCount: 0
        };
        
        // 模擬商品資料庫
        const menuData = {
            appetizer: [
                {
                    id: 1,
                    name: '松露野菇濃湯',
                    nameEn: 'Truffle Mushroom Soup',
                    price: 380,
                    description: '選用新鮮野菇與頂級黑松露，慢火熬煮的法式濃湯',
                    descriptionEn: 'French soup made with fresh wild mushrooms and premium black truffle',
                    image: 'https://images.unsplash.com/photo-1547592166-23ac45744acd?w=400',
                    options: {
                        temperature: ['熱湯', '溫湯']
                    }
                },
                {
                    id: 2,
                    name: '煙燻鮭魚塔塔',
                    nameEn: 'Smoked Salmon Tartare',
                    price: 420,
                    description: '挪威煙燻鮭魚搭配酪梨、酸豆與蒔蘿醬',
                    descriptionEn: 'Norwegian smoked salmon with avocado, capers and dill sauce',
                    image: 'https://images.unsplash.com/photo-1519708227418-c8fd9a32b7a2?w=400',
                    options: {
                        spice: ['原味', '黑胡椒']
                    }
                }
            ],
            main: [
                {
                    id: 3,
                    name: '炭烤肋眼牛排',
                    nameEn: 'Grilled Ribeye Steak',
                    price: 1280,
                    description: '澳洲和牛肋眼，炭火烤製，搭配季節時蔬',
                    descriptionEn: 'Australian Wagyu ribeye, charcoal grilled with seasonal vegetables',
                    image: 'https://images.unsplash.com/photo-1546833999-b9f581a1996d?w=400',
                    options: {
                        doneness: ['三分熟', '五分熟', '七分熟', '全熟'],
                        sauce: ['黑胡椒醬', '紅酒醬', '蘑菇醬']
                    }
                },
                {
                    id: 4,
                    name: '龍蝦燉飯',
                    nameEn: 'Lobster Risotto',
                    price: 980,
                    description: '波士頓龍蝦搭配義大利米，番紅花奶油醬汁',
                    descriptionEn: 'Boston lobster with Italian rice in saffron cream sauce',
                    image: 'https://images.unsplash.com/photo-1633504581786-316c8002b1b9?w=400',
                    options: {
                        portion: ['標準份', '大份']
                    }
                }
            ],
            dessert: [
                {
                    id: 5,
                    name: '巧克力熔岩蛋糕',
                    nameEn: 'Chocolate Lava Cake',
                    price: 280,
                    description: '溫熱巧克力蛋糕，搭配香草冰淇淋',
                    descriptionEn: 'Warm chocolate cake with vanilla ice cream',
                    image: 'https://images.unsplash.com/photo-1624353365286-3f8d62daad51?w=400',
                    options: {
                        iceCream: ['香草', '巧克力', '抹茶']
                    }
                }
            ],
            beverage: [
                {
                    id: 6,
                    name: '手沖精品咖啡',
                    nameEn: 'Pour Over Coffee',
                    price: 180,
                    description: '精選單品咖啡豆，專業手沖製作',
                    descriptionEn: 'Selected single origin coffee, professionally hand-brewed',
                    image: 'https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400',
                    options: {
                        bean: ['衣索比亞', '哥倫比亞', '肯亞'],
                        temperature: ['熱', '冰']
                    }
                }
            ]
        };
        
        // ==========================================
        // DOM 元素快取
        // ==========================================
        const elements = {
            welcomeScreen: document.getElementById('welcome-screen'),
            categoryTabs: document.getElementById('category-tabs'),
            menuList: document.getElementById('menu-list'),
            menuContainer: document.getElementById('menu-container'),
            productModal: document.getElementById('product-detail-modal'),
            orderCart: document.getElementById('order-cart'),
            floatingCart: document.getElementById('floating-cart'),
            cartCount: document.getElementById('cart-count'),
            toast: document.getElementById('toast-notification'),
            easterEggModal: document.getElementById('easter-egg-modal')
        };
        
        // ==========================================
        // 工具函數
        // ==========================================
        
        // 顯示 Toast 提示訊息
        function showToast(message, type = 'success') {
            const toast = elements.toast;
            const icon = document.getElementById('toast-icon');
            const msg = document.getElementById('toast-message');
            
            // 設定圖示與訊息
            if (type === 'success') {
                icon.className = 'fas fa-check-circle text-green-500';
            } else if (type === 'error') {
                icon.className = 'fas fa-exclamation-circle text-red-500';
            }
            
            msg.textContent = message;
            
            // 顯示 Toast
            toast.classList.remove('hidden');
            toast.classList.add('animate__animated', 'animate__fadeInDown');
            
            // 3秒後自動隐藏
            setTimeout(() => {
                toast.classList.add('animate__fadeOutUp');
                setTimeout(() => {
                    toast.classList.add('hidden');
                    toast.classList.remove('animate__animated', 'animate__fadeInDown', 'animate__fadeOutUp');
                }, 500);
            }, 3000);
        }
        
        // 格式化價格
        function formatPrice(price) {
            return `NT$ ${price.toLocaleString()}`;
        }
        
        // 更新購物車數量顯示
        function updateCartCount() {
            const count = app.cart.reduce((sum, item) => sum + item.quantity, 0);
            const cartCount = elements.cartCount;
            
            if (count > 0) {
                cartCount.textContent = count;
                cartCount.classList.remove('hidden');
                elements.floatingCart.classList.add('animate__animated', 'animate__pulse');
                setTimeout(() => {
                    elements.floatingCart.classList.remove('animate__animated', 'animate__pulse');
                }, 1000);
            } else {
                cartCount.classList.add('hidden');
            }
        }
        
        // ==========================================
        // 頁面切換與導航
        // ==========================================
        
        // 開始點餐
        document.getElementById('start-ordering').addEventListener('click', () => {
            elements.welcomeScreen.classList.add('animate__animated', 'animate__fadeOut');
            
            setTimeout(() => {
                elements.welcomeScreen.classList.add('hidden');
                elements.categoryTabs.classList.remove('hidden');
                elements.menuList.classList.remove('hidden');
                elements.floatingCart.classList.remove('hidden');
                
                renderMenuItems('appetizer');
            }, 500);
        });
        
        // 語言切換
        document.getElementById('lang-toggle').addEventListener('click', () => {
            app.currentLang = app.currentLang === 'zh' ? 'en' : 'zh';
            document.getElementById('lang-text').textContent = app.currentLang === 'zh' ? '繁體' : 'EN';
            
            // 重新渲染當前分類
            renderMenuItems(app.currentCategory);
        });
        
        // 分類切換
        document.querySelectorAll('.category-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // 更新 active 狀態
                document.querySelector('.category-tab.active').classList.remove('active', 'border-accent', 'text-primary');
                document.querySelector('.category-tab.active').classList.add('border-transparent', 'text-neutral-600');
                
                this.classList.add('active', 'border-accent', 'text-primary');
                this.classList.remove('border-transparent', 'text-neutral-600');
                
                // 渲染對應分類商品
                const category = this.getAttribute('data-category');
                app.currentCategory = category;
                renderMenuItems(category);
            });
        });
        
        // ==========================================
        // 商品展示功能
        // ==========================================
        
        // 渲染商品列表
        function renderMenuItems(category) {
            const container = elements.menuContainer;
            const items = menuData[category] || [];
            
            // 清空容器
            container.innerHTML = '';
            
            if (items.length === 0) {
                document.getElementById('empty-state').classList.remove('hidden');
                return;
            }
            
            document.getElementById('empty-state').classList.add('hidden');
            
            // 渲染商品卡片
            items.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-xl overflow-hidden card-shadow animate__animated animate__fadeInUp';
                card.style.animationDelay = `${index * 0.1}s`;
                
                card.innerHTML = `
                    <div class="relative">
                        <img src="${item.image}" alt="${item.name}" class="w-full h-48 object-cover img-loading" onload="this.classList.remove('img-loading')">
                        <div class="absolute top-3 right-3 bg-accent text-primary text-xs font-semibold px-2 py-1 rounded">
                            人氣
                        </div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-lg text-neutral-800 mb-1">
                            ${app.currentLang === 'zh' ? item.name : item.nameEn}
                        </h3>
                        <p class="text-neutral-600 text-sm mb-3 line-clamp-2">
                            ${app.currentLang === 'zh' ? item.description : item.descriptionEn}
                        </p>
                        <div class="flex items-center justify-between">
                            <span class="text-accent font-bold text-lg">${formatPrice(item.price)}</span>
                            <button class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary-dark transition-all duration-300 btn-press" onclick="showProductDetail(${item.id})">
                                選擇
                            </button>
                        </div>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        // ==========================================
        // 商品詳情功能
        // ==========================================
        
        // 顯示商品詳情
        function showProductDetail(productId) {
            // 找到商品資料
            let product = null;
            for (const category in menuData) {
                product = menuData[category].find(item => item.id === productId);
                if (product) break;
            }
            
            if (!product) return;
            
            app.selectedProduct = product;
            app.currentQty = 1;
            
            // 填充詳情資料
            document.getElementById('modal-image').src = product.image;
            document.getElementById('modal-title').textContent = app.currentLang === 'zh' ? product.name : product.nameEn;
            document.getElementById('modal-description').textContent = app.currentLang === 'zh' ? product.description : product.descriptionEn;
            document.getElementById('modal-price').textContent = formatPrice(product.price);
            document.getElementById('qty-value').textContent = '1';
            
            // 渲染客製化選項
            const optionsContainer = document.getElementById('customization-options');
            optionsContainer.innerHTML = '';
            
            if (product.options) {
                Object.entries(product.options).forEach(([key, values]) => {
                    const optionGroup = document.createElement('div');
                    optionGroup.className = 'mb-4';
                    
                    const label = {
                        temperature: '溫度',
                        spice: '調味',
                        doneness: '熟度',
                        sauce: '醬汁',
                        portion: '份量',
                        iceCream: '冰淇淋',
                        bean: '咖啡豆'
                    };
                    
                    optionGroup.innerHTML = `
                        <label class="text-sm font-medium text-neutral-700 mb-2 block">${label[key] || key}</label>
                        <div class="flex flex-wrap gap-2">
                            ${values.map((value, index) => `
                                <label class="option-label">
                                    <input type="radio" name="${key}" value="${value}" ${index === 0 ? 'checked' : ''} class="hidden">
                                    <span class="inline-block px-4 py-2 border border-neutral-200 rounded-lg text-sm cursor-pointer hover:border-primary transition-colors">
                                        ${value}
                                    </span>
                                </label>
                            `).join('')}
                        </div>
                    `;
                    
                    optionsContainer.appendChild(optionGroup);
                });
                
                // 為選項添加互動效果
                document.querySelectorAll('.option-label input').forEach(input => {
                    input.addEventListener('change', function() {
                        const parent = this.closest('.option-label').parentElement;
                        parent.querySelectorAll('span').forEach(span => {
                            span.classList.remove('bg-primary', 'text-white', 'border-primary');
                        });
                        
                        if (this.checked) {
                            this.nextElementSibling.classList.add('bg-primary', 'text-white', 'border-primary');
                        }
                    });
                });
                
                // 初始化選中狀態
                document.querySelectorAll('.option-label input:checked').forEach(input => {
                    input.nextElementSibling.classList.add('bg-primary', 'text-white', 'border-primary');
                });
            }
            
            // 顯示 Modal
            elements.productModal.classList.remove('hidden');
        }
        
        // 關閉商品詳情
        document.getElementById('close-modal').addEventListener('click', () => {
            const modal = elements.productModal;
            modal.querySelector('.absolute.bottom-0').classList.add('animate__animated', 'animate__slideOutDown');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                modal.querySelector('.absolute.bottom-0').classList.remove('animate__animated', 'animate__slideOutDown');
                
                // 清空備註
                document.getElementById('order-notes').value = '';
            }, 300);
        });
        
        // 數量控制
        document.getElementById('qty-minus').addEventListener('click', () => {
            if (app.currentQty > 1) {
                app.currentQty--;
                document.getElementById('qty-value').textContent = app.currentQty;
            }
        });
        
        document.getElementById('qty-plus').addEventListener('click', () => {
            if (app.currentQty < 10) {
                app.currentQty++;
                document.getElementById('qty-value').textContent = app.currentQty;
            }
        });
        
        // 加入購物車
        document.getElementById('add-to-cart').addEventListener('click', () => {
            if (!app.selectedProduct) return;
            
            // 收集選項
            const options = {};
            document.querySelectorAll('.option-label input:checked').forEach(input => {
                options[input.name] = input.value;
            });
            
            // 建立購物車項目
            const cartItem = {
                id: Date.now(), // 使用時間戳作為唯一 ID
                productId: app.selectedProduct.id,
                name: app.currentLang === 'zh' ? app.selectedProduct.name : app.selectedProduct.nameEn,
                price: app.selectedProduct.price,
                quantity: app.currentQty,
                options: options,
                notes: document.getElementById('order-notes').value
            };
            
            // 加入購物車
            app.cart.push(cartItem);
            updateCartCount();
            renderCartItems();
            
            // 關閉 Modal
            document.getElementById('close-modal').click();
            
            // 顯示成功提示
            showToast(`已加入 ${cartItem.name} × ${cartItem.quantity}`);
        });
        
        // ==========================================
        // 購物車功能
        // ==========================================
        
        // 顯示購物車
        document.getElementById('floating-cart').addEventListener('click', () => {
            elements.orderCart.classList.remove('translate-x-full');
            renderCartItems();
        });
        
        // 關閉購物車
        document.getElementById('close-cart').addEventListener('click', () => {
            elements.orderCart.classList.add('translate-x-full');
        });
        
        // 渲染購物車內容
        function renderCartItems() {
            const container = document.getElementById('cart-items');
            const emptyState = document.getElementById('cart-empty');
            const footer = document.getElementById('cart-footer');
            
            if (app.cart.length === 0) {
                container.classList.add('hidden');
                emptyState.classList.remove('hidden');
                footer.classList.add('hidden');
                return;
            }
            
            container.classList.remove('hidden');
            emptyState.classList.add('hidden');
            footer.classList.remove('hidden');
            
            // 渲染購物車項目
            container.innerHTML = app.cart.map(item => `
                <div class="bg-neutral-50 rounded-lg p-3 mb-3 animate__animated animate__fadeIn">
                    <div class="flex items-start justify-between mb-2">
                        <h4 class="font-medium text-neutral-800">${item.name}</h4>
                        <button class="text-neutral-400 hover:text-red-500 transition-colors" onclick="removeFromCart(${item.id})">
                            <i class="fas fa-trash-alt text-sm"></i>
                        </button>
                    </div>
                    ${Object.entries(item.options).map(([key, value]) => `
                        <p class="text-xs text-neutral-600 mb-1">${value}</p>
                    `).join('')}
                    ${item.notes ? `<p class="text-xs text-neutral-500 italic mb-2">備註: ${item.notes}</p>` : ''}
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <button class="w-6 h-6 bg-white rounded flex items-center justify-center hover:bg-neutral-200 transition-colors btn-press" onclick="updateCartItemQty(${item.id}, -1)">
                                <i class="fas fa-minus text-xs"></i>
                            </button>
                            <span class="text-sm font-medium min-w-[1.5rem] text-center">${item.quantity}</span>
                            <button class="w-6 h-6 bg-white rounded flex items-center justify-center hover:bg-neutral-200 transition-colors btn-press" onclick="updateCartItemQty(${item.id}, 1)">
                                <i class="fas fa-plus text-xs"></i>
                            </button>
                        </div>
                        <span class="text-accent font-medium">${formatPrice(item.price * item.quantity)}</span>
                    </div>
                </div>
            `).join('');
            
            // 更新總金額
            const total = app.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('cart-total').textContent = formatPrice(total);
        }
        
        // 從購物車移除
        function removeFromCart(itemId) {
            app.cart = app.cart.filter(item => item.id !== itemId);
            updateCartCount();
            renderCartItems();
            showToast('已從購物車移除');
        }
        
        // 更新購物車商品數量
        function updateCartItemQty(itemId, delta) {
            const item = app.cart.find(item => item.id === itemId);
            if (!item) return;
            
            const newQty = item.quantity + delta;
            if (newQty > 0 && newQty <= 10) {
                item.quantity = newQty;
                updateCartCount();
                renderCartItems();
            }
        }
        
        // 結帳
        document.getElementById('checkout-btn').addEventListener('click', () => {
            if (app.cart.length === 0) return;
            
            // 關閉購物車
            elements.orderCart.classList.add('translate-x-full');
            
            // 顯示成功提示
            showToast('訂單已送出！廚房正在準備您的餐點', 'success');
            
            // 清空購物車
            app.cart = [];
            updateCartCount();
            
            // 模擬付款選擇（可擴展）
            setTimeout(() => {
                if (confirm('是否使用 Line Pay 付款？')) {
                    showToast('已導向 Line Pay 付款頁面', 'success');
                } else {
                    showToast('請至櫃檯付款', 'success');
                }
            }, 2000);
        });
        
        // ==========================================
        // 彩蛋功能
        // ==========================================
        
        // 彩蛋觸發邏輯：連點三次
        document.getElementById('easter-egg-trigger').addEventListener('click', () => {
            app.easterEggClickCount++;
            
            if (app.easterEggClickCount === 3) {
                // 顯示彩蛋
                elements.easterEggModal.classList.remove('hidden');
                elements.easterEggModal.classList.add('animate__animated', 'animate__zoomIn');
                
                // 重置計數
                app.easterEggClickCount = 0;
                
                // 記錄彩蛋觸發
                console.log('🎉 Easter egg triggered!');
            }
            
            // 5秒後重置計數
            setTimeout(() => {
                app.easterEggClickCount = 0;
            }, 5000);
        });
        
        // 關閉彩蛋
        document.getElementById('close-easter-egg').addEventListener('click', () => {
            const modal = elements.easterEggModal;
            modal.classList.add('animate__animated', 'animate__zoomOut');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                modal.classList.remove('animate__animated', 'animate__zoomIn', 'animate__zoomOut');
            }, 500);
        });
        
        // 鍵盤彩蛋：輸入 "verdant" 觸發
        let keySequence = '';
        document.addEventListener('keydown', (e) => {
            keySequence += e.key.toLowerCase();
            
            if (keySequence.includes('verdant')) {
                // 觸發彩蛋
                elements.easterEggModal.classList.remove('hidden');
                elements.easterEggModal.classList.add('animate__animated', 'animate__zoomIn');
                
                // 重置序列
                keySequence = '';
            }
            
            // 保持序列長度限制
            if (keySequence.length > 20) {
                keySequence = keySequence.slice(-20);
            }
        });
        
        // ==========================================
        // 效能優化：圖片懶載入
        // ==========================================
        
        // Intersection Observer for lazy loading
        const imageObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    img.src = img.dataset.src;
                    img.onload = () => {
                        img.classList.remove('img-loading');
                    };
                    imageObserver.unobserve(img);
                }
            });
        });
        
        // 監聽所有需要懶載入的圖片
        document.querySelectorAll('img[data-src]').forEach(img => {
            imageObserver.observe(img);
        });
        
        // ==========================================
        // 手機返回鍵處理
        // ==========================================
        
        window.addEventListener('popstate', (e) => {
            // 如果購物車開啟，先關閉購物車
            if (!elements.orderCart.classList.contains('translate-x-full')) {
                elements.orderCart.classList.add('translate-x-full');
                e.preventDefault();
            }
            // 如果商品詳情開啟，關閉詳情
            else if (!elements.productModal.classList.contains('hidden')) {
                document.getElementById('close-modal').click();
                e.preventDefault();
            }
        });
    </script>
</body>
</html>