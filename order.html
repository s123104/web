<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¶ èƒè»’ Verdant - é«˜ç´šé¤å»³é»é¤ç³»çµ±</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Animate.css for enhanced animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- Tailwind Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            DEFAULT: '#1F3A34', // æ·±ç¶ 
                            light: '#2B4E45',
                            dark: '#152923'
                        },
                        accent: {
                            DEFAULT: '#C8AA6E', // é‡‘è‰²
                            light: '#D4BC89',
                            dark: '#B59754'
                        },
                        neutral: {
                            50: '#FAFAF7',  // ç±³ç™½åº•
                            100: '#F5F5F0',
                            200: '#E8E8E0',
                            300: '#D1D1C7',
                            400: '#B8B8AD',
                            500: '#9A9A8F',
                            600: '#7A7A70',
                            700: '#5C5C54',
                            800: '#3E3E38',
                            900: '#2A2A26'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans TC', 'sans-serif']
                    },
                    spacing: {
                        '0.25': '0.0625rem',
                        '0.5': '0.125rem',
                        '0.75': '0.1875rem',
                        '1': '0.25rem',
                        '1.5': '0.375rem',
                        '2': '0.5rem',
                        '2.5': '0.625rem',
                        '3': '0.75rem',
                        '4': '1rem',
                        '5': '1.25rem',
                        '6': '1.5rem',
                        '7': '1.75rem',
                        '8': '2rem',
                        '10': '2.5rem',
                        '12': '3rem',
                        '16': '4rem'
                    },
                    animation: {
                        'fadeIn': 'fadeIn 0.5s ease-in-out',
                        'slideUp': 'slideUp 0.3s ease-out',
                        'slideIn': 'slideIn 0.3s ease-out',
                        'pulse-gentle': 'pulse-gentle 2s infinite'
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        },
                        slideIn: {
                            '0%': { transform: 'translateX(100%)', opacity: '0' },
                            '100%': { transform: 'translateX(0)', opacity: '1' }
                        },
                        'pulse-gentle': {
                            '0%, 100%': { opacity: '1' },
                            '50%': { opacity: '0.8' }
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- Custom Styles -->
    <style>
        /* å…¨åŸŸæ¨£å¼è¨­å®š */
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* å¡ç‰‡é™°å½±æ•ˆæœ */
        .card-shadow {
            box-shadow: 0 2px 8px rgba(31, 58, 52, 0.08);
            transition: box-shadow 0.3s ease;
        }
        
        .card-shadow:hover {
            box-shadow: 0 4px 20px rgba(31, 58, 52, 0.12);
        }
        
        /* æŒ‰éˆ•æŒ‰å£“æ•ˆæœ */
        .btn-press:active {
            transform: scale(0.98);
        }
        
        /* æ»‘å‹•æ²è»¸æ¨£å¼ */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(31, 58, 52, 0.05);
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(31, 58, 52, 0.2);
            border-radius: 3px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: rgba(31, 58, 52, 0.3);
        }
        
        /* åœ–ç‰‡è¼‰å…¥å‹•ç•« */
        .img-loading {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Modal èƒŒæ™¯æ¨¡ç³Šæ•ˆæœ */
        .modal-backdrop {
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        
        /* å½©è›‹æŒ‰éˆ•æ¨£å¼ */
        .easter-egg-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            opacity: 0.1;
            z-index: 9999;
            cursor: default;
            transition: opacity 0.3s ease;
        }
        
        .easter-egg-btn:hover {
            opacity: 0.2;
        }
    </style>
</head>
<body class="bg-neutral-50 text-neutral-800 min-h-screen">
    
    <!-- Header é ‚éƒ¨å°è¦½åˆ— -->
    <header id="app-header" class="fixed top-0 left-0 right-0 bg-white shadow-sm z-40">
        <div class="max-w-[420px] mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center space-x-2">
                <i class="fas fa-leaf text-primary text-xl"></i>
                <h1 class="font-semibold text-lg">ç¶ èƒè»’</h1>
            </div>
            <button id="lang-toggle" class="text-sm text-neutral-600 hover:text-primary transition-colors">
                <i class="fas fa-globe mr-1"></i>
                <span id="lang-text">ç¹é«”</span>
            </button>
        </div>
    </header>
    
    <!-- Welcome Screen æ­¡è¿ç•«é¢ -->
    <section id="welcome-screen" class="min-h-screen flex flex-col items-center justify-center px-4 animate__animated animate__fadeIn">
        <div class="text-center max-w-[320px]">
            <!-- Logo -->
            <div class="w-32 h-32 mx-auto mb-6 bg-primary rounded-full flex items-center justify-center">
                <i class="fas fa-leaf text-white text-5xl"></i>
            </div>
            
            <!-- å“ç‰Œåç¨± -->
            <h1 class="text-3xl font-bold text-primary mb-2">ç¶ èƒè»’</h1>
            <p class="text-accent font-medium mb-8">Verdant</p>
            
            <!-- æ­¡è¿èª -->
            <p class="text-neutral-600 mb-12 leading-relaxed">
                ç‚ºæ‚¨å‘ˆç»ç²¾ç·»ç¾é¥Œ<br>
                é–‹å•Ÿå‘³è•¾çš„å¥¢è¯æ—…ç¨‹
            </p>
            
            <!-- é–‹å§‹é»é¤æŒ‰éˆ• -->
            <button id="start-ordering" class="w-full bg-primary text-white py-4 rounded-lg font-medium hover:bg-primary-dark transition-all duration-300 btn-press">
                é–‹å§‹é»é¤
                <i class="fas fa-arrow-right ml-2"></i>
            </button>
        </div>
    </section>
    
    <!-- Category Tabs åˆ†é¡é¸å–® -->
    <nav id="category-tabs" class="fixed top-[60px] left-0 right-0 bg-white border-b border-neutral-200 z-30 hidden">
        <div class="max-w-[420px] mx-auto">
            <div class="flex overflow-x-auto custom-scrollbar">
                <button class="category-tab active px-6 py-3 text-sm font-medium whitespace-nowrap border-b-2 border-accent text-primary transition-all duration-200" data-category="appetizer">
                    å‰èœ
                </button>
                <button class="category-tab px-6 py-3 text-sm font-medium whitespace-nowrap border-b-2 border-transparent text-neutral-600 hover:text-primary transition-all duration-200" data-category="main">
                    ä¸»é¤
                </button>
                <button class="category-tab px-6 py-3 text-sm font-medium whitespace-nowrap border-b-2 border-transparent text-neutral-600 hover:text-primary transition-all duration-200" data-category="dessert">
                    ç”œé»
                </button>
                <button class="category-tab px-6 py-3 text-sm font-medium whitespace-nowrap border-b-2 border-transparent text-neutral-600 hover:text-primary transition-all duration-200" data-category="beverage">
                    é£²å“
                </button>
            </div>
        </div>
    </nav>
    
    <!-- Menu List å•†å“åˆ—è¡¨ -->
    <section id="menu-list" class="max-w-[420px] mx-auto px-4 pt-[120px] pb-24 hidden">
        <div id="menu-container" class="grid grid-cols-1 gap-4">
            <!-- å‹•æ…‹è¼‰å…¥å•†å“å¡ç‰‡ -->
        </div>
        
        <!-- ç©ºç‹€æ…‹æç¤º -->
        <div id="empty-state" class="text-center py-16 hidden">
            <i class="fas fa-utensils text-5xl text-neutral-300 mb-4"></i>
            <p class="text-neutral-500">æ­¤åˆ†é¡æš«ç„¡å•†å“</p>
        </div>
    </section>
    
    <!-- Product Detail Modal å•†å“è©³æƒ…å½ˆçª— -->
    <div id="product-detail-modal" class="fixed inset-0 z-50 hidden">
        <div class="modal-backdrop absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl max-h-[80vh] overflow-hidden animate__animated animate__slideInUp">
            <div class="p-4">
                <!-- é—œé–‰æŒ‰éˆ• -->
                <button id="close-modal" class="absolute top-4 right-4 w-8 h-8 bg-neutral-100 rounded-full flex items-center justify-center hover:bg-neutral-200 transition-colors">
                    <i class="fas fa-times text-neutral-600"></i>
                </button>
                
                <!-- å•†å“åœ–ç‰‡ -->
                <img id="modal-image" src="" alt="" class="w-full h-48 object-cover rounded-lg mb-4">
                
                <!-- å•†å“è³‡è¨Š -->
                <h2 id="modal-title" class="text-xl font-bold text-neutral-800 mb-2"></h2>
                <p id="modal-description" class="text-neutral-600 text-sm mb-4 leading-relaxed"></p>
                <p id="modal-price" class="text-2xl font-bold text-accent mb-6"></p>
                
                <!-- å®¢è£½åŒ–é¸é … -->
                <div id="customization-options" class="mb-6">
                    <!-- å‹•æ…‹è¼‰å…¥é¸é … -->
                </div>
                
                <!-- å‚™è¨»æ¬„ä½ -->
                <div class="mb-6">
                    <label class="text-sm font-medium text-neutral-700 mb-2 block">å‚™è¨»</label>
                    <textarea id="order-notes" class="w-full p-3 border border-neutral-200 rounded-lg text-sm resize-none focus:outline-none focus:border-primary transition-colors" rows="2" placeholder="è«‹è¼¸å…¥ç‰¹æ®Šéœ€æ±‚ï¼ˆå¦‚ï¼šå°‘é¹½ã€ä¸è¦è¾£ç­‰ï¼‰"></textarea>
                </div>
                
                <!-- æ•¸é‡é¸æ“‡èˆ‡åŠ å…¥è³¼ç‰©è»Š -->
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <button id="qty-minus" class="w-8 h-8 bg-neutral-100 rounded-full flex items-center justify-center hover:bg-neutral-200 transition-colors btn-press">
                            <i class="fas fa-minus text-sm"></i>
                        </button>
                        <span id="qty-value" class="font-medium text-lg min-w-[2rem] text-center">1</span>
                        <button id="qty-plus" class="w-8 h-8 bg-neutral-100 rounded-full flex items-center justify-center hover:bg-neutral-200 transition-colors btn-press">
                            <i class="fas fa-plus text-sm"></i>
                        </button>
                    </div>
                    <button id="add-to-cart" class="bg-primary text-white px-6 py-3 rounded-lg font-medium hover:bg-primary-dark transition-all duration-300 btn-press">
                        åŠ å…¥é¤é»
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Order Cart è³¼ç‰©è»Šå´é‚Šæ¬„ -->
    <aside id="order-cart" class="fixed top-0 right-0 h-full w-full max-w-[360px] bg-white shadow-2xl transform translate-x-full transition-transform duration-300 z-40">
        <div class="h-full flex flex-col">
            <!-- è³¼ç‰©è»Šæ¨™é¡Œ -->
            <div class="p-4 border-b border-neutral-200">
                <div class="flex items-center justify-between">
                    <h2 class="text-lg font-semibold">æˆ‘çš„é¤é»</h2>
                    <button id="close-cart" class="w-8 h-8 bg-neutral-100 rounded-full flex items-center justify-center hover:bg-neutral-200 transition-colors">
                        <i class="fas fa-times text-neutral-600"></i>
                    </button>
                </div>
            </div>
            
            <!-- è³¼ç‰©è»Šå…§å®¹ -->
            <div id="cart-items" class="flex-1 overflow-y-auto custom-scrollbar p-4">
                <!-- å‹•æ…‹è¼‰å…¥è³¼ç‰©è»Šé …ç›® -->
            </div>
            
            <!-- è³¼ç‰©è»Šç©ºç‹€æ…‹ -->
            <div id="cart-empty" class="flex-1 flex flex-col items-center justify-center p-4">
                <i class="fas fa-shopping-cart text-5xl text-neutral-300 mb-4"></i>
                <p class="text-neutral-500">å°šæœªé¸æ“‡é¤é»</p>
            </div>
            
            <!-- çµå¸³å€åŸŸ -->
            <div id="cart-footer" class="border-t border-neutral-200 p-4 hidden">
                <div class="flex items-center justify-between mb-4">
                    <span class="font-medium">ç¸½è¨ˆ</span>
                    <span id="cart-total" class="text-xl font-bold text-accent">NT$ 0</span>
                </div>
                <button id="checkout-btn" class="w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-primary-dark transition-all duration-300 btn-press">
                    é€å‡ºè¨‚å–®
                </button>
            </div>
        </div>
    </aside>
    
    <!-- Floating Cart Button æµ®å‹•è³¼ç‰©è»ŠæŒ‰éˆ• -->
    <button id="floating-cart" class="fixed bottom-6 right-6 w-14 h-14 bg-primary text-white rounded-full shadow-lg flex items-center justify-center hover:bg-primary-dark transition-all duration-300 btn-press hidden z-30">
        <i class="fas fa-shopping-cart"></i>
        <span id="cart-count" class="absolute -top-1 -right-1 w-5 h-5 bg-accent text-primary text-xs font-bold rounded-full flex items-center justify-center hidden">0</span>
    </button>
    
    <!-- Toast Notification æç¤ºè¨Šæ¯ -->
    <div id="toast-notification" class="fixed top-20 left-1/2 transform -translate-x-1/2 bg-white shadow-lg rounded-lg px-4 py-3 flex items-center space-x-3 min-w-[280px] z-50 hidden">
        <i id="toast-icon" class="fas fa-check-circle text-green-500"></i>
        <span id="toast-message" class="text-sm font-medium text-neutral-700"></span>
    </div>
    
    <!-- Easter Egg Button å½©è›‹è§¸ç™¼æŒ‰éˆ• -->
    <button class="easter-egg-btn" id="easter-egg-trigger">
        <i class="fas fa-egg text-neutral-300"></i>
    </button>
    
    <!-- Easter Egg Modal å½©è›‹å…§å®¹ -->
    <div id="easter-egg-modal" class="fixed inset-0 z-[100] hidden">
        <div class="modal-backdrop absolute inset-0 bg-black bg-opacity-75"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-2xl p-6 max-w-[360px] w-[90%] text-center">
            <h3 class="text-2xl font-bold text-primary mb-4">ğŸ‰ æ­å–œç™¼ç¾å½©è›‹ï¼</h3>
            <p class="text-neutral-600 mb-6">æ‚¨å·²è§£é–ç¶ èƒè»’çš„ç§˜å¯†å„ªæƒ ç¢¼</p>
            <div class="bg-neutral-100 rounded-lg p-4 mb-6">
                <p class="text-sm text-neutral-500 mb-1">å„ªæƒ ç¢¼</p>
                <p class="text-2xl font-bold text-accent">VERDANT2024</p>
            </div>
            <p class="text-sm text-neutral-500 mb-4">çµå¸³æ™‚è¼¸å…¥å¯äº« 9 æŠ˜å„ªæƒ </p>
            <button id="close-easter-egg" class="w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-primary-dark transition-all duration-300 btn-press">
                å¤ªæ£’äº†ï¼
            </button>
        </div>
    </div>
    
    <script>
        // ==========================================
        // å…¨åŸŸè®Šæ•¸èˆ‡åˆå§‹åŒ–
        // ==========================================
        
        // æ‡‰ç”¨ç¨‹å¼ç‹€æ…‹ç®¡ç†
        const app = {
            currentCategory: 'appetizer',
            currentLang: 'zh',
            cart: [],
            selectedProduct: null,
            currentQty: 1,
            easterEggClickCount: 0
        };
        
        // æ¨¡æ“¬å•†å“è³‡æ–™åº«
        const menuData = {
            appetizer: [
                {
                    id: 1,
                    name: 'æ¾éœ²é‡è‡æ¿ƒæ¹¯',
                    nameEn: 'Truffle Mushroom Soup',
                    price: 380,
                    description: 'é¸ç”¨æ–°é®®é‡è‡èˆ‡é ‚ç´šé»‘æ¾éœ²ï¼Œæ…¢ç«ç†¬ç…®çš„æ³•å¼æ¿ƒæ¹¯',
                    descriptionEn: 'French soup made with fresh wild mushrooms and premium black truffle',
                    image: 'https://images.unsplash.com/photo-1547592166-23ac45744acd?w=400',
                    options: {
                        temperature: ['ç†±æ¹¯', 'æº«æ¹¯']
                    }
                },
                {
                    id: 2,
                    name: 'ç…™ç‡»é®­é­šå¡”å¡”',
                    nameEn: 'Smoked Salmon Tartare',
                    price: 420,
                    description: 'æŒªå¨ç…™ç‡»é®­é­šæ­é…é…ªæ¢¨ã€é…¸è±†èˆ‡è’”è˜¿é†¬',
                    descriptionEn: 'Norwegian smoked salmon with avocado, capers and dill sauce',
                    image: 'https://images.unsplash.com/photo-1519708227418-c8fd9a32b7a2?w=400',
                    options: {
                        spice: ['åŸå‘³', 'é»‘èƒ¡æ¤’']
                    }
                }
            ],
            main: [
                {
                    id: 3,
                    name: 'ç‚­çƒ¤è‚‹çœ¼ç‰›æ’',
                    nameEn: 'Grilled Ribeye Steak',
                    price: 1280,
                    description: 'æ¾³æ´²å’Œç‰›è‚‹çœ¼ï¼Œç‚­ç«çƒ¤è£½ï¼Œæ­é…å­£ç¯€æ™‚è”¬',
                    descriptionEn: 'Australian Wagyu ribeye, charcoal grilled with seasonal vegetables',
                    image: 'https://images.unsplash.com/photo-1546833999-b9f581a1996d?w=400',
                    options: {
                        doneness: ['ä¸‰åˆ†ç†Ÿ', 'äº”åˆ†ç†Ÿ', 'ä¸ƒåˆ†ç†Ÿ', 'å…¨ç†Ÿ'],
                        sauce: ['é»‘èƒ¡æ¤’é†¬', 'ç´…é…’é†¬', 'è˜‘è‡é†¬']
                    }
                },
                {
                    id: 4,
                    name: 'é¾è¦ç‡‰é£¯',
                    nameEn: 'Lobster Risotto',
                    price: 980,
                    description: 'æ³¢å£«é “é¾è¦æ­é…ç¾©å¤§åˆ©ç±³ï¼Œç•ªç´…èŠ±å¥¶æ²¹é†¬æ±',
                    descriptionEn: 'Boston lobster with Italian rice in saffron cream sauce',
                    image: 'https://images.unsplash.com/photo-1633504581786-316c8002b1b9?w=400',
                    options: {
                        portion: ['æ¨™æº–ä»½', 'å¤§ä»½']
                    }
                }
            ],
            dessert: [
                {
                    id: 5,
                    name: 'å·§å…‹åŠ›ç†”å²©è›‹ç³•',
                    nameEn: 'Chocolate Lava Cake',
                    price: 280,
                    description: 'æº«ç†±å·§å…‹åŠ›è›‹ç³•ï¼Œæ­é…é¦™è‰å†°æ·‡æ·‹',
                    descriptionEn: 'Warm chocolate cake with vanilla ice cream',
                    image: 'https://images.unsplash.com/photo-1624353365286-3f8d62daad51?w=400',
                    options: {
                        iceCream: ['é¦™è‰', 'å·§å…‹åŠ›', 'æŠ¹èŒ¶']
                    }
                }
            ],
            beverage: [
                {
                    id: 6,
                    name: 'æ‰‹æ²–ç²¾å“å’–å•¡',
                    nameEn: 'Pour Over Coffee',
                    price: 180,
                    description: 'ç²¾é¸å–®å“å’–å•¡è±†ï¼Œå°ˆæ¥­æ‰‹æ²–è£½ä½œ',
                    descriptionEn: 'Selected single origin coffee, professionally hand-brewed',
                    image: 'https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400',
                    options: {
                        bean: ['è¡£ç´¢æ¯”äº', 'å“¥å€«æ¯”äº', 'è‚¯äº'],
                        temperature: ['ç†±', 'å†°']
                    }
                }
            ]
        };
        
        // ==========================================
        // DOM å…ƒç´ å¿«å–
        // ==========================================
        const elements = {
            welcomeScreen: document.getElementById('welcome-screen'),
            categoryTabs: document.getElementById('category-tabs'),
            menuList: document.getElementById('menu-list'),
            menuContainer: document.getElementById('menu-container'),
            productModal: document.getElementById('product-detail-modal'),
            orderCart: document.getElementById('order-cart'),
            floatingCart: document.getElementById('floating-cart'),
            cartCount: document.getElementById('cart-count'),
            toast: document.getElementById('toast-notification'),
            easterEggModal: document.getElementById('easter-egg-modal')
        };
        
        // ==========================================
        // å·¥å…·å‡½æ•¸
        // ==========================================
        
        // é¡¯ç¤º Toast æç¤ºè¨Šæ¯
        function showToast(message, type = 'success') {
            const toast = elements.toast;
            const icon = document.getElementById('toast-icon');
            const msg = document.getElementById('toast-message');
            
            // è¨­å®šåœ–ç¤ºèˆ‡è¨Šæ¯
            if (type === 'success') {
                icon.className = 'fas fa-check-circle text-green-500';
            } else if (type === 'error') {
                icon.className = 'fas fa-exclamation-circle text-red-500';
            }
            
            msg.textContent = message;
            
            // é¡¯ç¤º Toast
            toast.classList.remove('hidden');
            toast.classList.add('animate__animated', 'animate__fadeInDown');
            
            // 3ç§’å¾Œè‡ªå‹•éšè—
            setTimeout(() => {
                toast.classList.add('animate__fadeOutUp');
                setTimeout(() => {
                    toast.classList.add('hidden');
                    toast.classList.remove('animate__animated', 'animate__fadeInDown', 'animate__fadeOutUp');
                }, 500);
            }, 3000);
        }
        
        // æ ¼å¼åŒ–åƒ¹æ ¼
        function formatPrice(price) {
            return `NT$ ${price.toLocaleString()}`;
        }
        
        // æ›´æ–°è³¼ç‰©è»Šæ•¸é‡é¡¯ç¤º
        function updateCartCount() {
            const count = app.cart.reduce((sum, item) => sum + item.quantity, 0);
            const cartCount = elements.cartCount;
            
            if (count > 0) {
                cartCount.textContent = count;
                cartCount.classList.remove('hidden');
                elements.floatingCart.classList.add('animate__animated', 'animate__pulse');
                setTimeout(() => {
                    elements.floatingCart.classList.remove('animate__animated', 'animate__pulse');
                }, 1000);
            } else {
                cartCount.classList.add('hidden');
            }
        }
        
        // ==========================================
        // é é¢åˆ‡æ›èˆ‡å°èˆª
        // ==========================================
        
        // é–‹å§‹é»é¤
        document.getElementById('start-ordering').addEventListener('click', () => {
            elements.welcomeScreen.classList.add('animate__animated', 'animate__fadeOut');
            
            setTimeout(() => {
                elements.welcomeScreen.classList.add('hidden');
                elements.categoryTabs.classList.remove('hidden');
                elements.menuList.classList.remove('hidden');
                elements.floatingCart.classList.remove('hidden');
                
                renderMenuItems('appetizer');
            }, 500);
        });
        
        // èªè¨€åˆ‡æ›
        document.getElementById('lang-toggle').addEventListener('click', () => {
            app.currentLang = app.currentLang === 'zh' ? 'en' : 'zh';
            document.getElementById('lang-text').textContent = app.currentLang === 'zh' ? 'ç¹é«”' : 'EN';
            
            // é‡æ–°æ¸²æŸ“ç•¶å‰åˆ†é¡
            renderMenuItems(app.currentCategory);
        });
        
        // åˆ†é¡åˆ‡æ›
        document.querySelectorAll('.category-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // æ›´æ–° active ç‹€æ…‹
                document.querySelector('.category-tab.active').classList.remove('active', 'border-accent', 'text-primary');
                document.querySelector('.category-tab.active').classList.add('border-transparent', 'text-neutral-600');
                
                this.classList.add('active', 'border-accent', 'text-primary');
                this.classList.remove('border-transparent', 'text-neutral-600');
                
                // æ¸²æŸ“å°æ‡‰åˆ†é¡å•†å“
                const category = this.getAttribute('data-category');
                app.currentCategory = category;
                renderMenuItems(category);
            });
        });
        
        // ==========================================
        // å•†å“å±•ç¤ºåŠŸèƒ½
        // ==========================================
        
        // æ¸²æŸ“å•†å“åˆ—è¡¨
        function renderMenuItems(category) {
            const container = elements.menuContainer;
            const items = menuData[category] || [];
            
            // æ¸…ç©ºå®¹å™¨
            container.innerHTML = '';
            
            if (items.length === 0) {
                document.getElementById('empty-state').classList.remove('hidden');
                return;
            }
            
            document.getElementById('empty-state').classList.add('hidden');
            
            // æ¸²æŸ“å•†å“å¡ç‰‡
            items.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-xl overflow-hidden card-shadow animate__animated animate__fadeInUp';
                card.style.animationDelay = `${index * 0.1}s`;
                
                card.innerHTML = `
                    <div class="relative">
                        <img src="${item.image}" alt="${item.name}" class="w-full h-48 object-cover img-loading" onload="this.classList.remove('img-loading')">
                        <div class="absolute top-3 right-3 bg-accent text-primary text-xs font-semibold px-2 py-1 rounded">
                            äººæ°£
                        </div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-lg text-neutral-800 mb-1">
                            ${app.currentLang === 'zh' ? item.name : item.nameEn}
                        </h3>
                        <p class="text-neutral-600 text-sm mb-3 line-clamp-2">
                            ${app.currentLang === 'zh' ? item.description : item.descriptionEn}
                        </p>
                        <div class="flex items-center justify-between">
                            <span class="text-accent font-bold text-lg">${formatPrice(item.price)}</span>
                            <button class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary-dark transition-all duration-300 btn-press" onclick="showProductDetail(${item.id})">
                                é¸æ“‡
                            </button>
                        </div>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        // ==========================================
        // å•†å“è©³æƒ…åŠŸèƒ½
        // ==========================================
        
        // é¡¯ç¤ºå•†å“è©³æƒ…
        function showProductDetail(productId) {
            // æ‰¾åˆ°å•†å“è³‡æ–™
            let product = null;
            for (const category in menuData) {
                product = menuData[category].find(item => item.id === productId);
                if (product) break;
            }
            
            if (!product) return;
            
            app.selectedProduct = product;
            app.currentQty = 1;
            
            // å¡«å……è©³æƒ…è³‡æ–™
            document.getElementById('modal-image').src = product.image;
            document.getElementById('modal-title').textContent = app.currentLang === 'zh' ? product.name : product.nameEn;
            document.getElementById('modal-description').textContent = app.currentLang === 'zh' ? product.description : product.descriptionEn;
            document.getElementById('modal-price').textContent = formatPrice(product.price);
            document.getElementById('qty-value').textContent = '1';
            
            // æ¸²æŸ“å®¢è£½åŒ–é¸é …
            const optionsContainer = document.getElementById('customization-options');
            optionsContainer.innerHTML = '';
            
            if (product.options) {
                Object.entries(product.options).forEach(([key, values]) => {
                    const optionGroup = document.createElement('div');
                    optionGroup.className = 'mb-4';
                    
                    const label = {
                        temperature: 'æº«åº¦',
                        spice: 'èª¿å‘³',
                        doneness: 'ç†Ÿåº¦',
                        sauce: 'é†¬æ±',
                        portion: 'ä»½é‡',
                        iceCream: 'å†°æ·‡æ·‹',
                        bean: 'å’–å•¡è±†'
                    };
                    
                    optionGroup.innerHTML = `
                        <label class="text-sm font-medium text-neutral-700 mb-2 block">${label[key] || key}</label>
                        <div class="flex flex-wrap gap-2">
                            ${values.map((value, index) => `
                                <label class="option-label">
                                    <input type="radio" name="${key}" value="${value}" ${index === 0 ? 'checked' : ''} class="hidden">
                                    <span class="inline-block px-4 py-2 border border-neutral-200 rounded-lg text-sm cursor-pointer hover:border-primary transition-colors">
                                        ${value}
                                    </span>
                                </label>
                            `).join('')}
                        </div>
                    `;
                    
                    optionsContainer.appendChild(optionGroup);
                });
                
                // ç‚ºé¸é …æ·»åŠ äº’å‹•æ•ˆæœ
                document.querySelectorAll('.option-label input').forEach(input => {
                    input.addEventListener('change', function() {
                        const parent = this.closest('.option-label').parentElement;
                        parent.querySelectorAll('span').forEach(span => {
                            span.classList.remove('bg-primary', 'text-white', 'border-primary');
                        });
                        
                        if (this.checked) {
                            this.nextElementSibling.classList.add('bg-primary', 'text-white', 'border-primary');
                        }
                    });
                });
                
                // åˆå§‹åŒ–é¸ä¸­ç‹€æ…‹
                document.querySelectorAll('.option-label input:checked').forEach(input => {
                    input.nextElementSibling.classList.add('bg-primary', 'text-white', 'border-primary');
                });
            }
            
            // é¡¯ç¤º Modal
            elements.productModal.classList.remove('hidden');
        }
        
        // é—œé–‰å•†å“è©³æƒ…
        document.getElementById('close-modal').addEventListener('click', () => {
            const modal = elements.productModal;
            modal.querySelector('.absolute.bottom-0').classList.add('animate__animated', 'animate__slideOutDown');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                modal.querySelector('.absolute.bottom-0').classList.remove('animate__animated', 'animate__slideOutDown');
                
                // æ¸…ç©ºå‚™è¨»
                document.getElementById('order-notes').value = '';
            }, 300);
        });
        
        // æ•¸é‡æ§åˆ¶
        document.getElementById('qty-minus').addEventListener('click', () => {
            if (app.currentQty > 1) {
                app.currentQty--;
                document.getElementById('qty-value').textContent = app.currentQty;
            }
        });
        
        document.getElementById('qty-plus').addEventListener('click', () => {
            if (app.currentQty < 10) {
                app.currentQty++;
                document.getElementById('qty-value').textContent = app.currentQty;
            }
        });
        
        // åŠ å…¥è³¼ç‰©è»Š
        document.getElementById('add-to-cart').addEventListener('click', () => {
            if (!app.selectedProduct) return;
            
            // æ”¶é›†é¸é …
            const options = {};
            document.querySelectorAll('.option-label input:checked').forEach(input => {
                options[input.name] = input.value;
            });
            
            // å»ºç«‹è³¼ç‰©è»Šé …ç›®
            const cartItem = {
                id: Date.now(), // ä½¿ç”¨æ™‚é–“æˆ³ä½œç‚ºå”¯ä¸€ ID
                productId: app.selectedProduct.id,
                name: app.currentLang === 'zh' ? app.selectedProduct.name : app.selectedProduct.nameEn,
                price: app.selectedProduct.price,
                quantity: app.currentQty,
                options: options,
                notes: document.getElementById('order-notes').value
            };
            
            // åŠ å…¥è³¼ç‰©è»Š
            app.cart.push(cartItem);
            updateCartCount();
            renderCartItems();
            
            // é—œé–‰ Modal
            document.getElementById('close-modal').click();
            
            // é¡¯ç¤ºæˆåŠŸæç¤º
            showToast(`å·²åŠ å…¥ ${cartItem.name} Ã— ${cartItem.quantity}`);
        });
        
        // ==========================================
        // è³¼ç‰©è»ŠåŠŸèƒ½
        // ==========================================
        
        // é¡¯ç¤ºè³¼ç‰©è»Š
        document.getElementById('floating-cart').addEventListener('click', () => {
            elements.orderCart.classList.remove('translate-x-full');
            renderCartItems();
        });
        
        // é—œé–‰è³¼ç‰©è»Š
        document.getElementById('close-cart').addEventListener('click', () => {
            elements.orderCart.classList.add('translate-x-full');
        });
        
        // æ¸²æŸ“è³¼ç‰©è»Šå…§å®¹
        function renderCartItems() {
            const container = document.getElementById('cart-items');
            const emptyState = document.getElementById('cart-empty');
            const footer = document.getElementById('cart-footer');
            
            if (app.cart.length === 0) {
                container.classList.add('hidden');
                emptyState.classList.remove('hidden');
                footer.classList.add('hidden');
                return;
            }
            
            container.classList.remove('hidden');
            emptyState.classList.add('hidden');
            footer.classList.remove('hidden');
            
            // æ¸²æŸ“è³¼ç‰©è»Šé …ç›®
            container.innerHTML = app.cart.map(item => `
                <div class="bg-neutral-50 rounded-lg p-3 mb-3 animate__animated animate__fadeIn">
                    <div class="flex items-start justify-between mb-2">
                        <h4 class="font-medium text-neutral-800">${item.name}</h4>
                        <button class="text-neutral-400 hover:text-red-500 transition-colors" onclick="removeFromCart(${item.id})">
                            <i class="fas fa-trash-alt text-sm"></i>
                        </button>
                    </div>
                    ${Object.entries(item.options).map(([key, value]) => `
                        <p class="text-xs text-neutral-600 mb-1">${value}</p>
                    `).join('')}
                    ${item.notes ? `<p class="text-xs text-neutral-500 italic mb-2">å‚™è¨»: ${item.notes}</p>` : ''}
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <button class="w-6 h-6 bg-white rounded flex items-center justify-center hover:bg-neutral-200 transition-colors btn-press" onclick="updateCartItemQty(${item.id}, -1)">
                                <i class="fas fa-minus text-xs"></i>
                            </button>
                            <span class="text-sm font-medium min-w-[1.5rem] text-center">${item.quantity}</span>
                            <button class="w-6 h-6 bg-white rounded flex items-center justify-center hover:bg-neutral-200 transition-colors btn-press" onclick="updateCartItemQty(${item.id}, 1)">
                                <i class="fas fa-plus text-xs"></i>
                            </button>
                        </div>
                        <span class="text-accent font-medium">${formatPrice(item.price * item.quantity)}</span>
                    </div>
                </div>
            `).join('');
            
            // æ›´æ–°ç¸½é‡‘é¡
            const total = app.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('cart-total').textContent = formatPrice(total);
        }
        
        // å¾è³¼ç‰©è»Šç§»é™¤
        function removeFromCart(itemId) {
            app.cart = app.cart.filter(item => item.id !== itemId);
            updateCartCount();
            renderCartItems();
            showToast('å·²å¾è³¼ç‰©è»Šç§»é™¤');
        }
        
        // æ›´æ–°è³¼ç‰©è»Šå•†å“æ•¸é‡
        function updateCartItemQty(itemId, delta) {
            const item = app.cart.find(item => item.id === itemId);
            if (!item) return;
            
            const newQty = item.quantity + delta;
            if (newQty > 0 && newQty <= 10) {
                item.quantity = newQty;
                updateCartCount();
                renderCartItems();
            }
        }
        
        // çµå¸³
        document.getElementById('checkout-btn').addEventListener('click', () => {
            if (app.cart.length === 0) return;
            
            // é—œé–‰è³¼ç‰©è»Š
            elements.orderCart.classList.add('translate-x-full');
            
            // é¡¯ç¤ºæˆåŠŸæç¤º
            showToast('è¨‚å–®å·²é€å‡ºï¼å»šæˆ¿æ­£åœ¨æº–å‚™æ‚¨çš„é¤é»', 'success');
            
            // æ¸…ç©ºè³¼ç‰©è»Š
            app.cart = [];
            updateCartCount();
            
            // æ¨¡æ“¬ä»˜æ¬¾é¸æ“‡ï¼ˆå¯æ“´å±•ï¼‰
            setTimeout(() => {
                if (confirm('æ˜¯å¦ä½¿ç”¨ Line Pay ä»˜æ¬¾ï¼Ÿ')) {
                    showToast('å·²å°å‘ Line Pay ä»˜æ¬¾é é¢', 'success');
                } else {
                    showToast('è«‹è‡³æ«ƒæª¯ä»˜æ¬¾', 'success');
                }
            }, 2000);
        });
        
        // ==========================================
        // å½©è›‹åŠŸèƒ½
        // ==========================================
        
        // å½©è›‹è§¸ç™¼é‚è¼¯ï¼šé€£é»ä¸‰æ¬¡
        document.getElementById('easter-egg-trigger').addEventListener('click', () => {
            app.easterEggClickCount++;
            
            if (app.easterEggClickCount === 3) {
                // é¡¯ç¤ºå½©è›‹
                elements.easterEggModal.classList.remove('hidden');
                elements.easterEggModal.classList.add('animate__animated', 'animate__zoomIn');
                
                // é‡ç½®è¨ˆæ•¸
                app.easterEggClickCount = 0;
                
                // è¨˜éŒ„å½©è›‹è§¸ç™¼
                console.log('ğŸ‰ Easter egg triggered!');
            }
            
            // 5ç§’å¾Œé‡ç½®è¨ˆæ•¸
            setTimeout(() => {
                app.easterEggClickCount = 0;
            }, 5000);
        });
        
        // é—œé–‰å½©è›‹
        document.getElementById('close-easter-egg').addEventListener('click', () => {
            const modal = elements.easterEggModal;
            modal.classList.add('animate__animated', 'animate__zoomOut');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                modal.classList.remove('animate__animated', 'animate__zoomIn', 'animate__zoomOut');
            }, 500);
        });
        
        // éµç›¤å½©è›‹ï¼šè¼¸å…¥ "verdant" è§¸ç™¼
        let keySequence = '';
        document.addEventListener('keydown', (e) => {
            keySequence += e.key.toLowerCase();
            
            if (keySequence.includes('verdant')) {
                // è§¸ç™¼å½©è›‹
                elements.easterEggModal.classList.remove('hidden');
                elements.easterEggModal.classList.add('animate__animated', 'animate__zoomIn');
                
                // é‡ç½®åºåˆ—
                keySequence = '';
            }
            
            // ä¿æŒåºåˆ—é•·åº¦é™åˆ¶
            if (keySequence.length > 20) {
                keySequence = keySequence.slice(-20);
            }
        });
        
        // ==========================================
        // æ•ˆèƒ½å„ªåŒ–ï¼šåœ–ç‰‡æ‡¶è¼‰å…¥
        // ==========================================
        
        // Intersection Observer for lazy loading
        const imageObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    img.src = img.dataset.src;
                    img.onload = () => {
                        img.classList.remove('img-loading');
                    };
                    imageObserver.unobserve(img);
                }
            });
        });
        
        // ç›£è½æ‰€æœ‰éœ€è¦æ‡¶è¼‰å…¥çš„åœ–ç‰‡
        document.querySelectorAll('img[data-src]').forEach(img => {
            imageObserver.observe(img);
        });
        
        // ==========================================
        // æ‰‹æ©Ÿè¿”å›éµè™•ç†
        // ==========================================
        
        window.addEventListener('popstate', (e) => {
            // å¦‚æœè³¼ç‰©è»Šé–‹å•Ÿï¼Œå…ˆé—œé–‰è³¼ç‰©è»Š
            if (!elements.orderCart.classList.contains('translate-x-full')) {
                elements.orderCart.classList.add('translate-x-full');
                e.preventDefault();
            }
            // å¦‚æœå•†å“è©³æƒ…é–‹å•Ÿï¼Œé—œé–‰è©³æƒ…
            else if (!elements.productModal.classList.contains('hidden')) {
                document.getElementById('close-modal').click();
                e.preventDefault();
            }
        });
    </script>
</body>
</html>