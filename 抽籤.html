<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>è¶…ç´šç²¾ç¾è¼ªç›¤æŠ½ç±¤æ©Ÿ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Microsoft JhengHei", Arial, sans-serif;
      }

      body {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        overflow-x: hidden;
        background: linear-gradient(135deg, #f9f7fe 0%, #e2d1f9 100%);
        color: #4a4a4a;
      }

      .container {
        position: relative;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 2rem;
        max-width: 1000px;
        width: 100%;
      }

      .title {
        font-size: 2.5rem;
        color: #6a3093;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        margin-bottom: 1.5rem;
        text-align: center;
        position: relative;
      }

      .title span {
        display: inline-block;
      }

      .setup-container {
        display: flex;
        flex-direction: column;
        width: 100%;
        max-width: 800px;
        background: white;
        border-radius: 20px;
        padding: 2rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        margin-bottom: 2rem;
        transition: all 0.5s ease;
      }

      .input-group {
        margin-bottom: 1.5rem;
      }

      label {
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
        display: block;
        color: #6a3093;
        font-weight: bold;
      }

      textarea,
      input {
        width: 100%;
        padding: 0.8rem;
        border: 2px solid #e2d1f9;
        border-radius: 10px;
        font-size: 1rem;
        transition: all 0.3s;
      }

      textarea:focus,
      input:focus {
        outline: none;
        border-color: #6a3093;
        box-shadow: 0 0 10px rgba(106, 48, 147, 0.2);
      }

      textarea {
        min-height: 100px;
        resize: vertical;
      }

      .button-group {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
      }

      .btn {
        padding: 0.8rem 1.5rem;
        border: none;
        border-radius: 50px;
        font-size: 1rem;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .btn-primary {
        background: linear-gradient(135deg, #6a3093 0%, #a044ff 100%);
        color: white;
      }

      .btn-secondary {
        background: white;
        color: #6a3093;
        border: 2px solid #6a3093;
      }

      .btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
      }

      .btn:active {
        transform: translateY(0);
      }

      .btn:disabled {
        opacity: 0.7;
        cursor: not-allowed;
        transform: none;
      }

      .game-container {
        display: none;
        flex-direction: column;
        align-items: center;
        width: 100%;
        max-width: 800px;
      }

      .wheel-container {
        position: relative;
        width: 400px;
        height: 400px;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 2rem 0;
      }

      .wheel {
        position: relative;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        overflow: hidden;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.2),
          0 0 60px rgba(106, 48, 147, 0.2);
        transition: box-shadow 0.3s;
        transform-origin: center;
      }

      .wheel-section {
        position: absolute;
        top: 0;
        right: 0;
        width: 50%;
        height: 50%;
        transform-origin: 0% 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }

      .wheel-section span {
        position: absolute;
        left: 100%;
        transform: rotate(90deg) translateX(-35px) translateY(-50px);
        transform-origin: 0% 0%;
        font-weight: bold;
        color: white;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        width: 120px;
        text-align: center;
        pointer-events: none;
        font-size: 0.9rem;
      }

      .wheel-center {
        position: absolute;
        width: 70px;
        height: 70px;
        border-radius: 50%;
        background: white;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10;
        overflow: hidden;
      }

      .wheel-center::before {
        content: "";
        position: absolute;
        width: 15px;
        height: 15px;
        border-radius: 50%;
        background: linear-gradient(135deg, #6a3093 0%, #a044ff 100%);
      }

      .wheel-center::after {
        content: "";
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        border: 4px solid transparent;
        border-top-color: #6a3093;
        animation: rotate 2s linear infinite;
        opacity: 0;
      }

      @keyframes rotate {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* è£é£¾å…ƒç´  */
      .wheel-decoration {
        position: absolute;
        width: 30px;
        height: 30px;
        background: linear-gradient(135deg, #6a3093 0%, #a044ff 100%);
        z-index: 1;
        opacity: 0.7;
        border-radius: 50%;
        box-shadow: 0 0 15px rgba(106, 48, 147, 0.5);
      }

      .wheel-decoration.top-left {
        top: -15px;
        left: -15px;
      }

      .wheel-decoration.top-right {
        top: -15px;
        right: -15px;
      }

      .wheel-decoration.bottom-left {
        bottom: -15px;
        left: -15px;
      }

      .wheel-decoration.bottom-right {
        bottom: -15px;
        right: -15px;
      }

      .wheel-pointer {
        position: absolute;
        top: -30px;
        left: 50%;
        transform: translateX(-50%);
        width: 30px;
        height: 50px;
        background: linear-gradient(135deg, #fc466b 0%, #ff8086 100%);
        clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
        z-index: 10;
        box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.2);
      }

      .wheel-pointer::before {
        content: "";
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 10px;
        height: 10px;
        background: white;
        border-radius: 50%;
      }

      .controls {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
        width: 100%;
      }

      .result-container {
        min-height: 100px;
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: white;
        border-radius: 20px;
        padding: 1.5rem;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        margin-top: 2rem;
        transition: all 0.5s ease;
        opacity: 0;
        transform: translateY(20px);
      }

      .result-title {
        font-size: 1.5rem;
        color: #6a3093;
        margin-bottom: 1rem;
        font-weight: bold;
      }

      .winner {
        font-size: 2rem;
        font-weight: bold;
        color: #6a3093;
        margin-bottom: 0.5rem;
        text-align: center;
      }

      .prize {
        font-size: 1.5rem;
        color: #6a3093;
        text-align: center;
      }

      .participants-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        justify-content: center;
        margin-top: 1rem;
        max-width: 600px;
      }

      .participant-item {
        background: white;
        padding: 0.5rem 1rem;
        border-radius: 50px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        font-size: 0.9rem;
        color: #6a3093;
        transition: all 0.3s;
      }

      .participant-item.winner {
        background: linear-gradient(135deg, #6a3093 0%, #a044ff 100%);
        color: white;
        transform: scale(1.1);
      }

      .confetti {
        position: absolute;
        width: 10px;
        height: 10px;
        background-color: #f00;
        opacity: 0;
        z-index: 999;
      }

      .firework {
        position: absolute;
        width: 10px;
        height: 10px;
        transform: translate(-50%, -50%);
        z-index: 999;
      }

      .loading-animation {
        position: absolute;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 100;
        opacity: 0;
        pointer-events: none;
      }

      .loading-dot {
        width: 20px;
        height: 20px;
        margin: 0 5px;
        border-radius: 50%;
        background: #6a3093;
        opacity: 0;
      }

      /* æµ®å‹•åœ–æ¡ˆ */
      .floating-item {
        position: absolute;
        opacity: 0;
        border-radius: 50%;
        z-index: -1;
      }

      /* è§¸ç™¼æ•ˆæœ */
      .glitter {
        position: absolute;
        width: 5px;
        height: 5px;
        background: white;
        border-radius: 50%;
        pointer-events: none;
        z-index: 999;
      }

      .back-to-setup {
        margin-top: 1rem;
      }

      /* è¢å¹•é©é… */
      @media (max-width: 768px) {
        .container {
          padding: 1rem;
        }

        .title {
          font-size: 1.8rem;
        }

        .setup-container,
        .game-container {
          padding: 1rem;
        }

        .wheel-container {
          width: 300px;
          height: 300px;
        }

        .wheel-section span {
          transform: rotate(90deg) translateX(-20px) translateY(-40px);
          font-size: 0.7rem;
        }

        .button-group {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1 class="title">âœ¨ è¶…ç´šç²¾ç¾è¼ªç›¤æŠ½ç±¤æ©Ÿ âœ¨</h1>

      <!-- è¨­ç½®é¢æ¿ -->
      <div class="setup-container" id="setupContainer">
        <div class="input-group">
          <label for="participants">åƒèˆ‡è€…åå–® (æ¯è¡Œä¸€å€‹åå­—)</label>
          <textarea
            id="participants"
            placeholder="å°æ˜&#10;å°è¯&#10;å°å¼·"
          ></textarea>
        </div>

        <div class="input-group">
          <label for="prizes">çå“æ¸…å–® (æ¯è¡Œä¸€å€‹çå“)</label>
          <textarea
            id="prizes"
            placeholder="iPhone 15&#10;AirPods Pro&#10;æ˜Ÿå·´å…‹ç¦®åˆ¸"
          ></textarea>
        </div>

        <div class="button-group">
          <button id="startGame" class="btn btn-primary">é–‹å§‹æŠ½ç</button>
          <button id="randomData" class="btn btn-secondary">
            ç”¢ç”Ÿéš¨æ©Ÿè³‡æ–™
          </button>
        </div>
      </div>

      <!-- éŠæˆ²é¢æ¿ -->
      <div class="game-container" id="gameContainer">
        <div class="participants-list" id="participantsList"></div>

        <div class="wheel-container">
          <div class="wheel-pointer"></div>
          <div class="wheel" id="wheel"></div>
          <div class="wheel-center"></div>
          <div class="loading-animation" id="loadingAnimation">
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
          </div>
          <!-- å¢åŠ è£é£¾å…ƒç´  -->
          <div class="wheel-decoration top-left"></div>
          <div class="wheel-decoration top-right"></div>
          <div class="wheel-decoration bottom-left"></div>
          <div class="wheel-decoration bottom-right"></div>
        </div>

        <div class="controls">
          <button id="spinWheel" class="btn btn-primary">é–‹å§‹æŠ½ç</button>
          <button id="backToSetup" class="btn btn-secondary back-to-setup">
            è¿”å›è¨­å®š
          </button>
        </div>

        <div class="result-container" id="resultContainer">
          <div class="result-title">ğŸ‰ æŠ½ççµæœ ğŸ‰</div>
          <div class="winner" id="winnerName"></div>
          <div class="prize" id="winnerPrize"></div>
        </div>
      </div>
    </div>

    <script>
      // DOM å…ƒç´ æœƒåœ¨ DOMContentLoaded å¾Œåˆå§‹åŒ–
      let setupContainer,
        gameContainer,
        participantsInput,
        prizesInput,
        startGameBtn,
        randomDataBtn,
        spinWheelBtn,
        backToSetupBtn,
        wheel,
        participantsList,
        resultContainer,
        winnerNameEl,
        winnerPrizeEl,
        loadingAnimation;

      // ç­‰å¾… DOM åŠ è¼‰å®Œæˆå¾Œå†åˆå§‹åŒ–å…ƒç´ å¼•ç”¨
      document.addEventListener("DOMContentLoaded", () => {
        setupContainer = document.getElementById("setupContainer");
        gameContainer = document.getElementById("gameContainer");
        participantsInput = document.getElementById("participants");
        prizesInput = document.getElementById("prizes");
        startGameBtn = document.getElementById("startGame");
        randomDataBtn = document.getElementById("randomData");
        spinWheelBtn = document.getElementById("spinWheel");
        backToSetupBtn = document.getElementById("backToSetup");
        wheel = document.getElementById("wheel");
        participantsList = document.getElementById("participantsList");
        resultContainer = document.getElementById("resultContainer");
        winnerNameEl = document.getElementById("winnerName");
        winnerPrizeEl = document.getElementById("winnerPrize");
        loadingAnimation = document.getElementById("loadingAnimation");

        // åˆå§‹åŒ–äº‹ä»¶ç›£è½å™¨
        initEventListeners();
      });

      // å…¨å±€è®Šæ•¸
      let participants = [];
      let prizes = [];
      let colors = [
        "#FF6B6B",
        "#4ECDC4",
        "#FF9A76",
        "#F7DB4F",
        "#45B7D1",
        "#9B5DE5",
        "#F2994A",
        "#67C587",
        "#E868A2",
        "#8A7CEA",
        "#6EDCD9",
        "#FFC478",
        "#FF7C93",
        "#6BA3FF",
        "#9EE09E",
        "#F9C846",
      ];
      let isSpinning = false;
      let wheelSections = [];
      let currentWinner = null;
      let currentPrize = null;

      // å¢åŠ æ–°çš„ç‰¹æ•ˆé¸é …
      const animationEffects = {
        colors: colors,
        durations: {
          slow: 8000,
          normal: 5000,
          fast: 3000,
        },
        easings: {
          elastic: "easeOutElastic(1, .5)",
          bounce: "easeOutBounce",
          smooth: "easeOutQuint",
          sharp: "easeOutExpo",
        },
        intensities: {
          low: 0.5,
          medium: 1,
          high: 1.5,
        },
      };

      // é é¢åŠ è¼‰æ™‚çš„å‹•ç•«æ•ˆæœ
      document.addEventListener("DOMContentLoaded", () => {
        try {
          // æ¨™é¡Œå‹•ç•«
          const titleEl = document.querySelector(".title");
          if (titleEl) {
            const titleChars = titleEl.textContent.split("");
            titleEl.textContent = "";

            titleChars.forEach((char, i) => {
              const span = document.createElement("span");
              span.textContent = char === " " ? "\u00A0" : char;
              span.style.opacity = "0";
              span.style.transform = "translateY(20px)";
              titleEl.appendChild(span);
            });

            anime({
              targets: ".title span",
              opacity: 1,
              translateY: 0,
              delay: anime.stagger(50),
              easing: "easeOutQuad",
              duration: 800,
            });
          }

          // å‰µå»ºæµ®å‹•è£é£¾
          createFloatingElements();

          // è£é£¾å…ƒç´ å‹•ç•«
          animateDecorations();

          // è¨­ç½®è¡¨å–®å‹•ç•«
          anime({
            targets: ".setup-container",
            opacity: [0, 1],
            translateY: [50, 0],
            easing: "easeOutQuad",
            duration: 1000,
            delay: 500,
          });
        } catch (error) {
          console.error("åˆå§‹åŒ–å‹•ç•«éŒ¯èª¤:", error);
        }
      });

      // è£é£¾å…ƒç´ å‹•ç•«
      function animateDecorations() {
        try {
          // è¼ªç›¤å››è§’è£é£¾å‹•ç•«
          anime({
            targets: ".wheel-decoration",
            scale: [0, 1],
            opacity: [0, 0.7],
            duration: 1000,
            delay: anime.stagger(200),
            easing: "easeOutElastic(1, .5)",
            complete: function () {
              // æŒçºŒçš„å‘¼å¸æ•ˆæœ
              anime({
                targets: ".wheel-decoration",
                scale: [1, 1.2, 1],
                opacity: [0.7, 1, 0.7],
                duration: 3000,
                easing: "easeInOutQuad",
                loop: true,
              });
            },
          });
        } catch (error) {
          console.error("è£é£¾å…ƒç´ å‹•ç•«éŒ¯èª¤:", error);
        }
      }

      // å‰µå»ºæµ®å‹•è£é£¾å…ƒç´ 
      function createFloatingElements() {
        try {
          const container = document.querySelector(".container");
          if (!container) {
            console.error("æ‰¾ä¸åˆ°å®¹å™¨å…ƒç´ ");
            return;
          }

          const decorCount = 15;

          for (let i = 0; i < decorCount; i++) {
            const decor = document.createElement("div");
            decor.className = "floating-item";

            // éš¨æ©Ÿå¤§å°
            const size = anime.random(10, 40);
            decor.style.width = `${size}px`;
            decor.style.height = `${size}px`;

            // éš¨æ©Ÿé¡è‰²
            decor.style.background =
              colors[Math.floor(Math.random() * colors.length)];

            // éš¨æ©Ÿåˆå§‹ä½ç½®
            decor.style.left = `${anime.random(0, 100)}%`;
            decor.style.top = `${anime.random(-20, 100)}%`;

            // éš¨æ©Ÿå½¢ç‹€
            if (Math.random() > 0.5) {
              const borderRadius = [
                `${anime.random(10, 50)}%`,
                `${anime.random(10, 50)}%`,
                `${anime.random(10, 50)}%`,
                `${anime.random(10, 50)}%`,
              ].join(" ");
              decor.style.borderRadius = borderRadius;
            }

            container.appendChild(decor);

            // æ¼‚æµ®å‹•ç•«
            anime({
              targets: decor,
              opacity: [0, 0.7],
              delay: anime.random(0, 1000),
              duration: 1000,
              easing: "easeOutQuad",
              complete: function () {
                anime({
                  targets: decor,
                  translateX: () => anime.random(-50, 50) + "px",
                  translateY: () => anime.random(-50, 50) + "px",
                  rotate: () => anime.random(-360, 360),
                  opacity: () => anime.random(0.3, 0.7),
                  easing: "easeInOutQuad",
                  duration: () => anime.random(5000, 10000),
                  direction: "alternate",
                  loop: true,
                });
              },
            });
          }
        } catch (error) {
          console.error("å‰µå»ºæµ®å‹•å…ƒç´ éŒ¯èª¤:", error);
        }
      }

      // ç”¢ç”Ÿé–ƒå…‰æ•ˆæœ
      function createGlitter(event) {
        try {
          const glitterCount = 10;

          for (let i = 0; i < glitterCount; i++) {
            const glitter = document.createElement("div");
            glitter.className = "glitter";

            // è¨­ç½®åˆå§‹ä½ç½®åœ¨æ»‘é¼ ä½ç½®
            glitter.style.left = `${event.clientX}px`;
            glitter.style.top = `${event.clientY}px`;

            // æ·»åŠ åˆ°å®¹å™¨
            document.body.appendChild(glitter);

            // æ¼‚æµ®å‹•ç•«
            anime({
              targets: glitter,
              translateX: () => anime.random(-50, 50),
              translateY: () => anime.random(-50, 50),
              scale: [1, 0],
              opacity: [1, 0],
              easing: "easeOutExpo",
              duration: 1000,
              complete: function () {
                if (glitter.parentNode) {
                  document.body.removeChild(glitter);
                }
              },
            });
          }
        } catch (error) {
          console.error("å‰µå»ºé–ƒå…‰æ•ˆæœéŒ¯èª¤:", error);
        }
      }

      // äº‹ä»¶ç›£è½ - æ»‘é¼ ç§»å‹•æ™‚ç”¢ç”Ÿé–ƒå…‰
      document.addEventListener("DOMContentLoaded", () => {
        const container = document.querySelector(".container");
        if (container) {
          container.addEventListener("mousemove", function (e) {
            if (Math.random() > 0.9) {
              createGlitter(e);
            }
          });
        }
      });

      // åˆå§‹åŒ–äº‹ä»¶ç›£è½å™¨
      function initEventListeners() {
        if (randomDataBtn) {
          randomDataBtn.addEventListener("click", generateRandomData);
        }

        if (startGameBtn) {
          startGameBtn.addEventListener("click", startGame);
        }

        if (backToSetupBtn) {
          backToSetupBtn.addEventListener("click", switchToSetup);
        }

        if (spinWheelBtn) {
          spinWheelBtn.addEventListener("click", spinWheel);
        }
      }

      // éš¨æ©Ÿè³‡æ–™ç”Ÿæˆ
      function generateRandomData() {
        if (!participantsInput || !prizesInput) return;

        const randomNames = [
          "å°æ˜",
          "å°è¯",
          "å°å¼·",
          "å°ç¾",
          "å°èŠ³",
          "å¤§é›„",
          "éœé¦™",
          "èƒ–è™",
          "å°å¤«",
          "å“†å•¦Aå¤¢",
          "é˜¿ç¿°",
          "é˜¿ç¾",
          "å°é¾",
          "å°ç³",
          "å°å‚‘",
          "ä½³ä½³",
          "å°å©·",
          "å°å¨",
          "å°ç²",
          "é˜¿å‡±",
        ];

        const randomPrizes = [
          "iPhone 15",
          "AirPods Pro",
          "æ˜Ÿå·´å…‹ç¦®åˆ¸",
          "é›»å½±ç¥¨å…©å¼µ",
          "å·§å…‹åŠ›ç¦®ç›’",
          "ç²¾ç¾ç­†è¨˜æœ¬",
          "è—ç‰™å–‡å­",
          "USB å……é›»å™¨",
          "åˆé¤æŠ˜åƒ¹åˆ¸",
          "ç²¾ç¾é¦¬å…‹æ¯",
          "æ›¸ç±ç¦®åˆ¸",
          "å¥èº«æˆ¿é«”é©—åˆ¸",
        ];

        // éš¨æ©Ÿé¸å–ä¸€äº›åå­—
        const selectedNames = [];
        const nameCount = Math.floor(Math.random() * 10) + 5; // 5-15 äºº

        for (let i = 0; i < nameCount; i++) {
          const randomIndex = Math.floor(Math.random() * randomNames.length);
          if (!selectedNames.includes(randomNames[randomIndex])) {
            selectedNames.push(randomNames[randomIndex]);
          }
        }

        // éš¨æ©Ÿé¸å–ä¸€äº›çå“
        const selectedPrizes = [];
        const prizeCount = Math.floor(Math.random() * 5) + 3; // 3-8 å€‹çå“

        for (let i = 0; i < prizeCount; i++) {
          const randomIndex = Math.floor(Math.random() * randomPrizes.length);
          if (!selectedPrizes.includes(randomPrizes[randomIndex])) {
            selectedPrizes.push(randomPrizes[randomIndex]);
          }
        }

        participantsInput.value = selectedNames.join("\n");
        prizesInput.value = selectedPrizes.join("\n");

        // å‹•ç•«æ•ˆæœ
        anime({
          targets: [participantsInput, prizesInput],
          backgroundColor: [
            { value: "#e2f3ff", duration: 300 },
            { value: "#fff", duration: 500 },
          ],
          easing: "easeInOutQuad",
        });
      }

      // é–‹å§‹éŠæˆ²
      function startGame() {
        if (!participantsInput || !prizesInput) return;

        // ç²å–åƒèˆ‡è€…å’Œçå“è³‡æ–™
        participants = participantsInput.value
          .split("\n")
          .filter((name) => name.trim() !== "");
        prizes = prizesInput.value
          .split("\n")
          .filter((prize) => prize.trim() !== "");

        // é©—è­‰è³‡æ–™
        if (participants.length === 0) {
          shakeElement(participantsInput);
          return;
        }

        if (prizes.length === 0) {
          shakeElement(prizesInput);
          return;
        }

        // åˆ‡æ›åˆ°éŠæˆ²ç•«é¢
        switchToGame();
      }

      // éœ‡å‹•éŒ¯èª¤æ•ˆæœ
      function shakeElement(element) {
        anime({
          targets: element,
          translateX: [
            { value: 10, duration: 100 },
            { value: -10, duration: 100 },
            { value: 10, duration: 100 },
            { value: -10, duration: 100 },
            { value: 10, duration: 100 },
            { value: 0, duration: 100 },
          ],
          backgroundColor: [
            { value: "#ffeeee", duration: 300 },
            { value: "#fff", duration: 500 },
          ],
          easing: "easeInOutQuad",
        });
      }

      // åˆ‡æ›åˆ°éŠæˆ²ç•«é¢
      function switchToGame() {
        // æ·¡å‡ºè¨­å®šç•«é¢
        anime({
          targets: setupContainer,
          opacity: 0,
          translateY: -50,
          easing: "easeInOutQuad",
          duration: 500,
          complete: function () {
            setupContainer.style.display = "none";
            gameContainer.style.display = "flex";

            // æ·¡å…¥éŠæˆ²ç•«é¢
            anime({
              targets: gameContainer,
              opacity: [0, 1],
              translateY: [50, 0],
              easing: "easeOutQuad",
              duration: 800,
            });

            // å‰µå»ºè¼ªç›¤
            createWheel();

            // å‰µå»ºåƒèˆ‡è€…åˆ—è¡¨
            createParticipantsList();
          },
        });
      }

      // åˆ‡æ›å›è¨­å®šç•«é¢
      function switchToSetup() {
        // æ·¡å‡ºéŠæˆ²ç•«é¢
        anime({
          targets: gameContainer,
          opacity: 0,
          translateY: 50,
          easing: "easeInOutQuad",
          duration: 500,
          complete: function () {
            gameContainer.style.display = "none";
            setupContainer.style.display = "flex";

            // æ·¡å…¥è¨­å®šç•«é¢
            anime({
              targets: setupContainer,
              opacity: [0, 1],
              translateY: [0, 0],
              easing: "easeOutQuad",
              duration: 800,
            });

            // é‡ç½®çµæœå®¹å™¨
            resetResultContainer();

            // æ¸…ç©ºè¼ªç›¤
            wheel.innerHTML = "";
          },
        });
      }

      // å‰µå»ºåƒèˆ‡è€…åˆ—è¡¨
      function createParticipantsList() {
        participantsList.innerHTML = "";

        participants.forEach((participant) => {
          const item = document.createElement("div");
          item.className = "participant-item";
          item.textContent = participant;
          item.dataset.name = participant;
          participantsList.appendChild(item);
        });

        // å‹•ç•«æ•ˆæœ
        anime({
          targets: ".participant-item",
          translateY: [20, 0],
          opacity: [0, 1],
          delay: anime.stagger(50),
          easing: "easeOutQuad",
        });
      }

      // å‰µå»ºè¼ªç›¤
      function createWheel() {
        wheel.innerHTML = "";
        wheelSections = [];

        // ä½¿ç”¨æœ€å°çš„é•·åº¦ï¼Œç¢ºä¿æ¯å€‹äººæ©Ÿç‡ä¸€æ¨£
        const itemCount = participants.length;
        const anglePerSection = 360 / itemCount;

        // å‰µå»ºè¼ªç›¤å€å¡Š
        participants.forEach((name, index) => {
          const section = document.createElement("div");
          section.className = "wheel-section";
          section.dataset.name = name;

          // è¨­å®šæ—‹è½‰è§’åº¦
          section.style.transform = `rotate(${index * anglePerSection}deg)`;

          // è¨­å®šèƒŒæ™¯é¡è‰²
          section.style.background = colors[index % colors.length];

          // è¨­å®šæ–‡å­—
          const text = document.createElement("span");

          // å¦‚æœåå­—å¤ªé•·ï¼Œç¸®çŸ­é¡¯ç¤º
          let displayName = name;
          if (name.length > 6) {
            displayName = name.substring(0, 6) + "...";
          }

          text.textContent = displayName;
          section.appendChild(text);

          // æ·»åŠ åˆ°è¼ªç›¤
          wheel.appendChild(section);
          wheelSections.push(section);
        });

        // è¼ªç›¤å‰µå»ºå®Œæˆå¾Œçš„å‹•ç•«
        anime({
          targets: wheel,
          rotate: [0, 360],
          scale: [0.5, 1],
          opacity: [0, 1],
          duration: 1500,
          easing: "easeOutElastic(1, .5)",
        });

        // åœ“å¿ƒåŠ è¼‰å‹•ç•«
        anime({
          targets: ".wheel-center::after",
          opacity: [0, 1, 0],
          duration: 2000,
          easing: "easeInOutQuad",
        });
      }

      // é‡ç½®çµæœå®¹å™¨
      function resetResultContainer() {
        resultContainer.style.opacity = "0";
        resultContainer.style.transform = "translateY(20px)";
        winnerNameEl.textContent = "";
        winnerPrizeEl.textContent = "";

        // é‡ç½®åƒèˆ‡è€…åˆ—è¡¨æ¨£å¼
        const items = document.querySelectorAll(".participant-item");
        items.forEach((item) => {
          item.classList.remove("winner");
        });

        // é‡ç½®ç•¶å‰ç²çè€…
        currentWinner = null;
        currentPrize = null;
      }

      // è½‰å‹•è¼ªç›¤
      function spinWheel() {
        try {
          if (isSpinning || !wheel || !spinWheelBtn) return;

          // é‡ç½®çµæœ
          resetResultContainer();

          // è¨­ç½®ç‹€æ…‹
          isSpinning = true;
          spinWheelBtn.disabled = true;
          spinWheelBtn.textContent = "æŠ½çä¸­...";

          // é¡¯ç¤ºåŠ è¼‰å‹•ç•«
          showLoadingAnimation();

          // ç”¢ç”Ÿéš¨æ©ŸæŠ½ççµæœ
          const randomWinnerIndex = Math.floor(
            Math.random() * participants.length
          );
          currentWinner = participants[randomWinnerIndex];

          // éš¨æ©Ÿé¸æ“‡ä¸€å€‹çå“
          const randomPrizeIndex = Math.floor(Math.random() * prizes.length);
          currentPrize = prizes[randomPrizeIndex];

          // è¨ˆç®—æ—‹è½‰è§’åº¦
          const finalSectionIndex = randomWinnerIndex;
          const sectionAngle = 360 / participants.length;

          // æ—‹è½‰æ¬¡æ•¸ (5-10 åœˆ) + æœ€çµ‚å€å¡Šä½ç½®
          const spins = (Math.floor(Math.random() * 5) + 5) * 360;

          // æœ€çµ‚è§’åº¦
          // éœ€è¦è®“æŒ‡é‡æŒ‡å‘çš„å€å¡Šåœ¨é ‚éƒ¨ï¼Œæ‰€ä»¥è¦åŠ ä¸Šä¸€å€‹åç§»
          const finalAngle =
            spins + (360 - finalSectionIndex * sectionAngle) - sectionAngle / 2;

          // é–‹å§‹æ—‹è½‰å‰çš„æº–å‚™å‹•ç•«
          anime({
            targets: wheel,
            rotate: "5deg",
            duration: 200,
            easing: "easeInOutQuad",
            complete: function () {
              // ä¸»æ—‹è½‰å‹•ç•«
              anime({
                targets: wheel,
                rotate: finalAngle,
                duration: 5000,
                easing: "easeOutQuint",
                update: function (anim) {
                  try {
                    if (!wheel) return;

                    // æ ¹æ“šå‹•ç•«é€²åº¦è¨­ç½®è¼ªç›¤çš„è¦–è¦ºæ•ˆæœ
                    const progress = Math.min(anim.progress, 60) / 60;
                    const blurValue = 20 + 40 * progress;
                    wheel.style.boxShadow = `0 0 ${blurValue}px rgba(0, 0, 0, 0.2), 0 0 ${
                      blurValue * 3
                    }px rgba(106, 48, 147, 0.2)`;

                    // æ—‹è½‰æ™‚ä¸­å¿ƒçš„å‹•ç•«
                    const centerAfter = document.querySelector(
                      ".wheel-center::after"
                    );
                    if (centerAfter) {
                      centerAfter.style.opacity =
                        anim.progress < 80 ? "1" : "0";
                    }
                  } catch (error) {
                    console.error("æ›´æ–°æ—‹è½‰å‹•ç•«éŒ¯èª¤:", error);
                  }
                },
                complete: function () {
                  setTimeout(() => {
                    try {
                      // é¡¯ç¤ºçµæœ
                      showResult();

                      // é‡ç½®ç‹€æ…‹
                      if (spinWheelBtn) {
                        spinWheelBtn.disabled = false;
                        spinWheelBtn.textContent = "å†æŠ½ä¸€æ¬¡";
                      }
                      isSpinning = false;

                      // é‡ç½®è¼ªç›¤é™°å½±
                      if (wheel) {
                        wheel.style.boxShadow =
                          "0 0 20px rgba(0, 0, 0, 0.2), 0 0 60px rgba(106, 48, 147, 0.2)";
                      }
                    } catch (error) {
                      console.error("å®Œæˆæ—‹è½‰å‹•ç•«éŒ¯èª¤:", error);
                      isSpinning = false;
                      if (spinWheelBtn) {
                        spinWheelBtn.disabled = false;
                        spinWheelBtn.textContent = "å†æŠ½ä¸€æ¬¡";
                      }
                    }
                  }, 500);
                },
              });
            },
          });
        } catch (error) {
          console.error("æ—‹è½‰è¼ªç›¤éŒ¯èª¤:", error);
          isSpinning = false;
          if (spinWheelBtn) {
            spinWheelBtn.disabled = false;
          }
        }
      }

      // é¡¯ç¤ºåŠ è¼‰å‹•ç•«
      function showLoadingAnimation() {
        // é¡¯ç¤ºåŠ è¼‰å‹•ç•«
        loadingAnimation.style.opacity = "1";

        // åŠ è¼‰é»å‹•ç•«
        anime({
          targets: ".loading-dot",
          opacity: [0, 1, 0],
          scale: [0.5, 1, 0.5],
          delay: anime.stagger(200),
          loop: true,
          duration: 1000,
          easing: "easeInOutQuad",
        });
      }

      // éš±è—åŠ è¼‰å‹•ç•«
      function hideLoadingAnimation() {
        try {
          if (loadingAnimation) {
            // æ·¡å‡ºåŠ è¼‰å‹•ç•«
            anime({
              targets: loadingAnimation,
              opacity: 0,
              duration: 500,
              easing: "easeOutQuad",
              complete: function () {
                // åœæ­¢åŠ è¼‰é»å‹•ç•«
                anime.remove(".loading-dot");
              },
            });
          }
        } catch (error) {
          console.error("éš±è—åŠ è¼‰å‹•ç•«éŒ¯èª¤:", error);
        }
      }

      // é¡¯ç¤ºæŠ½ççµæœ
      function showResult() {
        try {
          // éš±è—åŠ è¼‰å‹•ç•«
          hideLoadingAnimation();

          // é«˜äº®ç²çè€…
          const participantItems =
            document.querySelectorAll(".participant-item");
          if (participantItems.length > 0) {
            participantItems.forEach((item) => {
              if (item.dataset.name === currentWinner) {
                item.classList.add("winner");

                // å‹•ç•«å¼·èª¿
                anime({
                  targets: item,
                  scale: [1, 1.2, 1],
                  duration: 1000,
                  easing: "easeInOutElastic(1, .5)",
                });
              }
            });
          }

          // è¨­ç½®çµæœæ–‡å­—
          if (winnerNameEl) winnerNameEl.textContent = currentWinner || "";
          if (winnerPrizeEl)
            winnerPrizeEl.textContent = currentPrize
              ? `ç²å¾—ï¼š${currentPrize}`
              : "";

          // é¡¯ç¤ºçµæœå®¹å™¨
          if (resultContainer) {
            anime({
              targets: resultContainer,
              opacity: 1,
              translateY: 0,
              duration: 800,
              easing: "easeOutQuad",
            });
          }

          // å‰µå»ºæ…¶ç¥å‹•ç•«
          createCelebrationEffects();
        } catch (error) {
          console.error("é¡¯ç¤ºçµæœéŒ¯èª¤:", error);
        }
      }

      // å‰µå»ºæ…¶ç¥æ•ˆæœ
      function createCelebrationEffects() {
        try {
          // å‰µå»ºå½©è‰²ç¢å±‘
          createConfetti();

          // å‰µå»ºç…™ç«æ•ˆæœ
          createFireworks();

          // å‰µå»ºå–œæ‚…æ³¢ç´‹
          createJoyRipple();
        } catch (error) {
          console.error("å‰µå»ºæ…¶ç¥æ•ˆæœéŒ¯èª¤:", error);
        }
      }

      // å‰µå»ºå½©è‰²ç¢å±‘
      function createConfetti() {
        try {
          const confettiCount = 100;
          const container = document.querySelector(".container");

          if (!container) {
            console.error("æ‰¾ä¸åˆ°å®¹å™¨å…ƒç´ ");
            return;
          }

          for (let i = 0; i < confettiCount; i++) {
            const confetti = document.createElement("div");
            confetti.className = "confetti";

            // éš¨æ©Ÿé¡è‰²
            confetti.style.backgroundColor =
              colors[Math.floor(Math.random() * colors.length)];

            // éš¨æ©Ÿå½¢ç‹€
            const shapes = ["circle", "square", "triangle"];
            const shape = shapes[Math.floor(Math.random() * shapes.length)];

            if (shape === "circle") {
              confetti.style.borderRadius = "50%";
            } else if (shape === "triangle") {
              confetti.style.width = "0";
              confetti.style.height = "0";
              confetti.style.backgroundColor = "transparent";
              confetti.style.borderLeft = "5px solid transparent";
              confetti.style.borderRight = "5px solid transparent";
              confetti.style.borderBottom = `10px solid ${
                colors[Math.floor(Math.random() * colors.length)]
              }`;
            }

            // è¨­å®šéš¨æ©Ÿåˆå§‹ä½ç½®
            confetti.style.left = `${Math.random() * 100}%`;
            confetti.style.top = `0`;

            container.appendChild(confetti);

            // å‹•ç•«è¨­å®š
            anime({
              targets: confetti,
              translateX: () =>
                anime.random(-window.innerWidth / 2, window.innerWidth / 2),
              translateY: () => anime.random(100, window.innerHeight),
              rotate: () => anime.random(0, 360),
              opacity: [
                { value: 0, duration: 0 },
                { value: 1, duration: 100 },
                { value: 1, duration: 1000 },
                { value: 0, duration: 500 },
              ],
              scale: [
                { value: 0, duration: 0 },
                { value: 1, duration: 100 },
                { value: anime.random(1, 1.5), duration: 500 },
                { value: 0, duration: 500 },
              ],
              easing: "easeOutQuart",
              duration: () => anime.random(1500, 3000),
              delay: () => anime.random(0, 500),
              complete: function () {
                if (confetti.parentNode) {
                  container.removeChild(confetti);
                }
              },
            });
          }
        } catch (error) {
          console.error("å‰µå»ºå½©è‰²ç¢å±‘éŒ¯èª¤:", error);
        }
      }

      // å‰µå»ºç…™ç«æ•ˆæœ
      function createFireworks() {
        try {
          const fireworkCount = 5;
          const container = document.querySelector(".container");

          if (!container) {
            console.error("æ‰¾ä¸åˆ°å®¹å™¨å…ƒç´ ");
            return;
          }

          for (let i = 0; i < fireworkCount; i++) {
            // å‰µå»ºç…™ç«ä¸­å¿ƒé»
            const firework = document.createElement("div");
            firework.className = "firework";

            // è¨­å®šéš¨æ©Ÿä½ç½®
            firework.style.left = `${anime.random(20, 80)}%`;
            firework.style.top = `${anime.random(20, 60)}%`;

            container.appendChild(firework);

            // å‰µå»ºç…™ç«ç²’å­
            const particleCount = 30;
            const particles = [];

            for (let j = 0; j < particleCount; j++) {
              const particle = document.createElement("div");
              particle.className = "confetti";

              // è¨­ç½®æ¨£å¼
              particle.style.position = "absolute";
              particle.style.width = "5px";
              particle.style.height = "5px";
              particle.style.borderRadius = "50%";
              particle.style.backgroundColor =
                colors[Math.floor(Math.random() * colors.length)];

              // ç²å–ç…™ç«ä½ç½®
              const rect = firework.getBoundingClientRect();
              const containerRect = container.getBoundingClientRect();

              // ç›¸å°æ–¼å®¹å™¨çš„ä½ç½®
              const left = rect.left - containerRect.left;
              const top = rect.top - containerRect.top;

              particle.style.left = `${left}px`;
              particle.style.top = `${top}px`;

              container.appendChild(particle);
              particles.push(particle);

              // ç…™ç«å‹•ç•«
              const angle = (j / particleCount) * 360;
              const radius = anime.random(50, 150);

              anime({
                targets: particle,
                translateX: Math.cos((angle * Math.PI) / 180) * radius,
                translateY: Math.sin((angle * Math.PI) / 180) * radius,
                scale: [
                  { value: 0, duration: 0 },
                  { value: 1, duration: 500 },
                  { value: 0, duration: 700 },
                ],
                opacity: [
                  { value: 0, duration: 0 },
                  { value: 1, duration: 200 },
                  { value: 0, duration: 1000 },
                ],
                easing: "easeOutExpo",
                duration: 1500,
                delay: 500 + anime.random(0, 500),
                complete: function () {
                  if (particle.parentNode) {
                    container.removeChild(particle);
                  }
                },
              });
            }

            // ç…™ç«ä¸­å¿ƒé»é–ƒå…‰
            anime({
              targets: firework,
              scale: [
                { value: 0, duration: 0 },
                { value: 3, duration: 500 },
                { value: 0, duration: 500 },
              ],
              opacity: [
                { value: 1, duration: 0 },
                { value: 0, duration: 1000 },
              ],
              backgroundColor: "#FFF",
              easing: "easeOutExpo",
              duration: 1000,
              complete: function () {
                if (firework.parentNode) {
                  container.removeChild(firework);
                }
              },
            });
          }
        } catch (error) {
          console.error("å‰µå»ºç…™ç«æ•ˆæœéŒ¯èª¤:", error);
        }
      }

      // å‰µå»ºå–œæ‚…æ³¢ç´‹
      function createJoyRipple() {
        try {
          const rippleCount = 3;
          const wheelContainer = document.querySelector(".wheel-container");

          if (!wheelContainer) {
            console.error("æ‰¾ä¸åˆ°è¼ªç›¤å®¹å™¨å…ƒç´ ");
            return;
          }

          for (let i = 0; i < rippleCount; i++) {
            // å‰µå»ºæ³¢ç´‹å…ƒç´ 
            const ripple = document.createElement("div");
            ripple.style.position = "absolute";
            ripple.style.width = "10px";
            ripple.style.height = "10px";
            ripple.style.borderRadius = "50%";
            ripple.style.border =
              "3px solid " + colors[Math.floor(Math.random() * colors.length)];
            ripple.style.left = "50%";
            ripple.style.top = "50%";
            ripple.style.transform = "translate(-50%, -50%)";
            ripple.style.opacity = "0";
            ripple.style.zIndex = "999";

            wheelContainer.appendChild(ripple);

            // æ³¢ç´‹å‹•ç•«
            anime({
              targets: ripple,
              width: [10, 300],
              height: [10, 300],
              opacity: [0, 0.5, 0],
              easing: "easeOutExpo",
              duration: 2000,
              delay: 500 * i,
              complete: function () {
                if (ripple.parentNode) {
                  wheelContainer.removeChild(ripple);
                }
              },
            });
          }
        } catch (error) {
          console.error("å‰µå»ºå–œæ‚…æ³¢ç´‹éŒ¯èª¤:", error);
        }
      }
    </script>
  </body>
</html>
