<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>學業壓力與憂鬱風險之相關性分析 - 演講稿</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700;900&display=swap"
      rel="stylesheet"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css"
      rel="stylesheet"
    />

    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#4F46E5",
              secondary: "#7C3AED",
              accent: "#EC4899",
              neutral: {
                50: "#FAFAF9",
                100: "#F5F5F4",
                200: "#E7E5E4",
                300: "#D6D3D1",
                400: "#A8A29E",
                500: "#78716C",
                600: "#57534E",
                700: "#44403C",
                800: "#292524",
                900: "#1C1917",
              },
            },
            fontFamily: {
              sans: ["Noto Sans TC", "sans-serif"],
            },
            spacing: {
              0.5: "0.125rem",
              1.5: "0.375rem",
              2.5: "0.625rem",
              3.5: "0.875rem",
              4.5: "1.125rem",
              5.5: "1.375rem",
            },
            /* 動畫配置已移除 - 採用靜態設計 */
          },
        },
      };
    </script>

    <style>
      /* 移除所有動畫效果 - 清爽簡潔的靜態樣式 */
      .section-transition,
      .section-visible {
        opacity: 1 !important;
        transform: none !important;
        animation: none !important;
      }
      
      /* 自定義滾動條 */
      ::-webkit-scrollbar {
        width: 6px;
      }
      ::-webkit-scrollbar-track {
        background: #f3f4f6;
      }
      ::-webkit-scrollbar-thumb {
        background: #d1d5db;
        border-radius: 3px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #9ca3af;
      }

      /* 平滑滾動 */
      html {
        scroll-behavior: smooth;
      }

      /* 進度條 - 移除過渡動畫 */
      .progress-bar {
        /* transition: width 0.3s ease-out; 移除動畫 */
      }

      /* 隱藏彩蛋樣式 - 簡化效果 */
      .easter-egg {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 40px;
        height: 40px;
        opacity: 0.3;
        cursor: pointer;
        /* transition: all 0.3s ease; 移除動畫 */
      }

      .easter-egg:hover {
        opacity: 0.8;
        /* transform: scale(1.1); 移除縮放動畫 */
      }

      .easter-egg-message {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 2rem;
        border-radius: 1rem;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        display: none;
        /* animation: fadeIn 0.5s ease-out; 移除動畫 */
      }
      
      /* 移除所有keyframes動畫定義 */
    </style>
  </head>
  <body class="bg-neutral-50 text-neutral-800 font-sans">
    <div class="fixed top-0 left-0 w-full h-1 bg-gray-200 z-50">
      <div
        id="progress-bar"
        class="progress-bar h-full bg-gradient-to-r from-primary to-secondary"
        style="width: 0%"
      ></div>
    </div>

    <nav
      class="fixed top-1 left-0 w-full bg-white/90 backdrop-blur-sm shadow-sm z-40"
    >
      <div class="container mx-auto px-4 py-3">
        <div class="flex items-center justify-between">
          <h1 class="text-lg font-bold text-primary">演講稿</h1>
          <button
            id="menu-toggle"
            class="text-2xl text-neutral-600 hover:text-primary transition-colors"
          >
            <i class="ri-menu-3-line"></i>
          </button>
        </div>
      </div>
    </nav>

    <aside
      id="sidebar"
      class="fixed top-0 right-0 h-full w-72 bg-white shadow-2xl transform translate-x-full transition-transform duration-300 z-50 overflow-y-auto"
    >
      <div class="p-4">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-xl font-bold text-neutral-800">章節導航</h2>
          <button
            id="close-menu"
            class="text-2xl text-neutral-600 hover:text-primary transition-colors"
          >
            <i class="ri-close-line"></i>
          </button>
        </div>
        <nav id="section-nav" class="space-y-2">
          </nav>
      </div>
    </aside>

    <main class="container mx-auto px-4 pt-20 pb-24">
      <section class="mb-8 text-center section-transition">
        <h1
          class="text-2xl sm:text-3xl md:text-4xl font-bold text-neutral-900 mb-4 leading-tight"
        >
          學業壓力與憂鬱風險之相關性分析
        </h1>
        <p class="text-neutral-600 text-sm">總時間：18分鐘 | Q&A：2-3分鐘</p>
      </section>

      <section data-section="封面" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >1</span
            >
            <h2 class="text-xl font-semibold text-neutral-800">封面</h2>
            <span class="ml-auto text-sm text-neutral-500">10秒</span>
          </div>
          <div class="prose prose-sm max-w-none">
            <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">開場白：</strong>
              各位老師、各位同學，大家好！今天我們要報告的是「學業壓力與憂鬱風險之相關性分析」。
            </p>
          </div>
        </div>
      </section>

      <!-- 00 摘要章節封面 -->
      <section data-section="摘要封面" class="mb-12 section-transition">
        <div class="bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg shadow-sm p-6">
          <div class="flex items-center mb-4">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-white text-blue-600 rounded-full text-sm font-bold mr-3">2</span>
            <h2 class="text-xl font-semibold">00 摘要</h2>
            <span class="ml-auto text-sm text-white/80">章節封面</span>
          </div>
          <p class="text-white/90 leading-relaxed">
            分析 27,901 名大學生問卷，中度正相關 r = 0.475，憂鬱比例 19% → 82%。
          </p>
        </div>
      </section>

      <section data-section="摘要" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >2-3</span
            >
            <h2 class="text-xl font-semibold text-neutral-800">摘要內容</h2>
            <span class="ml-auto text-sm text-neutral-500">1分鐘</span>
          </div>
          <div class="space-y-4">
            <div
              class="bg-gradient-to-r from-primary/10 to-secondary/10 rounded-lg p-4"
            >
              <p class="text-neutral-700 leading-relaxed">
                <strong class="text-primary">核心發現：</strong> 我們分析了近
                <span class="font-bold text-2xl text-primary">2.8 萬名</span> (27,901名) 大學生問卷資料，證實「學業壓力越大，憂鬱風險越高」。這兩者呈中度正相關
                (r =
                <span class="font-bold text-xl text-secondary">0.475</span>)。
              </p>
            </div>

            <div class="bg-accent/10 rounded-lg p-4">
              <p class="text-neutral-700 leading-relaxed">
                <strong class="text-accent">數據支持：</strong>
                你看，壓力低的時候只有
                <span class="font-bold text-xl text-green-600">19.44%</span>
                的人有憂鬱風險，但壓力高時，這個比例飆升到
                <span class="font-bold text-xl text-red-600">81.63%</span>！ 這個差異非常顯著。
              </p>
            </div>

            <div class="space-y-3">
              <p class="text-neutral-700 leading-relaxed">
                <strong class="text-primary">研究方法：</strong>
                我們用了描述性統計、卡方檢定，以及兩種機器學習模型來預測（Logistic
                Regression 準確率
                <span class="font-semibold text-primary">73.4%</span>，AUC
                <span class="font-semibold text-primary">0.805</span>；Random
                Forest 準確率
                <span class="font-semibold text-secondary">69.3%</span>，AUC
                <span class="font-semibold text-secondary">0.750</span>）。
              </p>

              <p class="text-neutral-700 leading-relaxed">
                <strong class="text-primary">實用工具：</strong> 我們還整合了
                Python、MySQL 和
                Grafana，建立了一套三層架構動態監控系統，學校可以即時看到高風險學生。
              </p>

              <p class="text-neutral-700 leading-relaxed">
                <strong class="text-primary">最終建議：</strong>
                根據分析結果，我們建議學校針對高壓力學生提供相關協助。
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- 01 緒論章節封面 -->
      <section data-section="緒論封面" class="mb-12 section-transition">
        <div class="bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg shadow-sm p-6">
          <div class="flex items-center mb-4">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-white text-purple-600 rounded-full text-sm font-bold mr-3">4</span>
            <h2 class="text-xl font-semibold">01 緒論</h2>
            <span class="ml-auto text-sm text-white/80">章節封面</span>
          </div>
          <p class="text-white/90 leading-relaxed">
            研究背景：課業競爭、心理健康受關注。
          </p>
        </div>
      </section>

      <section data-section="緒論" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >4-6</span
            >
            <h2 class="text-xl font-semibold text-neutral-800">緒論內容</h2>
            <span class="ml-auto text-sm text-neutral-500">0.3分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">研究背景與動機：</strong>
              隨著學業競爭加劇，大學生面臨的壓力日益增加，這對心理健康可能產生深遠影響，尤其是憂鬱風險。台灣目前對這塊的實證研究還不夠。
            </p>
            <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">研究目的：</strong>
              本研究旨在探討學業壓力與憂鬱風險之間的關聯性，並建立預測模型，最終提供一套資料視覺化整合系統，為學校提供早期預警機制與介入策略。
            </p>
          </div>
        </div>
      </section>

      <!-- 02 研究方法與資料章節封面 -->
      <section data-section="研究方法封面" class="mb-12 section-transition">
        <div class="bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-lg shadow-sm p-6">
          <div class="flex items-center mb-4">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-white text-emerald-600 rounded-full text-sm font-bold mr-3">7</span>
            <h2 class="text-xl font-semibold">02 研究方法與資料</h2>
            <span class="ml-auto text-sm text-white/80">章節封面</span>
          </div>
          <p class="text-white/90 leading-relaxed">
            三大方法：統計分析、機器學習、資料庫整合視覺化。
          </p>
        </div>
      </section>

      <section data-section="研究方法概覽" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >8-14</span
            >
            <h2 class="text-xl font-semibold text-neutral-800">研究方法與資料來源</h2>
            <span class="ml-auto text-sm text-neutral-500">0.5分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">三大方法：</strong>
              統計分析（描述性統計、群組比較、卡方檢定、PCA）、機器學習模型（Logistic Regression、Random Forest）、資料庫整合視覺化（MySQL、XAMPP、Grafana）。
            </p>
            <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">資料來源：</strong>
              Kaggle 匿名問卷資料集，18 欄、27,901 筆學生資料，主要欄位：Academic Pressure (0–5)、Depression (0/1)、Age、CGPA、Study Satisfaction。
            </p>
            <div class="bg-neutral-100 rounded-lg p-4">
              <p class="text-neutral-700 leading-relaxed">
                <strong class="text-primary">資料清洗流程：</strong>
                Depression 映射 0/1、Degree 缺值填補與分級、刪重補缺去離群、中位數填補|z|<3。最終樣本數：
                <span class="font-bold text-2xl text-primary">27,873 筆</span>。
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- 03 統計分析章節封面 -->
      <section data-section="統計分析封面" class="mb-12 section-transition">
        <div class="bg-gradient-to-r from-green-500 to-blue-600 text-white rounded-lg shadow-sm p-6">
          <div class="flex items-center mb-4">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-white text-green-600 rounded-full text-sm font-bold mr-3">15</span>
            <h2 class="text-xl font-semibold">03 統計分析</h2>
            <span class="ml-auto text-sm text-white/80">章節封面</span>
          </div>
          <p class="text-white/90 leading-relaxed">
            現在來看看我們的統計分析結果，這是最關鍵的部分！
          </p>
        </div>
      </section>

      <section data-section="描述性統計與相關性" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >15-22</span 
            > 
            <h2 class="text-xl font-semibold text-neutral-800 flex items-baseline">
              統計分析：壓力與憂鬱的關係 <span class="text-xs font-normal text-neutral-500 ml-2">(p.15-22)</span>
            </h2>
            <span class="ml-auto text-sm text-neutral-500">1.5分鐘</span>
          </div>
          <div class="space-y-4">
             <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">學業壓力跟憂鬱到底有沒有關？ <span class="text-xs font-normal text-neutral-400">(p.16)</span></strong>
              答案是有的！它們之間是中度正相關，相關係數 r 值是 <span class="font-bold text-xl text-primary">0.475</span>。簡單來說，學業壓力程度越高，憂鬱的風險也越高。
            </p>
            <div
              class="bg-gradient-to-r from-green-50 to-red-50 rounded-lg p-4"
            >
              <p class="text-neutral-700 leading-relaxed mb-3">
                <strong class="text-primary">壓力分層看更清楚 <span class="text-xs font-normal text-neutral-400">(p.17)</span>：</strong>
                我們把學業壓力分成「低、中、高」三組來看：
              </p>
              <div class="flex justify-around items-center">
                <div class="text-center">
                  <p class="text-sm text-neutral-600">低壓力組</p>
                  <p class="text-3xl font-bold text-green-600">19.44%</p>
                  <p class="text-xs text-neutral-500">有憂鬱風險</p>
                </div>
                <i class="ri-arrow-right-line text-2xl text-neutral-400"></i>
                <div class="text-center">
                  <p class="text-sm text-neutral-600">高壓力組</p>
                  <p class="text-3xl font-bold text-red-600">81.63%</p>
                  <p class="text-xs text-neutral-500">有憂鬱風險</p>
                </div>
              </div>
               <p class="text-xs text-neutral-500 mt-2 text-center">(數據來源: p.17)</p>
               <p class="text-neutral-700 leading-relaxed mt-3">
                從圖表 <span class="text-xs font-normal text-neutral-400">(p.18-19)</span> 可以明顯看到，隨著壓力程度的增加，憂鬱風險的比例也直線攀升。
               </p>
            </div>

            <div class="bg-primary/10 rounded-lg p-4">
              <p class="text-neutral-700 leading-relaxed">
                <strong class="text-primary">卡方檢定來驗證 <span class="text-xs font-normal text-neutral-400">(p.20-22)</span>：</strong>
                為了進一步確認這兩者是不是真的有關聯，我們做了卡方檢定。
                從列聯表 <span class="text-xs font-normal text-neutral-400">(p.21)</span> 可以看到，低壓力組有憂鬱風險的是933人，沒有的是3866人；而高壓力組，有憂鬱風險的高達9341人，沒有的只有2102人。
                卡方檢定的結果顯示，卡方值 χ² 是 <span class="font-semibold text-primary">5740.656</span>，p 值遠小於 0.001。這代表不同壓力層級之間的憂鬱風險差異非常顯著，不是偶然發生的。
              </p>
            </div>
          </div>
        </div>
      </section>
      
      <section data-section="PCA分析" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >23-24</span
            >
            <h2 class="text-xl font-semibold text-neutral-800 flex items-baseline">
              主成分分析 (PCA) 探索 <span class="text-xs font-normal text-neutral-500 ml-2">(p.23-24)</span>
            </h2>
            <span class="ml-auto text-sm text-neutral-500">1分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">PCA是做什麼的？</strong>
              想像一下你有很多雜七雜八的資料，PCA就像一個聰明的整理師，它的目的是「降維」並找出能主要解釋變異的關鍵因素，幫我們把最重要的資訊（也就是主成分）抽出來，丟掉一些比較次要的，讓我們能更容易看清楚資料中潛在的結構和相互關係。
            </p>
            <div class="bg-neutral-100 rounded-lg p-4">
              <p class="text-neutral-700 leading-relaxed">
                <strong class="text-primary">PCA分析結果 <span class="text-xs font-normal text-neutral-400">(p.23-24)</span>：</strong>
                我們發現，第一個主成分 (PC1) 就解釋了總變異的 <span class="font-bold text-xl text-secondary">78.3%</span> <span class="text-xs font-normal text-neutral-400">(p.23)</span>。
                那麼，PC1 主要跟哪些因素有關呢？前五大影響因素（載荷量 <span class="text-xs font-normal text-neutral-400">(p.24)</span>）分別是：
                <ol class="list-decimal list-inside ml-4 text-sm">
                  <li>年齡 (Age): 1.000</li>
                  <li><strong class="text-red-600">學業壓力 (Academic Pressure_Value): 0.024</strong></li>
                  <li>學歷等級 (degree_ord4): 0.017</li>
                  <li>學習滿意度 (Study Satisfaction): 0.003</li>
                  <li>CGPA: 0.002</li>
                </ol>
                這個結果顯示，雖然年齡是影響最大的，但<strong class="text-red-600">學業壓力在PC1中也排名第二</strong>，代表它對整體資料變異的貢獻度具有次要但不可忽視的影響力。
              </p>
            </div>
          </div>
        </div>
      </section>

      <section data-section="其他變項相關" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >25-27</span
            >
            <h2 class="text-xl font-semibold text-neutral-800 flex items-baseline">
              學業壓力與其他因素的關聯 <span class="text-xs font-normal text-neutral-500 ml-2">(p.25-26)</span> & 小結
            </h2>
            <span class="ml-auto text-sm text-neutral-500">1分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">學業壓力還跟誰有關？ <span class="text-xs font-normal text-neutral-400">(p.25-26)</span></strong>
              我們也用了 Pearson 相關係數，看看學業壓力 (Academic Pressure_Value) 和其他變數之間的線性關係有多強。
            </p>
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
              <p class="text-neutral-700 leading-relaxed mb-2">
                <strong class="text-yellow-700">主要發現：</strong>
              </p>
              <ul class="list-disc list-inside ml-4 text-sm">
                <li>與「工作/學習時數 (Work/Study Hours)」呈正相關 (r = <span class="font-semibold">0.208</span>)：這很直觀，學習時間越長，感受到的學業壓力可能就越大。</li>
                <li>與「年齡 (Age)」呈負相關 (r = <span class="font-semibold">-0.225</span>)：也許年紀稍長、經驗較多的學生，比較懂得調適壓力。</li>
                <li>與「學習滿意度 (Study Satisfaction)」也呈負相關 (r = <span class="font-semibold">-0.168</span>)：學習越不滿意，壓力可能就越高。</li>
                <li>和「CGPA」的相關性比較弱 (r = <span class="font-semibold">0.022</span>)。</li>
              </ul>
              <p class="text-neutral-600 text-xs mt-2">(數據來源: p.26)</p>
            </div>
            <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">統計分析小結 (對應您的 Slide 27)：</strong>
              綜合來看，學業壓力不僅和憂鬱風險有顯著的中度正相關，也和學習時數、年齡、學習滿意度等因素有關。這些發現都為我們後續的機器學習模型提供了重要的基礎。
            </p>
          </div>
        </div>
      </section>

      <!-- 04 機器學習模型章節封面 -->
      <section data-section="機器學習模型封面" class="mb-12 section-transition">
        <div class="bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-lg shadow-sm p-6">
          <div class="flex items-center mb-4">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-white text-orange-600 rounded-full text-sm font-bold mr-3">28</span>
            <h2 class="text-xl font-semibold">04 機器學習模型</h2>
            <span class="ml-auto text-sm text-white/80">章節封面</span>
          </div>
          <p class="text-white/90 leading-relaxed">
            Logistic Regression 為首選篩檢工具，Random Forest 作穩健驗證。
          </p>
        </div>
      </section>

      <section data-section="LogisticRegression" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >29-31</span
            >
            <h2 class="text-xl font-semibold text-neutral-800 flex items-baseline">
              Logistic Regression 模型表現 <span class="text-xs font-normal text-neutral-500 ml-2">(p.28-31)</span>
            </h2>
            <span class="ml-auto text-sm text-neutral-500">1.5分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">Logistic Regression 是什麼？ <span class="text-xs font-normal text-neutral-400">(p.29 Diagram)</span></strong>
              它是一種常用來解決二元分類問題的統計模型，簡單來說，就是預測一個結果是「是」還是「否」，例如我們研究中的「有憂鬱風險」或「無憂鬱風險」。
            </p>
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                <p class="text-neutral-700 leading-relaxed mb-3">
                    <strong class="text-primary">混淆矩陣是什麼？</strong>
                    它是一個表格，用來視覺化分類模型在測試集上的表現，告訴我們模型預測的「有」或「沒有」跟真實情況是不是一致。
                </p>
                <div class="grid grid-cols-2 gap-2 mt-2 text-xs">
                    <div class="bg-green-100 rounded p-2"><p class="font-semibold text-green-700">True Positive (TP):</p> 真正有憂鬱，模型也預測有。</div>
                    <div class="bg-green-100 rounded p-2"><p class="font-semibold text-green-700">True Negative (TN):</p> 真正沒有，模型也預測沒有。</div>
                    <div class="bg-red-100 rounded p-2"><p class="font-semibold text-red-700">False Positive (FP):</p> 真正沒有，模型卻說有 (偽陽性)。</div>
                    <div class="bg-red-100 rounded p-2"><p class="font-semibold text-red-700">False Negative (FN):</p> 真正有，模型卻說沒有 (偽陰性)。</div>
                </div>
            </div>
            <div class="bg-blue-50 rounded-lg p-4">
                <p class="text-neutral-700 leading-relaxed">
                    <strong class="text-primary">模型表現 <span class="text-xs font-normal text-neutral-400">(p.31)</span>：</strong>
                    Logistic Regression 的整體準確率 (Accuracy) 是 <span class="font-bold text-xl text-primary">73.4%</span>，AUC值是 <span class="font-bold text-xl text-primary">0.805</span>。
                    從混淆矩陣來看：
                    <ul class="list-disc list-inside ml-4 text-sm">
                        <li>預測「有憂鬱」的精確率 (Precision) 是 0.80，代表模型預測有憂鬱的人裡面，80%是真的有。</li>
                        <li>「有憂鬱」的召回率 (Recall) 是 0.73，代表真正有憂鬱的人裡面，模型成功找出了73%。</li>
                        <li>預測「無憂鬱」的精確率是 0.66，召回率是 0.74。</li>
                    </ul>
                    大家也可以看到 ROC 曲線 <span class="text-xs font-normal text-neutral-400">(p.30)</span>，曲線越靠近左上角代表模型表現越好，我們的 AUC 有 0.805，算是不錯的表現！
                </p>
            </div>
          </div>
        </div>
      </section>
      
      <section data-section="RandomForestResults" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >32-33</span 
            >
            <h2 class="text-xl font-semibold text-neutral-800 flex items-baseline">
              Random Forest 模型表現 <span class="text-xs font-normal text-neutral-500 ml-2">(p.32-33)</span>
            </h2>
            <span class="ml-auto text-sm text-neutral-500">1分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-neutral-700 leading-relaxed">
                <strong class="text-primary">Random Forest (隨機森林) 又是什麼呢？ <span class="text-xs font-normal text-neutral-400">(p.32 Diagram)</span></strong>
                這個我們等一下會詳細解釋它的原理。
            </p>
            <div class="bg-purple-50 rounded-lg p-4">
                <p class="text-neutral-700 leading-relaxed">
                    <strong class="text-primary">模型表現 <span class="text-xs font-normal text-neutral-400">(p.33 & p.3 Summary)</span>：</strong>
                    Random Forest 的整體準確率 (Accuracy) 是 <span class="font-bold text-xl text-secondary">69.3%</span>，AUC值是 <span class="font-bold text-xl text-secondary">0.750</span>。
                    雖然準確率比 Logistic Regression 稍低一點，但 AUC 0.750 也代表它有不錯的分類能力。
                </p>
                 <p class="text-xs text-neutral-500 mt-2"> (註: p.33 顯示 Acc 68.8%, AUC 0.751, 此處採用 p.3 摘要頁的數值 Acc 69.3%, AUC 0.750 以求簡報一致性)</p>
            </div>
          </div>
        </div>
      </section>

      <section data-section="隨機森林原理" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >原理</span 
            > 
            <h2 class="text-xl font-semibold text-neutral-800 flex items-baseline">
              Random Forest 原理 - 隨機森林簡單講
            </h2>
            <span class="ml-auto text-sm text-neutral-500">1.5分鐘</span>
          </div>
          <div class="space-y-4">
            <div class="bg-orange-50 rounded-lg p-4">
              <p class="text-neutral-700 leading-relaxed mb-3">
                <strong class="text-primary">隨機森林模型是怎麼預測的？</strong>
              </p>
              <p class="text-neutral-700 leading-relaxed mb-3">
                它就像一個「<span class="font-bold text-orange-600">大老闆</span>」，不像一個單打獨鬥的「小員工」。它不只用一棵決策樹來判斷，而是訓練了<span
                  class="font-bold text-orange-600"
                  >很多很多棵</span
                >「隨機」的小決策樹，然後讓這些樹各自做出判斷，最後再集合大家的意見，用「<span
                  class="font-bold text-orange-600"
                  >投票</span
                >」的方式來決定最終結果。
              </p>
            </div>

            <div class="bg-neutral-100 rounded-lg p-4">
              <p class="text-neutral-700 leading-relaxed mb-3">
                <strong class="text-primary">怎麼做到「隨機」？</strong>
              </p>
              <ul class="space-y-2 text-sm">
                <li class="flex items-start">
                  <span
                    class="inline-flex items-center justify-center w-6 h-6 bg-primary text-white rounded-full text-xs mr-2 mt-0.5"
                    >1</span
                  >
                  <div>
                    <strong>資料隨機抽樣：</strong>
                    每棵小樹訓練用的資料都是從原始資料中隨機抽取出來的，而且可以重複抽（這叫做
                    Bootstrap Sampling）。
                  </div>
                </li>
                <li class="flex items-start">
                  <span
                    class="inline-flex items-center justify-center w-6 h-6 bg-primary text-white rounded-full text-xs mr-2 mt-0.5"
                    >2</span
                  >
                  <div>
                    <strong>特徵隨機選擇：</strong>
                    建立每棵樹的時候，它不是看所有特徵來分裂，而是只從隨機選取的一小部分特徵中挑選。
                  </div>
                </li>
              </ul>
            </div>

            <div class="bg-green-50 rounded-lg p-4">
              <p class="text-neutral-700 leading-relaxed">
                <strong class="text-primary">這樣有什麼好處？</strong>
                因為每棵小樹都是獨立思考的，而且有隨機性，所以它們的判斷會比較多樣化。當大家一起投票時，就能大大減少單一決策樹可能犯的錯誤，讓最終的預測結果更穩定、更準確，也比較不會過度擬合（Overfitting）。
              </p>
            </div>
          </div>
        </div>
      </section>
      
      <section data-section="特徵重要性" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >34-36</span
            >
            <h2 class="text-xl font-semibold text-neutral-800 flex items-baseline">
              特徵重要性分析 <span class="text-xs font-normal text-neutral-500 ml-2">(p.34-35)</span> & 模型小結
            </h2>
            <span class="ml-auto text-sm text-neutral-500">1分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">誰是關鍵？ <span class="text-xs font-normal text-neutral-400">(p.34-35)</span></strong>
              我們分析了哪些特徵對於預測憂鬱風險最重要。結果非常一致：
              <strong class="text-red-600">「學業壓力 (Academic Pressure_Value)」</strong>在 Logistic Regression (重要性 1.137) 和 Random Forest (重要性 0.138) 兩個模型中都顯示出<span class="font-semibold text-secondary">最高的影響力，都是 Rank #1</span>。
            </p>
            <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">還有誰重要？</strong> 
              其他像是「年齡 (Age)」、「學習滿意度 (Study Satisfaction)」、「CGPA」等也對憂鬱風險有不同程度的影響。大家可以從圖示 <span class="text-xs font-normal text-neutral-400">(p.35)</span> 中看到詳細的排序。
            </p>
            <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">機器學習模型小結 (對應您的 Slide 36)：</strong>
              兩個模型都告訴我們，學業壓力是預測憂鬱風險的最關鍵因素。Logistic Regression 的整體準確率稍高，也更容易解釋。因此，我們建議可以採用 Logistic Regression 作為初步的風險篩檢工具，而 Random Forest 可以作為結果的穩健性驗證。
            </p>
          </div>
        </div>
      </section>

      <!-- 05 資料庫整合與視覺化章節封面 -->
      <section data-section="資料庫整合視覺化封面" class="mb-12 section-transition">
        <div class="bg-gradient-to-r from-cyan-500 to-purple-600 text-white rounded-lg shadow-sm p-6">
          <div class="flex items-center mb-4">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-white text-cyan-600 rounded-full text-sm font-bold mr-3">37</span>
            <h2 class="text-xl font-semibold">05 資料庫整合與視覺化</h2>
            <span class="ml-auto text-sm text-white/80">章節封面</span>
          </div>
          <p class="text-white/90 leading-relaxed">
            三層架構系統：Python + MySQL + Grafana，讓數據活起來！
          </p>
        </div>
      </section>

      <section data-section="資料庫整合系統概覽" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >37-42</span
            >
            <h2 class="text-xl font-semibold text-neutral-800 flex items-baseline">
              資料庫整合與視覺化系統 <span class="text-xs font-normal text-neutral-500 ml-2">(p.37-42)</span>
            </h2>
            <span class="ml-auto text-sm text-neutral-500">2分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-neutral-700 leading-relaxed mb-4">
              <strong class="text-primary">我們怎麼讓數據活起來？ <span class="text-xs font-normal text-neutral-400">(p.37)</span></strong>
              為了讓學校能方便地使用我們的分析結果，我們建立了一個「三層樓」的動態監控系統 <span class="text-xs font-normal text-neutral-400">(p.38 圖示)</span>：
            </p>

            <div class="space-y-3">
              <div
                class="bg-gradient-to-r from-blue-50 to-cyan-50 rounded-lg p-4 border-l-4 border-blue-500"
              >
                <p class="text-neutral-700 leading-relaxed">
                  <strong class="text-blue-700">第一層：資料前處理層 (Python) <span class="text-xs font-normal text-neutral-400">(p.40)</span>：</strong>
                  這裡是我們的「智慧廚房」，負責資料清洗、特徵工程、模型訓練，最後產出預測結果。
                </p>
                <div class="mt-3 bg-white rounded p-3">
                  <p class="text-sm text-neutral-600">
                    <strong>模組化設計：</strong>
                    我們把整個分析流程拆分成一個個獨立的、可以重複使用的「積木」或「零件」。例如，資料清洗是一個模組，模型訓練是另一個模組。這樣當有新資料進來，或想調整某個步驟時，只需要更新對應的「積木」，讓整個系統更靈活、好維護，也支援持續的資料更新與重新分析。
                  </p>
                </div>
              </div>

              <div
                class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-4 border-l-4 border-purple-500"
              >
                <p class="text-neutral-700 leading-relaxed">
                  <strong class="text-purple-700"
                    >第二層：資料持久層 (MySQL 資料庫) <span class="text-xs font-normal text-neutral-400">(p.41)</span>：</strong
                  >
                  這裡是我們的「超級倉庫」，用 MySQL 資料庫 (透過 XAMPP 運行在 3306 port) 集中儲存所有原始資料和多維度的分析結果。它也支援索引優化與複雜查詢，確保視覺化時資料查詢速度快，效能好。
                </p>
              </div>

              <div
                class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4 border-l-4 border-green-500"
              >
                <p class="text-neutral-700 leading-relaxed">
                  <strong class="text-green-700"
                    >第三層：視覺化展示層 (Grafana 儀表板) <span class="text-xs font-normal text-neutral-400">(p.42)</span>：</strong
                  >
                  這裡是我們的「互動展示廳」(運行在 3000 port)。透過連接 MySQL 資料庫，把數據變成即時更新的互動式圖表，例如壓力層級條形圖 <span class="text-xs font-normal text-neutral-400">(p.45)</span> 或學歷壓力憂鬱比較圖 <span class="text-xs font-normal text-neutral-400">(p.46)</span>。管理者可以很直觀地看到各種分析結果，還能做多維度篩選和下鑽分析！
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section data-section="資料流轉與自動化" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >43-44</span
            >
            <h2 class="text-xl font-semibold text-neutral-800 flex items-baseline">
              資料流轉與自動化 <span class="text-xs font-normal text-neutral-500 ml-2">(p.43-44)</span>
            </h2>
            <span class="ml-auto text-sm text-neutral-500">1.5分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-neutral-700 leading-relaxed mb-4">
              <strong class="text-primary">資料怎麼跑？確保一致又可追溯 <span class="text-xs font-normal text-neutral-400">(p.43)</span>：</strong>
                我們設計了單向的資料流：Python 分析完資料後，結果會自動寫入 MySQL 資料庫，然後 Grafana 再從資料庫讀取來呈現。這樣能確保資料的一致性和可追溯性。
            </p>
             <p class="text-neutral-700 leading-relaxed mb-2">
              <strong class="text-primary">自動化寫入資料庫，省時又省力 <span class="text-xs font-normal text-neutral-400">(p.44)</span>！</strong>
              我們用了一個叫做 <strong class="text-secondary">SQLAlchemy ORM</strong> 的工具。
            </p>
            <div class="bg-blue-50 rounded-lg p-4 mb-3">
                <p class="text-neutral-700 leading-relaxed">
                    <strong class="text-blue-700">ORM 是什麼好東西？</strong>
                    想像一下，你不用自己一句一句寫很囉嗦的 SQL 指令去跟資料庫溝通。ORM (Object-Relational Mapper) 就像一個聰明的「翻譯官」，它能讓你用比較習慣的 Python 物件方式來操作資料庫裡的表格和資料，然後它會自動把這些操作「翻譯」成資料庫看得懂的 SQL 語法。這樣一來，我們的 Python 程式碼就更簡潔、更好懂，也更容易維護！
                </p>
            </div>

            <p class="text-neutral-700 leading-relaxed">
                大家可以看到螢幕上的 Python 腳本範例 <span class="text-xs font-normal text-neutral-400">(p.44)</span>：
            </p>
            <div class="bg-gray-900 rounded-lg p-4 overflow-x-auto">
              <pre class="text-green-400 text-sm"><code># 自動化資料庫寫入流程 (示意)
from sqlalchemy import create_engine, text
# import pandas as df (假設df已存在)

# 1. 建立資料庫引擎連線
engine = create_engine("mysql+pymysql://user:pw@host/db")

# 2. 自動執行SQL腳本建立資料表 (如果它還不存在)
#    (假設 create_table.sql 內有 CREATE TABLE IF NOT EXISTS ...)
#    with open('db/create_table.sql', 'r') as sql_file:
#        with engine.connect() as conn:
#            conn.execute(text(sql_file.read()))
#            conn.commit()

# 3. 把處理好的 DataFrame (df) 整批匯出到資料庫
#    'student_depression' 是資料表名稱
#    if_exists='replace' 表示如果表已存在就取代掉
df.to_sql( 
    'student_depression', 
    con=engine, 
    if_exists='replace', 
    index=False,
    chunksize=1000  # 分批寫入，對大量資料更友善
)
print("資料已自動匯入資料庫！")</code></pre>
            </div>
            <div class="grid grid-cols-3 gap-3 mt-4">
              <div class="bg-green-100 rounded p-3 text-center">
                <i class="ri-database-2-line text-2xl text-green-600 mb-2"></i>
                <p class="text-sm font-semibold text-green-700">自動建庫</p>
                <p class="text-xs text-neutral-600">檢查並建立資料庫</p>
              </div>
              <div class="bg-blue-100 rounded p-3 text-center">
                <i class="ri-table-line text-2xl text-blue-600 mb-2"></i>
                <p class="text-sm font-semibold text-blue-700">自動建表</p>
                <p class="text-xs text-neutral-600">執行 SQL 腳本建表</p>
              </div>
              <div class="bg-purple-100 rounded p-3 text-center">
                <i class="ri-upload-cloud-2-line text-2xl text-purple-600 mb-2"></i>
                <p class="text-sm font-semibold text-purple-700">自動匯入</p>
                <p class="text-xs text-neutral-600">分批寫入 27,873 筆資料</p>
              </div>
            </div>
            <p class="text-neutral-700 leading-relaxed mt-2">
                <strong class="text-primary">自動化優勢：</strong>
                這整個流程，從連線、檢查/建立資料表，到把我們那 <span class="font-semibold">27,873 筆</span> 清洗好的資料分批寫入資料庫，幾乎都是自動完成的。這樣不僅效率高，也能確保每次資料更新時的穩定性和正確性。
            </p>
          </div>
        </div>
      </section>
      
      <section data-section="資料庫索引策略" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >47</span
            >
            <h2 class="text-xl font-semibold text-neutral-800 flex items-baseline">
              資料庫設計與優化 - 索引策略 <span class="text-xs font-normal text-neutral-500 ml-2">(p.47)</span>
            </h2>
            <span class="ml-auto text-sm text-neutral-500">1分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-neutral-700 leading-relaxed mb-4">
              <strong class="text-primary"
                >為了讓 Grafana 跑得飛快，我們對資料庫做了優化 <span class="text-xs font-normal text-neutral-400">(p.47)</span>：</strong
              > 其中一個關鍵就是「索引」。
            </p>
             <p class="text-neutral-700 leading-relaxed">
              <strong class="text-secondary">什麼是索引？</strong>
              想像一下書本最後面的「索引頁」，它可以幫你快速找到想看的內容，不用一頁一頁翻。資料庫索引也是類似的道理，它可以大幅提升查詢速度。
            </p>

            <div class="bg-gray-900 rounded-lg p-4 overflow-x-auto">
              <pre class="text-green-400 text-sm"><code>/* 索引策略設計 (示意) p.47 */
CREATE TABLE student_depression (
  id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  /* ... 其他欄位 ... */
  `Academic Pressure_Category`   VARCHAR(50),
  `Academic Pressure_Value`      FLOAT,
  Degree4                        VARCHAR(50), /* 假設這是清洗後的學歷欄位 */
  Depression                     TINYINT(1),
  
  /* 針對常用查詢欄位建立索引 */
  INDEX idx_pressure_category (`Academic Pressure_Category`),
  INDEX idx_degree            (Degree4),
  INDEX idx_depression        (Depression),
  INDEX idx_pressure_value    (`Academic Pressure_Value`)
  /* ... 其他索引 ... */
) ENGINE = InnoDB;</code></pre>
            </div>

            <div class="grid grid-cols-2 gap-4 mt-4">
              <div class="bg-yellow-50 rounded-lg p-4">
                <h4 class="font-semibold text-yellow-700 mb-2">
                  <i class="ri-search-eye-line mr-2"></i>常用查詢加速
                </h4>
                <ul class="text-sm text-neutral-700 space-y-1">
                  <li>• 依「壓力分類」查詢：靠 <code class="text-xs bg-gray-200 p-0.5 rounded">idx_pressure_category</code></li>
                  <li>• 依「學歷」篩選：靠 <code class="text-xs bg-gray-200 p-0.5 rounded">idx_degree</code></li>
                  <li>• 依「憂鬱狀態」過濾：靠 <code class="text-xs bg-gray-200 p-0.5 rounded">idx_depression</code></li>
                </ul>
              </div>
              <div class="bg-green-50 rounded-lg p-4">
                <h4 class="font-semibold text-green-700 mb-2">
                  <i class="ri-line-chart-line mr-2"></i>實際效能提升
                </h4>
                <ul class="text-sm text-neutral-700 space-y-1">
                  <li>• Grafana 圖表載入速度預期提升 <span class="font-bold text-green-600">顯著</span></li>
                  <li>• 複雜查詢響應時間能降到 <span class="font-bold text-green-600">毫秒級</span></li>
                  <li>• 輕鬆支援 <span class="font-bold text-green-600">數萬筆</span> 資料的即時查詢</li>
                </ul>
              </div>
            </div>
             <p class="text-xs text-neutral-500 mt-2"> (註: 具體提升百分比和毫秒數需實測，此處為預期效益)</p>
          </div>
        </div>
      </section>

      <section data-section="預計算視圖" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >48</span
            >
            <h2 class="text-xl font-semibold text-neutral-800 flex items-baseline">
              資料庫設計與優化 - 預計算統計視圖 <span class="text-xs font-normal text-neutral-500 ml-2">(p.48)</span>
            </h2>
            <span class="ml-auto text-sm text-neutral-500">1分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-neutral-700 leading-relaxed mb-4">
              <strong class="text-primary"
                >另一個加速秘訣：「預計算統計視圖」 <span class="text-xs font-normal text-neutral-400">(p.48)</span>！</strong
              >
            </p>
             <p class="text-neutral-700 leading-relaxed">
              <strong class="text-secondary">什麼是視圖 (View)？</strong>
              你可以把它想像成一個「虛擬的表格」，它本身不儲存資料，但它定義了一個查詢。當你查詢這個視圖時，它會即時執行那個預先定義好的查詢。
            </p>
             <p class="text-neutral-700 leading-relaxed">
              <strong class="text-accent">「預計算」的好處：</strong>
              對於一些常用的統計分析，例如計算不同壓力層級的憂鬱比例，我們不用讓 Grafana 每次都從原始大表格重新撈資料、重新計算。我們可以先建立一個視圖，把這些計算邏輯寫在視圖裡。這樣 Grafana 只需要簡單地查詢這個視圖，就能馬上拿到算好的結果！
            </p>

            <div class="bg-gray-900 rounded-lg p-4 overflow-x-auto">
              <pre
                class="text-green-400 text-sm"
              ><code>/* 視圖1：壓力層級 × 憂鬱比例 (p.48) */
CREATE OR REPLACE VIEW v_depression_by_pressure AS
SELECT
  `Academic Pressure_Category` AS pressure_level, /* 壓力等級 */
  COUNT(*)                     AS total_count,    /* 總人數 */
  SUM(Depression)              AS depression_count, /* 憂鬱人數 */
  ROUND(SUM(Depression) / COUNT(*), 4) AS depression_rate /* 憂鬱比例 */
FROM student_depression
GROUP BY pressure_level
ORDER BY CASE pressure_level 
    WHEN '低壓力' THEN 1 WHEN '中壓力' THEN 2 WHEN '高壓力' THEN 3 END;

/* 視圖2：學歷層級壓力與憂鬱 (p.48) */
CREATE OR REPLACE VIEW v_pressure_by_degree AS
SELECT
  Degree4                                  AS degree_level, /* 學歷等級 */
  COUNT(*)                                 AS total_count,
  ROUND(AVG(`Academic Pressure_Value`), 2) AS avg_pressure, /* 平均壓力值 */
  ROUND(SUM(Depression) / COUNT(*), 4)     AS depression_rate
FROM student_depression
GROUP BY degree_level;</code></pre>
            </div>

            <div class="bg-blue-50 rounded-lg p-4">
              <p class="text-neutral-700 leading-relaxed mb-3">
                <strong class="text-primary">預計算的威力展現：</strong>
                例如，透過 `v_depression_by_pressure` 這個視圖，我們可以馬上知道 (數據回顧自 p.17)：
              </p>
              <div class="grid grid-cols-3 gap-3">
                <div class="bg-white rounded p-3 text-center">
                  <p class="text-2xl font-bold text-green-600">19.44%</p>
                  <p class="text-xs text-neutral-600">低壓力憂鬱率</p>
                </div>
                <div class="bg-white rounded p-3 text-center">
                  <p class="text-2xl font-bold text-orange-600">52.03%</p>
                  <p class="text-xs text-neutral-600">中壓力憂鬱率</p>
                </div>
                <div class="bg-white rounded p-3 text-center">
                  <p class="text-2xl font-bold text-red-600">81.63%</p>
                  <p class="text-xs text-neutral-600">高壓力憂鬱率</p>
                </div>
              </div>
            </div>

            <div class="bg-green-50 rounded-lg p-4">
              <p class="text-neutral-700 leading-relaxed">
                <strong class="text-primary">實際效益：</strong>
                透過這些預先計算好的視圖，我們的 Grafana 儀表板能夠「飛快地」載入並即時顯示這些關鍵統計數據，讓學校管理者能夠快速掌握學生心理健康狀況的整體趨勢和細部分析。
              </p>
            </div>
          </div>
        </div>
      </section>

      <section data-section="實際貢獻" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >49</span
            >
            <h2 class="text-xl font-semibold text-neutral-800 flex items-baseline">
              實際貢獻與價值 <span class="text-xs font-normal text-neutral-500 ml-2">(p.49)</span>
            </h2>
            <span class="ml-auto text-sm text-neutral-500">1分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-neutral-700 leading-relaxed mb-3">
              <strong class="text-primary">這個整合系統對學校有什麼用？ <span class="text-xs font-normal text-neutral-400">(p.49)</span></strong>
            </p>
            <div class="space-y-3">
              <div class="flex items-start">
                <i
                  class="ri-alarm-warning-line text-2xl text-amber-500 mr-3"
                ></i>
                <div>
                  <p class="font-semibold text-neutral-800">及早預警</p>
                  <p class="text-sm text-neutral-600">
                    透過視覺化儀表板快速識別高風險學生群體，促進及早干預，有效預防憂鬱風險。
                  </p>
                </div>
              </div>
              <div class="flex items-start">
                <i class="ri-first-aid-kit-line text-2xl text-red-500 mr-3"></i> 
                <div>
                  <p class="font-semibold text-neutral-800">精準干預 / 資源分配</p>
                  <p class="text-sm text-neutral-600">
                    依據實證數據最佳化心理健康資源配置，學校可以制定更具針對性的心理健康輔導策略，例如針對不同學歷或壓力等級的學生提供差異化的幫助，讓資源用在最需要的地方。
                  </p>
                </div>
              </div>
              <div class="flex items-start">
                <i
                  class="ri-bar-chart-box-line text-2xl text-green-500 mr-3"
                ></i>
                <div>
                  <p class="font-semibold text-neutral-800">長期追蹤與標準化</p>
                  <p class="text-sm text-neutral-600">
                    支援縱向資料分析，觀察干預措施的長期效果。同時，這套系統也可以作為一個標準化工具，未來有機會套用至不同學校或機構的心理健康監測。
                  </p>
                </div>
              </div>
               <div class="flex items-start">
                <i
                  class="ri-team-line text-2xl text-blue-500 mr-3"
                ></i>
                <div>
                  <p class="font-semibold text-neutral-800">跨領域協作</p>
                  <p class="text-sm text-neutral-600">
                    這個系統能成為心理輔導人員與資料分析師之間的橋樑，促進合作。
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section data-section="結論與建議" class="mb-12 section-transition">
        <div
          class="bg-white rounded-lg shadow-sm p-6 border border-neutral-200"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-primary text-white rounded-full text-sm font-bold mr-3"
              >50-53</span 
            >
            <h2 class="text-xl font-semibold text-neutral-800 flex items-baseline">結論與建議 <span class="text-xs font-normal text-neutral-500 ml-2">(p.50-53)</span></h2>
            <span class="ml-auto text-sm text-neutral-500">1分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-neutral-700 leading-relaxed">
              <strong class="text-primary">主要研究發現總結 <span class="text-xs font-normal text-neutral-400">(p.51)</span>：</strong>
              <ul class="list-disc list-inside ml-4">
                <li>學業壓力與憂鬱風險呈現中度正相關 (r = 0.475)。</li>
                <li>隨著壓力程度的增高，學生的憂鬱風險比例從 19.44% 直線攀升至 81.63%。</li>
                <li>我們建立的兩種分類模型 (Logistic Regression 和 Random Forest) 都一致地將「學業壓力」視為預測憂鬱風險的最關鍵變項。</li>
              </ul>
            </p>
            <div
              class="bg-gradient-to-r from-primary/10 to-secondary/10 rounded-lg p-4"
            >
              <p class="text-neutral-700 leading-relaxed">
                <strong class="text-primary">實務建議 <span class="text-xs font-normal text-neutral-400">(p.52)</span>：</strong>
                基於這些發現，我們建議學校應該加強對高學業壓力學生的心理健康支持，例如優先安排心理諮商或壓力管理工作坊。也可以考慮在學期中設立自我壓力評估機制，以便及早介入。
              </p>
            </div>
             <p class="text-neutral-700 leading-relaxed">
                <strong class="text-primary">未來研究方向 <span class="text-xs font-normal text-neutral-400">(p.53)</span>：</strong>
                未來，我們希望能探討更多元的心理健康指標，像是焦慮程度、睡眠品質、飲食習慣等。如果能結合長期追蹤資料，觀察壓力變化的軌跡以及憂鬱的發展過程，那將更有價值。同時，也可以納入社交支持這類可能影響壓力與憂鬱關係的交互作用變項。
              </p>
          </div>
        </div>
      </section>

      <section data-section="Q&A" class="mb-12 section-transition">
        <div
          class="bg-gradient-to-r from-primary to-secondary text-white rounded-lg shadow-sm p-6"
        >
          <div class="flex items-center mb-4">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-white text-primary rounded-full text-sm font-bold mr-3"
              >54</span 
            >
            <h2 class="text-xl font-semibold flex items-baseline">Q&A 與參考資料 <span class="text-xs font-normal text-white/80 ml-2">(p.54)</span></h2>
            <span class="ml-auto text-sm text-white/80">0.5分鐘</span>
          </div>
          <div class="space-y-4">
            <p class="text-white/90 leading-relaxed">
                我們的所有分析程式碼、資料庫腳本以及更詳細的技術架構和操作指南，都已經上傳到 GitHub，歡迎大家參考指教。螢幕上有我們的 GitHub 儲存庫連結 <span class="text-xs font-normal text-white/70">(對應 p.54)</span>。
            </p>
            <p class="text-white/90 leading-relaxed mt-4">
              <strong>感謝：</strong> 感謝各位老師、同學的聆聽！
            </p>
            <p class="text-white/90 leading-relaxed">
              <strong>提問：</strong> 請問大家有沒有任何問題？
            </p>
          </div>
        </div>
      </section>

      <section data-section="報告流程建議" class="mb-12 section-transition">
        <div
          class="bg-gradient-to-r from-amber-50 to-orange-50 rounded-lg shadow-sm p-6 border border-amber-200"
        >
          <h2 class="text-xl font-semibold text-neutral-800 mb-4">
            <i class="ri-lightbulb-line text-amber-500 mr-2"></i>
            報告流程建議
          </h2>
          <div class="space-y-3 text-sm">
            <div class="flex items-start">
              <i class="ri-check-double-line text-amber-500 mr-2 mt-0.5"></i>
              <p class="text-neutral-700">
                <strong>語速適中，口語化表達：</strong>
                盡量避免生硬的學術詞彙，用生活化的比喻（如「大老闆」、「三層樓」、「積木」、「翻譯官」）來解釋複雜概念。
              </p>
            </div>
            <div class="flex items-start">
              <i class="ri-check-double-line text-amber-500 mr-2 mt-0.5"></i>
              <p class="text-neutral-700">
                <strong>眼神交流與自信：</strong>
                報告時多與聽眾互動，展現你對內容的熟悉與熱情。
              </p>
            </div>
            <div class="flex items-start">
              <i class="ri-check-double-line text-amber-500 mr-2 mt-0.5"></i>
              <p class="text-neutral-700">
                <strong>時間控制：</strong> 嚴格按照每區塊建議時間，確保在 15
                分鐘內完成，並預留 Q&A 時間。
              </p>
            </div>
            <div class="flex items-start">
              <i class="ri-check-double-line text-amber-500 mr-2 mt-0.5"></i>
              <p class="text-neutral-700">
                <strong>重點強調：</strong>
                針對關鍵數據和發現（例如相關係數、憂鬱比例變化、模型關鍵特徵），可以用手勢或語氣加強，讓聽眾印象深刻。
              </p>
            </div>
            <div class="flex items-start">
              <i class="ri-check-double-line text-amber-500 mr-2 mt-0.5"></i>
              <p class="text-neutral-700">
                <strong>混淆矩陣、PCA、隨機森林、ORM：</strong>
                這些部分可以放慢語速，多用比喻解釋，確保非專業背景的聽眾也能大致聽懂概念。
              </p>
            </div>
            <div class="flex items-start">
              <i class="ri-check-double-line text-amber-500 mr-2 mt-0.5"></i>
              <p class="text-neutral-700">
                <strong>模組化解釋：</strong> 在講到「資料前處理層 (Python)」時，用「積木」或「零件」的比喻來解釋模組化，讓聽眾更容易理解其靈活性。
              </p>
            </div>
          </div>
          <p class="text-center mt-6 text-lg font-semibold text-amber-700">
            祝你報告順利成功！
          </p>
        </div>
      </section>
    </main>

    <footer
      class="fixed bottom-0 left-0 w-full bg-white border-t border-neutral-200 z-30"
    >
      <div class="container mx-auto px-4 py-3">
        <div class="flex items-center justify-between">
          <button
            id="prev-section"
            class="text-neutral-600 hover:text-primary transition-colors"
          >
            <i class="ri-arrow-left-s-line text-2xl"></i>
          </button>
          <span
            id="current-section"
            class="text-sm font-medium text-neutral-700"
            >封面</span 
          >
          <button
            id="next-section"
            class="text-neutral-600 hover:text-primary transition-colors"
          >
            <i class="ri-arrow-right-s-line text-2xl"></i>
          </button>
        </div>
      </div>
    </footer>

    <div class="easter-egg" id="easter-egg">
      <i class="ri-heart-3-fill text-pink-500"></i>
    </div>

    <div class="easter-egg-message" id="easter-egg-message">
      <h3 class="text-2xl font-bold mb-4">你發現了彩蛋！🎉</h3>
      <p class="mb-4">記住，無論壓力多大，總有人在乎你。</p>
      <p class="mb-4">深呼吸，一步一步來，你可以的！💪</p>
      <button
        onclick="closeEasterEgg()"
        class="bg-white text-purple-600 px-4 py-2 rounded-lg font-semibold hover:bg-purple-100 transition-colors"
      >
        關閉
      </button>
    </div>

    <script>
      // 章節資料 - 更新以匹配新的和調整的data-section名稱
      const sectionsData = [
        { id: "封面", name: "封面 (p.1)" },
        { id: "摘要", name: "摘要 (p.2-3)" },
        { id: "緒論", name: "緒論 (p.4-6)" },
        { id: "研究方法概覽", name: "研究方法概覽 (p.7-10)" },
        { id: "研究方法資料處理", name: "資料處理 (p.11-14)" },
        { id: "統計分析封面", name: "統計分析章節 (p.15)" },
        { id: "描述性統計與相關性", name: "統計分析 (p.15-22)" },
        { id: "PCA分析", name: "PCA分析 (p.23-24)" },
        { id: "其他變項相關", name: "其他變項相關 (p.25-27)" },
        { id: "機器學習模型章節", name: "機器學習章節 (p.28)" },
        { id: "LogisticRegression", name: "Logistic Regression (p.29-31)" },
        { id: "RandomForestResults", name: "Random Forest 結果 (p.32-33)" },
        { id: "隨機森林原理", name: "Random Forest 原理" },
        { id: "特徵重要性", name: "特徵重要性 (p.34-36)" },
        { id: "資料庫整合視覺化封面", name: "資料庫整合視覺化章節 (p.37)" },
        { id: "資料庫整合系統概覽", name: "整合系統概覽 (p.37-42)" },
        { id: "資料流轉與自動化", name: "資料流轉自動化 (p.43-44)" },
        { id: "資料庫索引策略", name: "DB索引策略 (p.47)" },
        { id: "預計算視圖", name: "DB預計算視圖 (p.48)" },
        { id: "實際貢獻", name: "實際貢獻 (p.49)" },
        { id: "結論與建議", name: "結論與建議 (p.50-53)" },
        { id: "Q&A", name: "Q&A (p.54)" },
        { id: "報告流程建議", name: "報告流程建議" },
      ];

      let currentSectionIndex = 0;

      // 初始化章節導航
      function initSectionNav() {
        const nav = document.getElementById("section-nav");
        nav.innerHTML = ''; // Clear existing links
        sectionsData.forEach((section, index) => {
          const link = document.createElement("a");
          link.href = `#${section.id}`; // Use data-section as ID
          link.className =
            "block px-4 py-2 rounded-lg text-neutral-700 hover:bg-primary/10 hover:text-primary transition-colors";
          link.innerHTML = `<i class="ri-file-text-line mr-2"></i>${section.name}`;
          link.onclick = (e) => {
            e.preventDefault();
            goToSectionByName(section.id);
            closeSidebar();
          };
          nav.appendChild(link);
        });
      }
      
      function findSectionIndexByName(sectionName) {
          return sectionsData.findIndex(s => s.id === sectionName);
      }

      // 跳轉到指定章節 by Name
      function goToSectionByName(sectionId) {
        const targetSection = document.querySelector(`section[data-section="${sectionId}"]`);
        if (targetSection) {
          targetSection.scrollIntoView({
            behavior: "smooth",
            block: "start", // Ensure the top of the section aligns with the top of the viewport
          });
        }
      }


      // 更新當前章節顯示
      function updateCurrentSectionDisplay(sectionName) {
        document.getElementById("current-section").textContent = sectionName;
        const currentVisibleSectionIndex = findSectionIndexByName(document.querySelector(".section-visible[data-section]")?.getAttribute('data-section') || sectionsData[0].id);
        updateProgress(currentVisibleSectionIndex);
      }

      // 更新進度條
      function updateProgress(currentIndex) {
        const progress = ((currentIndex + 1) / sectionsData.length) * 100;
        document.getElementById("progress-bar").style.width = `${progress}%`;
      }

      // 側邊欄控制
      const sidebar = document.getElementById("sidebar");
      const menuToggle = document.getElementById("menu-toggle");
      const closeMenu = document.getElementById("close-menu");

      function openSidebar() {
        sidebar.classList.remove("translate-x-full");
        sidebar.classList.add("translate-x-0");
      }

      function closeSidebar() {
        sidebar.classList.remove("translate-x-0");
        sidebar.classList.add("translate-x-full");
      }

      menuToggle.addEventListener("click", openSidebar);
      closeMenu.addEventListener("click", closeSidebar);

      document.addEventListener("click", (e) => {
        if (
          !sidebar.contains(e.target) &&
          !menuToggle.contains(e.target) &&
          sidebar.classList.contains("translate-x-0") 
        ) {
          closeSidebar();
        }
      });
      
      // 上一章節/下一章節按鈕
      document.getElementById("prev-section").addEventListener("click", () => {
        const currentVisibleSection = document.querySelector(".section-visible[data-section]");
        if (currentVisibleSection) {
            const currentIndex = findSectionIndexByName(currentVisibleSection.getAttribute('data-section'));
            if (currentIndex > 0) {
                 goToSectionByName(sectionsData[currentIndex - 1].id);
            }
        } else if (sectionsData.length > 0) { // If nothing visible, go to first
            goToSectionByName(sectionsData[0].id);
        }
      });

      document.getElementById("next-section").addEventListener("click", () => {
         const currentVisibleSection = document.querySelector(".section-visible[data-section]");
         if (currentVisibleSection) {
            const currentIndex = findSectionIndexByName(currentVisibleSection.getAttribute('data-section'));
            if (currentIndex < sectionsData.length - 1) {
                goToSectionByName(sectionsData[currentIndex + 1].id);
            }
        } else if (sectionsData.length > 0) { // If nothing visible, go to first
            goToSectionByName(sectionsData[0].id);
        }
      });


      // Intersection Observer for section animations and updating current section
      const observerOptions = {
        root: null, // observing intersections with the viewport
        rootMargin: "0px 0px -75% 0px", // Trigger when top 25% of section is visible
        threshold: 0, // Trigger as soon as any part (respecting rootMargin) is visible
      };

      let lastVisibleSectionName = sectionsData.length > 0 ? sectionsData[0].name : "";

      const intersectionObserver = new IntersectionObserver((entries) => {
        let visibleSection = null;
        entries.forEach((entry) => {
          const sectionElement = entry.target;
           if (entry.isIntersecting) {
            sectionElement.classList.add("section-visible");
            sectionElement.classList.remove("section-transition");
            visibleSection = sectionElement; // Potentially update lastVisibleSectionName
          }
        });

        if (visibleSection) {
            const sectionId = visibleSection.getAttribute("data-section");
            const sectionObj = sectionsData.find(s => s.id === sectionId);
            if (sectionObj) {
                lastVisibleSectionName = sectionObj.name;
            }
        }
        // Always update display, even if no new intersection, to reflect current state
        updateCurrentSectionDisplay(lastVisibleSectionName);

      }, observerOptions);

      document.querySelectorAll("section[data-section]").forEach((section) => {
        intersectionObserver.observe(section);
        section.classList.add("section-transition"); // Ensure all sections start hidden for animation
      });
      

      // 隱藏彩蛋功能
      let easterEggClickCount = 0;
      let easterEggTimer = null;

      document.getElementById("easter-egg").addEventListener("click", () => {
        easterEggClickCount++;
        clearTimeout(easterEggTimer);
        easterEggTimer = setTimeout(() => {
          easterEggClickCount = 0;
        }, 1000);
        if (easterEggClickCount >= 3) {
          document.getElementById("easter-egg-message").style.display = "block";
          easterEggClickCount = 0;
        }
      });

      function closeEasterEgg() {
        document.getElementById("easter-egg-message").style.display = "none";
      }

      document.addEventListener("keydown", (e) => {
        if (e.ctrlKey && e.shiftKey && e.key === "H") {
          document.getElementById("easter-egg-message").style.display = "block";
        }
      });

      // 初始化
      window.addEventListener('load', () => {
        initSectionNav();
        // Initial call to set first section name and progress
        if (sectionsData.length > 0) {
            // Ensure the first section is marked visible on load if it's at the top
            const firstSectionElement = document.querySelector(`section[data-section="${sectionsData[0].id}"]`);
            if (firstSectionElement && firstSectionElement.getBoundingClientRect().top >=0 && firstSectionElement.getBoundingClientRect().top < window.innerHeight/4) {
                 firstSectionElement.classList.add("section-visible");
                 firstSectionElement.classList.remove("section-transition");
                 lastVisibleSectionName = sectionsData[0].name;
            }
            updateCurrentSectionDisplay(lastVisibleSectionName);
        }
      });
    </script>
  </body>
</html>
